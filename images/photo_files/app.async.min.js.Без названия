!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define("dompurify",b):(a=a||self).DOMPurify=b()}(this,function(){"use strict";var a=Object.hasOwnProperty,b=Object.setPrototypeOf,c=Object.isFrozen,d=Object.freeze,e=Object.seal,f=Object.create,g="undefined"!=typeof Reflect&&Reflect,h=g.apply,i=g.construct;h||(h=function(a,b,c){return a.apply(b,c)}),d||(d=function(a){return a}),e||(e=function(a){return a}),i||(i=function(a,b){return new(Function.prototype.bind.apply(a,[null].concat(function(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}(b))))});var j,k=w(Array.prototype.forEach),l=w(Array.prototype.indexOf),m=w(Array.prototype.pop),n=w(Array.prototype.push),o=w(Array.prototype.slice),p=w(String.prototype.toLowerCase),q=w(String.prototype.match),r=w(String.prototype.replace),s=w(String.prototype.indexOf),t=w(String.prototype.trim),u=w(RegExp.prototype.test),v=(j=TypeError,function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return i(j,b)});function w(a){return function(b){for(var c=arguments.length,d=Array(c>1?c-1:0),e=1;e<c;e++)d[e-1]=arguments[e];return h(a,b,d)}}function x(a,d){b&&b(a,null);for(var e=d.length;e--;){var f=d[e];if("string"==typeof f){var g=p(f);g!==f&&(c(d)||(d[e]=g),f=g)}a[f]=!0}return a}function y(b){var c=f(null),d=void 0;for(d in b)h(a,b,[d])&&(c[d]=b[d]);return c}var z=d(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),A=d(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","audio","canvas","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","video","view","vkern"]),B=d(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),C=d(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),D=d(["#text"]),E=d(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns"]),F=d(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),G=d(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),H=d(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),I=e(/\{\{[\s\S]*|[\s\S]*\}\}/gm),J=e(/<%[\s\S]*|[\s\S]*%>/gm),K=e(/^data-[\-\w.\u00B7-\uFFFF]/),L=e(/^aria-[\-\w]+$/),M=e(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),N=e(/^(?:\w+script|data):/i),O=e(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};function Q(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}var R=function(){return"undefined"==typeof window?null:window},S=function(a,b){if("object"!==(void 0===a?"undefined":P(a))||"function"!=typeof a.createPolicy)return null;var c=null;b.currentScript&&b.currentScript.hasAttribute("data-tt-policy-suffix")&&(c=b.currentScript.getAttribute("data-tt-policy-suffix"));var d="dompurify"+(c?"#"+c:"");try{return a.createPolicy(d,{createHTML:function(a){return a}})}catch(a){return console.warn("TrustedTypes policy "+d+" could not be created."),null}};return function a(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R(),c=function(b){return a(b)};if(c.version="2.1.0",c.removed=[],!b||!b.document||9!==b.document.nodeType)return c.isSupported=!1,c;var e=b.document,f=!1,g=b.document,h=b.DocumentFragment,i=b.HTMLTemplateElement,j=b.Node,w=b.NodeFilter,T=b.NamedNodeMap,U=void 0===T?b.NamedNodeMap||b.MozNamedAttrMap:T,V=b.Text,W=b.Comment,X=b.DOMParser,$=b.trustedTypes;if("function"==typeof i){var Y=g.createElement("template");Y.content&&Y.content.ownerDocument&&(g=Y.content.ownerDocument)}var Z=S($,e),_=Z&&Fa?Z.createHTML(""):"",aa=g,ba=aa.implementation,ca=aa.createNodeIterator,da=aa.getElementsByTagName,ea=aa.createDocumentFragment,fa=e.importNode,ga={};try{ga=y(g).documentMode?g.documentMode:{}}catch(a){}var ha={};c.isSupported=ba&&void 0!==ba.createHTMLDocument&&9!==ga;var ia=I,ja=J,ka=K,la=L,ma=N,na=O,oa=M,pa=null,qa=x({},[].concat(Q(z),Q(A),Q(B),Q(C),Q(D))),ra=null,sa=x({},[].concat(Q(E),Q(F),Q(G),Q(H))),ta=null,ua=null,va=!0,wa=!0,xa=!1,ya=!1,za=!1,Aa=!1,Ba=!1,Ca=!1,Da=!1,Ea=!1,Fa=!1,Ga=!0,Ha=!0,Ia=!1,Ja={},Ka=x({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","plaintext","script","style","svg","template","thead","title","video","xmp"]),La=null,Ma=x({},["audio","video","img","source","image","track"]),Na=null,Oa=x({},["alt","class","for","id","label","name","pattern","placeholder","summary","title","value","style","xmlns"]),Pa=null,Qa=g.createElement("form"),Ra=function(a){Pa&&Pa===a||(a&&"object"===(void 0===a?"undefined":P(a))||(a={}),a=y(a),pa="ALLOWED_TAGS"in a?x({},a.ALLOWED_TAGS):qa,ra="ALLOWED_ATTR"in a?x({},a.ALLOWED_ATTR):sa,Na="ADD_URI_SAFE_ATTR"in a?x(y(Oa),a.ADD_URI_SAFE_ATTR):Oa,La="ADD_DATA_URI_TAGS"in a?x(y(Ma),a.ADD_DATA_URI_TAGS):Ma,ta="FORBID_TAGS"in a?x({},a.FORBID_TAGS):{},ua="FORBID_ATTR"in a?x({},a.FORBID_ATTR):{},Ja="USE_PROFILES"in a&&a.USE_PROFILES,va=!1!==a.ALLOW_ARIA_ATTR,wa=!1!==a.ALLOW_DATA_ATTR,xa=a.ALLOW_UNKNOWN_PROTOCOLS||!1,ya=a.SAFE_FOR_TEMPLATES||!1,za=a.WHOLE_DOCUMENT||!1,Ca=a.RETURN_DOM||!1,Da=a.RETURN_DOM_FRAGMENT||!1,Ea=a.RETURN_DOM_IMPORT||!1,Fa=a.RETURN_TRUSTED_TYPE||!1,Ba=a.FORCE_BODY||!1,Ga=!1!==a.SANITIZE_DOM,Ha=!1!==a.KEEP_CONTENT,Ia=a.IN_PLACE||!1,oa=a.ALLOWED_URI_REGEXP||oa,ya&&(wa=!1),Da&&(Ca=!0),Ja&&(pa=x({},[].concat(Q(D))),ra=[],!0===Ja.html&&(x(pa,z),x(ra,E)),!0===Ja.svg&&(x(pa,A),x(ra,F),x(ra,H)),!0===Ja.svgFilters&&(x(pa,B),x(ra,F),x(ra,H)),!0===Ja.mathMl&&(x(pa,C),x(ra,G),x(ra,H))),a.ADD_TAGS&&(pa===qa&&(pa=y(pa)),x(pa,a.ADD_TAGS)),a.ADD_ATTR&&(ra===sa&&(ra=y(ra)),x(ra,a.ADD_ATTR)),a.ADD_URI_SAFE_ATTR&&x(Na,a.ADD_URI_SAFE_ATTR),Ha&&(pa["#text"]=!0),za&&x(pa,["html","head","body"]),pa.table&&(x(pa,["tbody"]),delete ta.tbody),d&&d(a),Pa=a)},Sa=function(a){n(c.removed,{element:a});try{a.parentNode.removeChild(a)}catch(b){a.outerHTML=_}},Ta=function(a,b){try{n(c.removed,{attribute:b.getAttributeNode(a),from:b})}catch(a){n(c.removed,{attribute:null,from:b})}b.removeAttribute(a)},Ua=function(a){var b=void 0,c=void 0;if(Ba)a="<remove></remove>"+a;else{var d=q(a,/^[\r\n\t ]+/);c=d&&d[0]}var e=Z?Z.createHTML(a):a;try{b=(new X).parseFromString(e,"text/html")}catch(a){}if(f&&x(ta,["title"]),!b||!b.documentElement){var h=(b=ba.createHTMLDocument("")).body;h.parentNode.removeChild(h.parentNode.firstElementChild),h.outerHTML=e}return a&&c&&b.body.insertBefore(g.createTextNode(c),b.body.childNodes[0]||null),da.call(b,za?"html":"body")[0]};c.isSupported&&function(){try{var a=Ua("<x/><title>&lt;/title&gt;&lt;img&gt;");u(/<\/title/,a.querySelector("title").innerHTML)&&(f=!0)}catch(a){}}();var Va=function(a){return ca.call(a.ownerDocument||a,a,w.SHOW_ELEMENT|w.SHOW_COMMENT|w.SHOW_TEXT,function(){return w.FILTER_ACCEPT},!1)},Wa=function(a){return!(a instanceof V||a instanceof W)&&!("string"==typeof a.nodeName&&"string"==typeof a.textContent&&"function"==typeof a.removeChild&&a.attributes instanceof U&&"function"==typeof a.removeAttribute&&"function"==typeof a.setAttribute&&"string"==typeof a.namespaceURI)},Xa=function(a){return"object"===(void 0===j?"undefined":P(j))?a instanceof j:a&&"object"===(void 0===a?"undefined":P(a))&&"number"==typeof a.nodeType&&"string"==typeof a.nodeName},Ya=function(a,b,d){ha[a]&&k(ha[a],function(a){a.call(c,b,d,Pa)})},Za=function(a){var b=void 0;if(Ya("beforeSanitizeElements",a,null),Wa(a))return Sa(a),!0;if(q(a.nodeName,/[\u0080-\uFFFF]/))return Sa(a),!0;var d=p(a.nodeName);if(Ya("uponSanitizeElement",a,{tagName:d,allowedTags:pa}),!Xa(a.firstElementChild)&&(!Xa(a.content)||!Xa(a.content.firstElementChild))&&u(/<[!/\w]/g,a.innerHTML)&&u(/<[!/\w]/g,a.textContent))return Sa(a),!0;if(!pa[d]||ta[d]){if(Ha&&!Ka[d]&&"function"==typeof a.insertAdjacentHTML)try{var e=a.innerHTML;a.insertAdjacentHTML("AfterEnd",Z?Z.createHTML(e):e)}catch(a){}return Sa(a),!0}return"noscript"!==d&&"noembed"!==d||!u(/<\/no(script|embed)/i,a.innerHTML)?(ya&&3===a.nodeType&&(b=a.textContent,b=r(b,ia," "),b=r(b,ja," "),a.textContent!==b&&(n(c.removed,{element:a.cloneNode()}),a.textContent=b)),Ya("afterSanitizeElements",a,null),!1):(Sa(a),!0)},$a=function(a,b,c){if(Ga&&("id"===b||"name"===b)&&(c in g||c in Qa))return!1;if(wa&&u(ka,b));else if(va&&u(la,b));else{if(!ra[b]||ua[b])return!1;if(Na[b]);else if(u(oa,r(c,na,"")));else if("src"!==b&&"xlink:href"!==b&&"href"!==b||"script"===a||0!==s(c,"data:")||!La[a]){if(xa&&!u(ma,r(c,na,"")));else if(c)return!1}else;}return!0},_a=function(a){var b=void 0,d=void 0,e=void 0,f=void 0,g=void 0;Ya("beforeSanitizeAttributes",a,null);var h=a.attributes;if(h){var i={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ra};for(g=h.length;g--;){var j=b=h[g],k=j.name,n=j.namespaceURI;if(d=t(b.value),e=p(k),i.attrName=e,i.attrValue=d,i.keepAttr=!0,i.forceKeepAttr=void 0,Ya("uponSanitizeAttribute",a,i),d=i.attrValue,!i.forceKeepAttr){if("name"===e&&"IMG"===a.nodeName&&h.id)f=h.id,h=o(h,[]),Ta("id",a),Ta(k,a),l(h,f)>g&&a.setAttribute("id",f.value);else{if("INPUT"===a.nodeName&&"type"===e&&"file"===d&&i.keepAttr&&(ra[e]||!ua[e]))continue;"id"===k&&a.setAttribute(k,""),Ta(k,a)}if(i.keepAttr)if(u(/\/>/i,d))Ta(k,a);else{ya&&(d=r(d,ia," "),d=r(d,ja," "));var q=a.nodeName.toLowerCase();if($a(q,e,d))try{n?a.setAttributeNS(n,k,d):a.setAttribute(k,d),m(c.removed)}catch(a){}}}}Ya("afterSanitizeAttributes",a,null)}},ab=function a(b){var c=void 0,d=Va(b);for(Ya("beforeSanitizeShadowDOM",b,null);c=d.nextNode();)Ya("uponSanitizeShadowNode",c,null),Za(c)||(c.content instanceof h&&a(c.content),_a(c));Ya("afterSanitizeShadowDOM",b,null)};return c.sanitize=function(a,d){var f=void 0,g=void 0,i=void 0,k=void 0,l=void 0;if(a||(a="\x3c!--\x3e"),"string"!=typeof a&&!Xa(a)){if("function"!=typeof a.toString)throw v("toString is not a function");if("string"!=typeof(a=a.toString()))throw v("dirty is not a string, aborting")}if(!c.isSupported){if("object"===P(b.toStaticHTML)||"function"==typeof b.toStaticHTML){if("string"==typeof a)return b.toStaticHTML(a);if(Xa(a))return b.toStaticHTML(a.outerHTML)}return a}if(Aa||Ra(d),c.removed=[],"string"==typeof a&&(Ia=!1),Ia);else if(a instanceof j)1===(g=(f=Ua("\x3c!--\x3e")).ownerDocument.importNode(a,!0)).nodeType&&"BODY"===g.nodeName||"HTML"===g.nodeName?f=g:f.appendChild(g);else{if(!Ca&&!ya&&!za&&-1===a.indexOf("<"))return Z&&Fa?Z.createHTML(a):a;if(!(f=Ua(a)))return Ca?null:_}f&&Ba&&Sa(f.firstChild);for(var m=Va(Ia?a:f);i=m.nextNode();)3===i.nodeType&&i===k||Za(i)||(i.content instanceof h&&ab(i.content),_a(i),k=i);if(k=null,Ia)return a;if(Ca){if(Da)for(l=ea.call(f.ownerDocument);f.firstChild;)l.appendChild(f.firstChild);else l=f;return Ea&&(l=fa.call(e,l,!0)),l}var n=za?f.outerHTML:f.innerHTML;return ya&&(n=r(n,ia," "),n=r(n,ja," ")),Z&&Fa?Z.createHTML(n):n},c.setConfig=function(a){Ra(a),Aa=!0},c.clearConfig=function(){Pa=null,Aa=!1},c.isValidAttribute=function(a,b,c){Pa||Ra({});var d=p(a),e=p(b);return $a(d,e,c)},c.addHook=function(a,b){"function"==typeof b&&(ha[a]=ha[a]||[],n(ha[a],b))},c.removeHook=function(a){ha[a]&&m(ha[a])},c.removeHooks=function(a){ha[a]&&(ha[a]=[])},c.removeAllHooks=function(){ha={}},c}()});define("clipboard/dist/clipboard",["module","exports"],function(a,exports){"use strict";var b=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol==="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};(function c(d,e){if((typeof exports==="undefined"?"undefined":b(exports))==="object"&&(typeof a==="undefined"?"undefined":b(a))==="object")a.exports=e();else if(typeof define==="function"&&define.amd)define([],e);else if((typeof exports==="undefined"?"undefined":b(exports))==="object")exports["ClipboardJS"]=e();else d["ClipboardJS"]=e()})(undefined,function(){return function(){var a={134:function a(c,d,e){"use strict";e.d(d,{default:function a(){return E}});var f=e(279);var g=e.n(f);var h=e(370);var i=e.n(h);var j=e(817);var k=e.n(j);function l(a){"@babel/helpers - typeof";if(typeof Symbol==="function"&&b(Symbol.iterator)==="symbol"){l=function a(c){return typeof c==="undefined"?"undefined":b(c)}}else{l=function a(c){return c&&typeof Symbol==="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c==="undefined"?"undefined":b(c)}}return l(a)}function m(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function n(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||false;d.configurable=true;if("value"in d)d.writable=true;Object.defineProperty(a,d.key,d)}}function o(a,b,c){if(b)n(a.prototype,b);if(c)n(a,c);return a}var p=function(){function a(b){m(this,a);this.resolveOptions(b);this.initSelection()}o(a,[{key:"resolveOptions",value:function a(){var b=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.action=b.action;this.container=b.container;this.emitter=b.emitter;this.target=b.target;this.text=b.text;this.trigger=b.trigger;this.selectedText=""}},{key:"initSelection",value:function a(){if(this.text){this.selectFake()}else if(this.target){this.selectTarget()}}},{key:"createFakeElement",value:function a(){var b=document.documentElement.getAttribute("dir")==="rtl";this.fakeElem=document.createElement("textarea");this.fakeElem.style.fontSize="12pt";this.fakeElem.style.border="0";this.fakeElem.style.padding="0";this.fakeElem.style.margin="0";this.fakeElem.style.position="absolute";this.fakeElem.style[b?"right":"left"]="-9999px";var c=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top="".concat(c,"px");this.fakeElem.setAttribute("readonly","");this.fakeElem.value=this.text;return this.fakeElem}},{key:"selectFake",value:function a(){var b=this;var c=this.createFakeElement();this.fakeHandlerCallback=function(){return b.removeFake()};this.fakeHandler=this.container.addEventListener("click",this.fakeHandlerCallback)||true;this.container.appendChild(c);this.selectedText=k()(c);this.copyText();this.removeFake()}},{key:"removeFake",value:function a(){if(this.fakeHandler){this.container.removeEventListener("click",this.fakeHandlerCallback);this.fakeHandler=null;this.fakeHandlerCallback=null}if(this.fakeElem){this.container.removeChild(this.fakeElem);this.fakeElem=null}}},{key:"selectTarget",value:function a(){this.selectedText=k()(this.target);this.copyText()}},{key:"copyText",value:function a(){var b;try{b=document.execCommand(this.action)}catch(a){b=false}this.handleResult(b)}},{key:"handleResult",value:function a(b){this.emitter.emit(b?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function a(){if(this.trigger){this.trigger.focus()}document.activeElement.blur();window.getSelection().removeAllRanges()}},{key:"destroy",value:function a(){this.removeFake()}},{key:"action",set:function a(){var b=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"copy";this._action=b;if(this._action!=="copy"&&this._action!=="cut"){throw new Error('Invalid "action" value, use either "copy" or "cut"')}},get:function a(){return this._action}},{key:"target",set:function a(b){if(b!==undefined){if(b&&l(b)==="object"&&b.nodeType===1){if(this.action==="copy"&&b.hasAttribute("disabled")){throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute')}if(this.action==="cut"&&(b.hasAttribute("readonly")||b.hasAttribute("disabled"))){throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes')}this._target=b}else{throw new Error('Invalid "target" value, use a valid Element')}}},get:function a(){return this._target}}]);return a}();var q=p;function r(a){"@babel/helpers - typeof";if(typeof Symbol==="function"&&b(Symbol.iterator)==="symbol"){r=function a(c){return typeof c==="undefined"?"undefined":b(c)}}else{r=function a(c){return c&&typeof Symbol==="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c==="undefined"?"undefined":b(c)}}return r(a)}function s(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function t(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||false;d.configurable=true;if("value"in d)d.writable=true;Object.defineProperty(a,d.key,d)}}function u(a,b,c){if(b)t(a.prototype,b);if(c)t(a,c);return a}function v(a,b){if(typeof b!=="function"&&b!==null){throw new TypeError("Super expression must either be null or a function")}a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:true,configurable:true}});if(b)w(a,b)}function w(a,b){w=Object.setPrototypeOf||function a(b,c){b.__proto__=c;return b};return w(a,b)}function x(a){var b=A();return function c(){var d=B(a),e;if(b){var f=B(this).constructor;e=Reflect.construct(d,arguments,f)}else{e=d.apply(this,arguments)}return y(this,e)}}function y(a,b){if(b&&(r(b)==="object"||typeof b==="function")){return b}return z(a)}function z(a){if(a===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return a}function A(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(a){return false}}function B(a){B=Object.setPrototypeOf?Object.getPrototypeOf:function a(b){return b.__proto__||Object.getPrototypeOf(b)};return B(a)}function C(a,b){var c="data-clipboard-".concat(a);if(!b.hasAttribute(c)){return}return b.getAttribute(c)}var D=function(a){v(c,a);var b=x(c);function c(a,d){var e;s(this,c);e=b.call(this);e.resolveOptions(d);e.listenClick(a);return e}u(c,[{key:"resolveOptions",value:function a(){var b=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.action=typeof b.action==="function"?b.action:this.defaultAction;this.target=typeof b.target==="function"?b.target:this.defaultTarget;this.text=typeof b.text==="function"?b.text:this.defaultText;this.container=r(b.container)==="object"?b.container:document.body}},{key:"listenClick",value:function a(b){var c=this;this.listener=i()(b,"click",function(a){return c.onClick(a)})}},{key:"onClick",value:function a(b){var c=b.delegateTarget||b.currentTarget;if(this.clipboardAction){this.clipboardAction=null}this.clipboardAction=new q({action:this.action(c),target:this.target(c),text:this.text(c),container:this.container,trigger:c,emitter:this})}},{key:"defaultAction",value:function a(b){return C("action",b)}},{key:"defaultTarget",value:function a(b){var c=C("target",b);if(c){return document.querySelector(c)}}},{key:"defaultText",value:function a(b){return C("text",b)}},{key:"destroy",value:function a(){this.listener.destroy();if(this.clipboardAction){this.clipboardAction.destroy();this.clipboardAction=null}}}],[{key:"isSupported",value:function a(){var b=arguments.length>0&&arguments[0]!==undefined?arguments[0]:["copy","cut"];var c=typeof b==="string"?[b]:b;var d=!!document.queryCommandSupported;c.forEach(function(a){d=d&&!!document.queryCommandSupported(a)});return d}}]);return c}(g());var E=D},828:function a(b){var c=9;if(typeof Element!=="undefined"&&!Element.prototype.matches){var d=Element.prototype;d.matches=d.matchesSelector||d.mozMatchesSelector||d.msMatchesSelector||d.oMatchesSelector||d.webkitMatchesSelector}function e(a,b){while(a&&a.nodeType!==c){if(typeof a.matches==="function"&&a.matches(b)){return a}a=a.parentNode}}b.exports=e},438:function a(b,c,d){var e=d(828);function f(a,b,c,d,e){var f=h.apply(this,arguments);a.addEventListener(c,f,e);return{destroy:function b(){a.removeEventListener(c,f,e)}}}function g(a,b,c,d,e){if(typeof a.addEventListener==="function"){return f.apply(null,arguments)}if(typeof c==="function"){return f.bind(null,document).apply(null,arguments)}if(typeof a==="string"){a=document.querySelectorAll(a)}return Array.prototype.map.call(a,function(a){return f(a,b,c,d,e)})}function h(a,b,c,d){return function(c){c.delegateTarget=e(c.target,b);if(c.delegateTarget){d.call(a,c)}}}b.exports=g},879:function a(b,exports){exports.node=function(a){return a!==undefined&&a instanceof HTMLElement&&a.nodeType===1};exports.nodeList=function(a){var b=Object.prototype.toString.call(a);return a!==undefined&&(b==="[object NodeList]"||b==="[object HTMLCollection]")&&"length"in a&&(a.length===0||exports.node(a[0]))};exports.string=function(a){return typeof a==="string"||a instanceof String};exports.fn=function(a){var b=Object.prototype.toString.call(a);return b==="[object Function]"}},370:function a(b,c,d){var e=d(879);var f=d(438);function g(a,b,c){if(!a&&!b&&!c){throw new Error("Missing required arguments")}if(!e.string(b)){throw new TypeError("Second argument must be a String")}if(!e.fn(c)){throw new TypeError("Third argument must be a Function")}if(e.node(a)){return h(a,b,c)}else if(e.nodeList(a)){return i(a,b,c)}else if(e.string(a)){return j(a,b,c)}else{throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}}function h(a,b,c){a.addEventListener(b,c);return{destroy:function d(){a.removeEventListener(b,c)}}}function i(a,b,c){Array.prototype.forEach.call(a,function(a){a.addEventListener(b,c)});return{destroy:function d(){Array.prototype.forEach.call(a,function(a){a.removeEventListener(b,c)})}}}function j(a,b,c){return f(document.body,a,b,c)}b.exports=g},817:function a(b){function c(a){var b;if(a.nodeName==="SELECT"){a.focus();b=a.value}else if(a.nodeName==="INPUT"||a.nodeName==="TEXTAREA"){var c=a.hasAttribute("readonly");if(!c){a.setAttribute("readonly","")}a.select();a.setSelectionRange(0,a.value.length);if(!c){a.removeAttribute("readonly")}b=a.value}else{if(a.hasAttribute("contenteditable")){a.focus()}var d=window.getSelection();var e=document.createRange();e.selectNodeContents(a);d.removeAllRanges();d.addRange(e);b=d.toString()}return b}b.exports=c},279:function a(b){function c(){}c.prototype={on:function a(b,c,d){var e=this.e||(this.e={});(e[b]||(e[b]=[])).push({fn:c,ctx:d});return this},once:function a(b,c,d){var e=this;function f(){e.off(b,f);c.apply(d,arguments)}f._=c;return this.on(b,f,d)},emit:function a(b){var c=[].slice.call(arguments,1);var d=((this.e||(this.e={}))[b]||[]).slice();var e=0;var f=d.length;for(e;e<f;e++){d[e].fn.apply(d[e].ctx,c)}return this},off:function a(b,c){var d=this.e||(this.e={});var e=d[b];var f=[];if(e&&c){for(var g=0,h=e.length;g<h;g++){if(e[g].fn!==c&&e[g].fn._!==c)f.push(e[g])}}f.length?d[b]=f:delete d[b];return this}};b.exports=c;b.exports.TinyEmitter=c}};var c={};function d(b){if(c[b]){return c[b].exports}var e=c[b]={exports:{}};a[b](e,e.exports,d);return e.exports}(function(){d.n=function(a){var b=a&&a.__esModule?function(){return a["default"]}:function(){return a};d.d(b,{a:b});return b}})();(function(){d.d=function(exports,a){for(var b in a){if(d.o(a,b)&&!d.o(exports,b)){Object.defineProperty(exports,b,{enumerable:true,get:a[b]})}}}})();(function(){d.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)}})();return d(134)}().default})});define("clipboard",["clipboard/dist/clipboard"],function(a){return a});!function(a,b){if("object"==typeof exports&&"object"==typeof module)module.exports=b();else if("function"==typeof define&&define.amd)define("@mail/text-analyzer/dist/main",[],b);else{var c=b();for(var d in c)("object"==typeof exports?exports:a)[d]=c[d]}}(window,function(){return function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;var d=Object.create(null);if(c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(var e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function(){return a.default}:function(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="",c(c.s=0)}([function(a,b,c){var d;void 0===(d=function(a){var b=c(1),d=/(?:(?:[^\/\.\?\%\=;\!&-_A-z]|^)(?:attachments?|attach(?:[^a-z]|$)|attached)|аттач|в прицепе?|в скрепк(?:е|у)|во? вложени(?:и|е)|(?:см(?:отри|\.|) ?|проверь )(?:вложен|приложен|прикреплен|скрепк|файл(?:|ы|ики?)[^А-я])|во вложенн?..|вложенн?.. файл(?:|ы|ики?)[^А-я]|(?:высылаю|лови|направляю|кидаю|скидываю|бросаю|сбрасываю) файл(?:|ы|ики?)[^А-я]|(?:вкладываю|прикладываю|прикрепляю|прилагаю)[^А-я]|(?:прикрепила?|приложила?)(?:[^А-я]|$)|в приложении|в приложенн?[оы].)/gi;function e(a){var c=(a=a.toLowerCase()).match(d);if(null===c)return!1;var e=(c=c[0]).match(/[A-zА-я\. ]+/gi);return null!==e&&(c=e[0].trim(),c=b.clearText(c),!b.isLink(a,c)&&(!b.isQuestion(a,c)&&(!a.match(new RegExp("^[^'\"«»]*['\"«][^'\"«»]*"+c+"(?:[^\"'«»]*\n){0,}[^'\"«»]*['\"»][^'\"«»]*$","ig"))&&(!b.isNegRegexNear(a,/(?:аттач|в прицепе?|в скрепк[еу]|во? вложени[ие]|во вложенн..|вложенн.. файлы?|в приложении|в приложенн?[оы].|при(?:лож|креп)ила?|(см(?:отри|\.|) ?|проверь )(?:вложен|приложен|прикреплен|скрепк|файл(?:|ы|ики?)[^А-я]))/gi,/(?:[^А-я]|^)(?:забыл.?|прошл.{2,3}|вчера.{0,}|предыдущ.{2,3}|ранее|в первом|первого|бы(?:л.?|ть)|нету?|отсутству[ею]т|пуст.{0,2}|только|ничего|будет)(?:[^А-я]|$)/gi)&&(!b.isNegRegexNear(a,/(?:attachments?|attach(?:ed)?)/gi,/(?:[^A-z]|^)(?:previou?s|last|recent|first letter|already|below)(?:[^A-z]|$)/gi)&&(!b.isNegRegexNear(a,/(?:аттач|во? вложени[ие]|во вложенн..|в приложении|в приложенн?[оы].|(?:при(?:(?:лага|крепля)ю|(?:лож|креп)ила?)|(?:в|при)кладываю)|прилага[ею]тся|(?:высылаю|лови|направляю|кидаю|скидываю|бросаю|сбрасываю) файл(?:ы|ики?)?[^А-я])/gi,/(?:(?:[^А-я]|^)ссылк.|https?:)/gi,75,100,1,1)&&(!b.isNegRegexNear(a,/(?:аттач|в прицепе?|в скрепк[еу]|во? вложени[ие]|во вложенн..|вложенн.. файлы?|в приложении|в приложенн?[оы].|при(?:лож|креп)ила?|прилагаю|прикладываю|прикрепляю)/gi,/(?:[^А-я]|^)(?:он[аи]?|[твм]ы|мне|меня|теб[ея]|е[йеё]|не[йм]|е(?:му|го)|ва[мшс]|и[хм]|[вн]ашим|на[шмс]|мной|тобой|(?:в|н)ами|ними?|тво[йяиеё]|у?же|там|сначала|затем|опять|есть)(?:[^А-я]|$)/gi,25,25)&&(!b.isNegRegexNear(a,/(?:аттач|в прицепе?|в скрепк[еу]|во? вложени[ие]|во вложенн..|вложенн.. файлы?|в приложении|в приложенн?[оы].|при(?:лож|креп)ила?)/gi,/(?:[^А-я]|^)(?:она?|[тв]ы|тво[йя]|теб[ея]|ва[мшс]|у?же)(?:[^А-я]|$)/gi,15,15)&&(!b.isNegRegexNear(a,/(?:во? вложени[ие]|в приложении|(?:при(?:(?:лага|крепля)ю|(?:лож|креп)ила?)|прикладываю))/gi,/(?:[^А-я]|^)(?:ответ.?|письм[оа]|переписк.|ниже|бы)(?:[^А-я]|$)/gi,35,35)&&(!b.isNegRegexNear(a,new RegExp(c,"ig"),/(?:[^А-я]|^)не(?:[^А-я]|$)/gi,35,35)&&(!b.isNegRegexNear(a,/(?:аттач|в прицепе?|в скрепке|во? вложени[ие]|во вложенн..|вложенн.. файлы?|в приложении|в приложенн?[оы].)/gi,/(?:[^А-я]|^)[А-я]{1,7}[аеиуйь](?:ть|вь|те)(?:[^А-я]|$)/gi)&&(!b.isNegRegexNear(a,/(?:аттач|в прицепе?|в скрепк[еу]|во? вложени[ие]|во вложенн..|вложенн.. файлы?|в приложении|в приложенн?[оы].|при(?:лож|креп)ила?|(?:в|при)кладываю|прикрепляю|прилага(?:е|ю)тся|(?:высылаю|лови|направляю|кидаю|скидываю|бросаю|сбрасываю) файл(?:|ы|ики?)[^А-я])/gi,/(?:[^А-я]|^)(?:как..|так..|(?:не)?котор..|чем|как|так|если|(?:все|ино|ко|то)гда|где|что(?:б|бы)?|почему|зачем|вместо|вообще|наконец)(?:[^А-я]|-|$)/gi,35,35)&&(!b.isNegRegexNear(a,/(?:аттач|в прицепе|в скрепке|во? вложении|во вложенн..|в приложении|в приложенн?[оы].)/gi,/(?:[^А-я]|^)не (?:вижу|найду|нахожу)(?:[^А-я]|$)/gi)&&(!b.isNegRegexNear(a,/(?:приложила?|прилагаю|прикладываю)/gi,/(?:[^А-я]|^)(?:сил[ыу]|усили[яей]|труд.{0,2})(?:[^А-я]|$)/gi)&&(!b.isNegRegexNear(a,/в приложении/gi,/(?:[^А-я]|^)(?:android|appstore|iphone|ios|google play|аппстор|авториз|андро[ий]д.*|айфон.*|верси|обнов(?:лен)?и|приложени[ея]|мобильн.{2,3}|разработ[чк]|smartphone|смартфон|регистраци.|(?:за)регистрир.*|пользовател[а-я]{1,2})/gi,1e4,1e4,1,1)&&(!b.isNegRegexNear(a,/в приложении/gi,/(?:[^А-я]|^)(?:(?:в|за)ход|вой[дт]и|групп.|веб|нельзя)/gi)&&(!b.isNegRegexNear(a,/(?:в приложении|(?:см(?:отри|\.|) ?|проверь )(?:вложен|приложен))/gi,/(?:номер|№|\d|[A-z]+)/gi,0,6)&&(null===a.match(new RegExp("в приложении [\"'].{1,30}[\"']","ig"))&&(!b.isNegRegexNear(a,/в приложении/gi,/(?:[^А-я]|^)[кмг]б|(?:кило|мега|гига)байт(?:[^А-я]|$)/gi,30,30)&&(!b.isNegRegexNear(a,/в приложении/gi,/(?:[^А-я]|^)(?:п\\.?|пункт)(?:[^А-я]|$)/gi,20,20)&&(!b.isNegRegexNear(a,/в приложении/gi,/ [а-зa-z](?:[^А-яA-z]|$)/gi,0,3)&&(!b.isNegRegexNear(a,/вкладываю/gi,/(?:[^А-я]|^)(?:смысл|деньги|инвестици|средства)/gi,30,30)&&(!b.isNegRegexNear(a,/(?:прилага(?:е|ю)тся|прилагаю|приложила?|прикрепила?|прикрепляю|прикладываю)/gi,/(?:[^А-я]|^)(?:информаци(?:я|ю)|инфо|контакты|номер)(?:[^А-я]|$)/gi)&&(!b.isNegRegexNear(a,/(?:прилага(?:е|ю)тся|во? вложени[ие]|в приложении|при(?:лож|креп)ила?|прикладываю|прикрепляю|прилагаю)/gi,/[\'\"«][^\'\"«»]{100,}[\'\"»]/gi,0,1e4,0,1)&&(!b.isNegRegexNear(a,/attach(?:ed)?/gi,/to (?:you|her|him|me)/gi,0,10)&&(!b.isNegRegexNear(a,/attached/gi,/(?:am|was|were|had|did)/gi,10,0)&&(!b.isNegRegexNear(a,/attach(?:ed)?/gi,/(?:[^A-z]|^)(?:we|your?|s?he|they|his|her|him)(?:[^A-z]|$)/gi,17,0)&&(!b.isNegRegexNear(a,/(?:attachments?|attach[^me]|attached)/gi,/(?:[^A-z]|^)(?:don'?t|not?|any|link|with ?out|forg(?:e|o)t)(?:[^A-z]|$)/gi,30,30)&&(!b.isNegRegexNear(a,/(?:attachments?|attach[^me]|attached)/gi,/(?:[^A-z]|^)(?:these|this|that|those)(?:[^A-z]|$)/gi,15,0)&&((!b.isNegRegexNear(a,/в приложении/gi,/(?:[^А-я]|^)к /gi,0,20)||null!==a.match(/в приложении к [а-я]{0,10} ?письму/gi))&&((!b.isNegRegexNear(a,/(?:прилагаю|прилага[ею]тся|приложила?|прикрепила?|прикладываю)/gi,/(?:[^А-я]|^)к /gi)||null!==a.match(/(?:прилагаю|прилага[ею]тся|приложил(?:а|[^А-я]|$)|прикрепил(?:а|[^А-я]|$)|прикладываю)[а-я ]{0,}к [а-я]{0,10} ?письму/gi)||null!==a.match(/(?:[^А-я]|^)к [а-я]{0,10} ?письму (?:прилагаю|прилага[ею]тся|приложил(?:а|[^А-я]|$)|прикрепил(?:а|[^А-я]|$)|прикладываю)/gi))&&((!b.isNegRegexNear(a,/вкладываю/gi,/(?:[^А-я]|^)в /gi)||null!==a.match(/вкладываю [а-я ]{0,} ?в [а-я]{0,10} ?письмо/gi)||null!==a.match(/в [а-я]{0,10} ?письмо вкладываю[^т]/gi))&&((!a.match(/(?:во? вложени[ие]|в приложении|при(?:лож|креп)ила?|прикладываю|прикрепляю|прилагаю) [а-я ]{0,30} ?реквизиты/gi)&&!a.match(/реквизиты [а-я ]{0,30} ?(?:во? вложени[ие]|в приложении|при(?:лож|креп)ила?|прикладываю|прикрепляю|прилагаю)/gi)||!b.isNegRegexNear(a,/(?:во? вложени[ие]|в приложении|при(?:лож|креп)ила?|прикладываю|прикрепляю|прилагаю)/gi,/(?:[^A-z]|^)(?:бик|инн|номер|получател.|сч[её]т|кпп|о[ао]о|зао|огрн|окпо|ип|рнн|иин|иик)(?:[^A-z]|$)/gi,0,1e4,0,1))&&((!a.match(/(?:во? вложени[ие]|в приложении|при(?:лож|креп)ила?|прикладываю|прикрепляю|прилагаю) [а-я ]{0,25} ?(?:список|данные)/gi)&&!a.match(/(?:список|данные) [а-я ]{0,25} ?(?:во? вложени[ие]|в приложении|при(?:лож|креп)ила?|прикладываю|прикрепляю|прилагаю)/gi)||!b.isNegRegexNear(a,/(?:во? вложени[ие]|в приложении|при(?:лож|креп)ила?|прикладываю|прикрепляю|прилагаю)/gi,/(?:.{0,3}(?:\d|-).*\n){2,}/gi,0,1e4,0,1))&&(!a.match(/(?:во? вложени[ие]|в приложении|при(?:лож|креп)ила?|прикладываю|прикрепляю|прилагаю) .{0,15} ?чек/gi)&&!a.match(/чек .{0,15} ?(?:во? вложени[ие]|в приложении|при(?:лож|креп)ила?|прикладываю|прикрепляю|прилагаю)/gi)||!b.isNegRegexNear(a,/(?:во? вложени[ие]|в приложении|при(?:лож|креп)ила?|прикладываю|прикрепляю|прилагаю)/gi,/(?:[^A-z]|^)(?:сумма|номер заказа|платеж.?|получател.|ип|дата|время)(?:[^A-z]|$)/gi,0,1e4,0,1))))))))))))))))))))))))))))))))))))}var f="natural",g="noreply",h=/^(?:(?:(?:do)?[._-]?no?t?[._-]?(?:reply|answer))|(?:bez|net)[._-]?ot[vw]eta)$/i,i=/не (?:(?:нужно|следует) отвечать|отвеча)|отвечать на него не (?:нужно|следует)|не требует ответа/i,j=/do(?:n'| no)t (?:reply|respond|answer)/i,k=/e-mail|письмо|сообщение|уведомление/i,l=/автоматическ/i,m=/e-mail|message|letter/i,n=/automat|system|generated?/i;return{TYPE_NATURAL:f,TYPE_NOREPLY:g,haveAttach:e,hasAttachment:e,getType:function(a,b){return b&&!h.test(b.split("@")[0])||!(i.test(a)||j.test(a)||k.test(a)&&l.test(a)||m.test(a)&&n.test(a))?f:g}}}.call(b,c,b,a))||(a.exports=d)},function(a,b,c){var d;void 0===(d=function(a,b){b.isNegRegexNear=function(a,b,c,d,e,f,g){var h,i,j,k,l,m;if(void 0===f&&(f=0),void 0===g&&(g=0),k=(a=a.toLowerCase()).match(b),h=null!==a.match(b),null===k)return!1;j=k[0];var n=a.indexOf(j),o=n+j.length;j=this.clearText(j),m=null===(k=a.match(new RegExp("(?:[.?!\n]|^)[^.?!\n]*"+j,"ig")))?0:a.indexOf(k[0]);var p=a.substr(o,a.length);return l=null===(k=p.match(/[\.\!\?\n].*/gi))?p.length:p.indexOf(k[0]),d||0===d?((d=n-d)<m&&0===f&&(d=m),d<0&&(d=0)):d=m,e=(e||0===e)&&(e>l&&1===g||e<l)?o+e:o+l,i=null!==a.substr(d,e-d).match(c),h&&i},b.clearText=function(a){return a.replace(/[\/\(\)\[\]\&]/g,"").replace(/\\/,"\\\\")},b.isQuestion=function(a,b){var c=a.toLowerCase().match(new RegExp(b,"ig"));if(null===c)return!1;b=c[0];var d,e=a.indexOf(b),f=a.substr(e,a.length),g=f.match(/[\.\!\?)\n].*/i);return d=g&&g.length>0?f.indexOf(g[0]):f.length,null!==(f=a.substr(e,d+1)).match(/\?$/)},b.isLink=function(a,b){return null!==a.match(new RegExp("<a.*>[^<>]*"+b+"[^<>]*</a>","ig"))||null!==a.match(new RegExp("<[^<>]*"+b+"[^<>]*>","ig"))}}.call(b,c,b,a))||(a.exports=d)}])});define("@mail/text-analyzer",["@mail/text-analyzer/dist/main"],function(a){return a});(function(a,b,c,d){"use strict";var e=["","webkit","Moz","MS","ms","o"];var f=b.createElement("div");var g="function";var h=Math.round;var i=Math.abs;var j=Date.now;function k(a,b,c){return setTimeout(s(a,c),b)}function l(a,b,c){if(Array.isArray(a)){m(a,c[b],c);return true}return false}function m(a,b,c){var e;if(!a){return}if(a.forEach){a.forEach(b,c)}else if(a.length!==d){e=0;while(e<a.length){b.call(c,a[e],e,a);e++}}else{for(e in a){a.hasOwnProperty(e)&&b.call(c,a[e],e,a)}}}function n(b,c,d){var e="DEPRECATED METHOD: "+c+"\n"+d+" AT \n";return function(){var c=new Error("get-stack-trace");var d=c&&c.stack?c.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace";var f=a.console&&(a.console.warn||a.console.log);if(f){f.call(a.console,e,d)}return b.apply(this,arguments)}}var o;if(typeof Object.assign!=="function"){o=function a(b){if(b===d||b===null){throw new TypeError("Cannot convert undefined or null to object")}var c=Object(b);for(var e=1;e<arguments.length;e++){var f=arguments[e];if(f!==d&&f!==null){for(var g in f){if(f.hasOwnProperty(g)){c[g]=f[g]}}}}return c}}else{o=Object.assign}var p=n(function a(b,c,e){var f=Object.keys(c);var g=0;while(g<f.length){if(!e||e&&b[f[g]]===d){b[f[g]]=c[f[g]]}g++}return b},"extend","Use `assign`.");var q=n(function a(b,c){return p(b,c,true)},"merge","Use `assign`.");function r(a,b,c){var d=b.prototype,e;e=a.prototype=Object.create(d);e.constructor=a;e._super=d;if(c){o(e,c)}}function s(a,b){return function c(){return a.apply(b,arguments)}}function t(a,b){if(typeof a==g){return a.apply(b?b[0]||d:d,b)}return a}function u(a,b){return a===d?b:a}function v(a,b,c){m(z(b),function(b){a.addEventListener(b,c,false)})}function w(a,b,c){m(z(b),function(b){a.removeEventListener(b,c,false)})}function x(a,b){while(a){if(a==b){return true}a=a.parentNode}return false}function y(a,b){return a.indexOf(b)>-1}function z(a){return a.trim().split(/\s+/g)}function A(a,b,c){if(a.indexOf&&!c){return a.indexOf(b)}else{var d=0;while(d<a.length){if(c&&a[d][c]==b||!c&&a[d]===b){return d}d++}return-1}}function B(a){return Array.prototype.slice.call(a,0)}function C(a,b,c){var d=[];var e=[];var f=0;while(f<a.length){var g=b?a[f][b]:a[f];if(A(e,g)<0){d.push(a[f])}e[f]=g;f++}if(c){if(!b){d=d.sort()}else{d=d.sort(function a(c,d){return c[b]>d[b]})}}return d}function D(a,b){var c,f;var g=b[0].toUpperCase()+b.slice(1);var h=0;while(h<e.length){c=e[h];f=c?c+g:b;if(f in a){return f}h++}return d}var E=1;function F(){return E++}function G(b){var c=b.ownerDocument||b;return c.defaultView||c.parentWindow||a}var H=/mobile|tablet|ip(ad|hone|od)|android/i;var I="ontouchstart"in a;var J=D(a,"PointerEvent")!==d;var K=I&&H.test(navigator.userAgent);var L="touch";var M="pen";var N="mouse";var O="kinect";var P=25;var Q=1;var R=2;var S=4;var T=8;var U=1;var V=2;var W=4;var X=8;var Y=16;var Z=V|W;var _=X|Y;var aa=Z|_;var ba=["x","y"];var ca=["clientX","clientY"];function da(a,b){var c=this;this.manager=a;this.callback=b;this.element=a.element;this.target=a.options.inputTarget;this.domHandler=function(b){if(t(a.options.enable,[a])){c.handler(b)}};this.init()}da.prototype={handler:function(){},init:function(){this.evEl&&v(this.element,this.evEl,this.domHandler);this.evTarget&&v(this.target,this.evTarget,this.domHandler);this.evWin&&v(G(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&w(this.element,this.evEl,this.domHandler);this.evTarget&&w(this.target,this.evTarget,this.domHandler);this.evWin&&w(G(this.element),this.evWin,this.domHandler)}};function ea(a){var b;var c=a.options.inputClass;if(c){b=c}else if(J){b=za}else if(K){b=Ha}else if(!I){b=ua}else{b=La}return new b(a,fa)}function fa(a,b,c){var d=c.pointers.length;var e=c.changedPointers.length;var f=b&Q&&d-e===0;var g=b&(S|T)&&d-e===0;c.isFirst=!!f;c.isFinal=!!g;if(f){a.session={}}c.eventType=b;ga(a,c);a.emit("hammer.input",c);a.recognize(c);a.session.prevInput=c}function ga(a,b){var c=a.session;var d=b.pointers;var e=d.length;if(!c.firstInput){c.firstInput=ja(b)}if(e>1&&!c.firstMultiple){c.firstMultiple=ja(b)}else if(e===1){c.firstMultiple=false}var f=c.firstInput;var g=c.firstMultiple;var h=g?g.center:f.center;var k=b.center=ka(d);b.timeStamp=j();b.deltaTime=b.timeStamp-f.timeStamp;b.angle=oa(h,k);b.distance=na(h,k);ha(c,b);b.offsetDirection=ma(b.deltaX,b.deltaY);var l=la(b.deltaTime,b.deltaX,b.deltaY);b.overallVelocityX=l.x;b.overallVelocityY=l.y;b.overallVelocity=i(l.x)>i(l.y)?l.x:l.y;b.scale=g?qa(g.pointers,d):1;b.rotation=g?pa(g.pointers,d):0;b.maxPointers=!c.prevInput?b.pointers.length:b.pointers.length>c.prevInput.maxPointers?b.pointers.length:c.prevInput.maxPointers;ia(c,b);var m=a.element;if(x(b.srcEvent.target,m)){m=b.srcEvent.target}b.target=m}function ha(a,b){var c=b.center;var d=a.offsetDelta||{};var e=a.prevDelta||{};var f=a.prevInput||{};if(b.eventType===Q||f.eventType===S){e=a.prevDelta={x:f.deltaX||0,y:f.deltaY||0};d=a.offsetDelta={x:c.x,y:c.y}}b.deltaX=e.x+(c.x-d.x);b.deltaY=e.y+(c.y-d.y)}function ia(a,b){var c=a.lastInterval||b,e=b.timeStamp-c.timeStamp,f,g,h,j;if(b.eventType!=T&&(e>P||c.velocity===d)){var k=b.deltaX-c.deltaX;var l=b.deltaY-c.deltaY;var m=la(e,k,l);g=m.x;h=m.y;f=i(m.x)>i(m.y)?m.x:m.y;j=ma(k,l);a.lastInterval=b}else{f=c.velocity;g=c.velocityX;h=c.velocityY;j=c.direction}b.velocity=f;b.velocityX=g;b.velocityY=h;b.direction=j}function ja(a){var b=[];var c=0;while(c<a.pointers.length){b[c]={clientX:h(a.pointers[c].clientX),clientY:h(a.pointers[c].clientY)};c++}return{timeStamp:j(),pointers:b,center:ka(b),deltaX:a.deltaX,deltaY:a.deltaY}}function ka(a){var b=a.length;if(b===1){return{x:h(a[0].clientX),y:h(a[0].clientY)}}var c=0,d=0,e=0;while(e<b){c+=a[e].clientX;d+=a[e].clientY;e++}return{x:h(c/b),y:h(d/b)}}function la(a,b,c){return{x:b/a||0,y:c/a||0}}function ma(a,b){if(a===b){return U}if(i(a)>=i(b)){return a<0?V:W}return b<0?X:Y}function na(a,b,c){if(!c){c=ba}var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return Math.sqrt(d*d+e*e)}function oa(a,b,c){if(!c){c=ba}var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return Math.atan2(e,d)*180/Math.PI}function pa(a,b){return oa(b[1],b[0],ca)+oa(a[1],a[0],ca)}function qa(a,b){return na(b[0],b[1],ca)/na(a[0],a[1],ca)}var ra={mousedown:Q,mousemove:R,mouseup:S};var sa="mousedown";var ta="mousemove mouseup";function ua(){this.evEl=sa;this.evWin=ta;this.pressed=false;da.apply(this,arguments)}r(ua,da,{handler:function a(b){var c=ra[b.type];if(c&Q&&b.button===0){this.pressed=true}if(c&R&&b.which!==1){c=S}if(!this.pressed){return}if(c&S){this.pressed=false}this.callback(this.manager,c,{pointers:[b],changedPointers:[b],pointerType:N,srcEvent:b})}});var va={pointerdown:Q,pointermove:R,pointerup:S,pointercancel:T,pointerout:T};var wa={2:L,3:M,4:N,5:O};var xa="pointerdown";var ya="pointermove pointerup pointercancel";if(a.MSPointerEvent&&!a.PointerEvent){xa="MSPointerDown";ya="MSPointerMove MSPointerUp MSPointerCancel"}function za(){this.evEl=xa;this.evWin=ya;da.apply(this,arguments);this.store=this.manager.session.pointerEvents=[]}r(za,da,{handler:function a(b){var c=this.store;var d=false;var e=b.type.toLowerCase().replace("ms","");var f=va[e];var g=wa[b.pointerType]||b.pointerType;var h=g==L;var i=A(c,b.pointerId,"pointerId");if(f&Q&&(b.button===0||h)){if(i<0){c.push(b);i=c.length-1}}else if(f&(S|T)){d=true}if(i<0){return}c[i]=b;this.callback(this.manager,f,{pointers:c,changedPointers:[b],pointerType:g,srcEvent:b});if(d){c.splice(i,1)}}});var Aa={touchstart:Q,touchmove:R,touchend:S,touchcancel:T};var Ba="touchstart";var Ca="touchstart touchmove touchend touchcancel";function Da(){this.evTarget=Ba;this.evWin=Ca;this.started=false;da.apply(this,arguments)}r(Da,da,{handler:function a(b){var c=Aa[b.type];if(c===Q){this.started=true}if(!this.started){return}var d=Ea.call(this,b,c);if(c&(S|T)&&d[0].length-d[1].length===0){this.started=false}this.callback(this.manager,c,{pointers:d[0],changedPointers:d[1],pointerType:L,srcEvent:b})}});function Ea(a,b){var c=B(a.touches);var d=B(a.changedTouches);if(b&(S|T)){c=C(c.concat(d),"identifier",true)}return[c,d]}var Fa={touchstart:Q,touchmove:R,touchend:S,touchcancel:T};var Ga="touchstart touchmove touchend touchcancel";function Ha(){this.evTarget=Ga;this.targetIds={};da.apply(this,arguments)}r(Ha,da,{handler:function a(b){var c=Fa[b.type];var d=Ia.call(this,b,c);if(!d){return}this.callback(this.manager,c,{pointers:d[0],changedPointers:d[1],pointerType:L,srcEvent:b})}});function Ia(a,b){var c=B(a.touches);var d=this.targetIds;if(b&(Q|R)&&c.length===1){d[c[0].identifier]=true;return[c,c]}var e,f,g=B(a.changedTouches),h=[],i=this.target;f=c.filter(function(a){return x(a.target,i)});if(b===Q){e=0;while(e<f.length){d[f[e].identifier]=true;e++}}e=0;while(e<g.length){if(d[g[e].identifier]){h.push(g[e])}if(b&(S|T)){delete d[g[e].identifier]}e++}if(!h.length){return}return[C(f.concat(h),"identifier",true),h]}var Ja=2500;var Ka=25;function La(){da.apply(this,arguments);var a=s(this.handler,this);this.touch=new Ha(this.manager,a);this.mouse=new ua(this.manager,a);this.primaryTouch=null;this.lastTouches=[]}r(La,da,{handler:function a(b,c,d){var e=d.pointerType==L,f=d.pointerType==N;if(f&&d.sourceCapabilities&&d.sourceCapabilities.firesTouchEvents){return}if(e){Ma.call(this,c,d)}else if(f&&Oa.call(this,d)){return}this.callback(b,c,d)},destroy:function a(){this.touch.destroy();this.mouse.destroy()}});function Ma(a,b){if(a&Q){this.primaryTouch=b.changedPointers[0].identifier;Na.call(this,b)}else if(a&(S|T)){Na.call(this,b)}}function Na(a){var b=a.changedPointers[0];if(b.identifier===this.primaryTouch){var c={x:b.clientX,y:b.clientY};this.lastTouches.push(c);var d=this.lastTouches;var e=function(){var a=d.indexOf(c);if(a>-1){d.splice(a,1)}};setTimeout(e,Ja)}}function Oa(a){var b=a.srcEvent.clientX,c=a.srcEvent.clientY;for(var d=0;d<this.lastTouches.length;d++){var e=this.lastTouches[d];var f=Math.abs(b-e.x),g=Math.abs(c-e.y);if(f<=Ka&&g<=Ka){return true}}return false}var Pa=D(f.style,"touchAction");var Qa=Pa!==d;var Ra="compute";var Sa="auto";var Ta="manipulation";var Ua="none";var Va="pan-x";var Wa="pan-y";var Xa=$a();function Ya(a,b){this.manager=a;this.set(b)}Ya.prototype={set:function(a){if(a==Ra){a=this.compute()}if(Qa&&this.manager.element.style&&Xa[a]){this.manager.element.style[Pa]=a}this.actions=a.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var a=[];m(this.manager.recognizers,function(b){if(t(b.options.enable,[b])){a=a.concat(b.getTouchAction())}});return Za(a.join(" "))},preventDefaults:function(a){var b=a.srcEvent;var c=a.offsetDirection;if(this.manager.session.prevented){b.preventDefault();return}var d=this.actions;var e=y(d,Ua)&&!Xa[Ua];var f=y(d,Wa)&&!Xa[Wa];var g=y(d,Va)&&!Xa[Va];if(e){var h=a.pointers.length===1;var i=a.distance<2;var j=a.deltaTime<250;if(h&&i&&j){return}}if(g&&f){return}if(e||f&&c&Z||g&&c&_){return this.preventSrc(b)}},preventSrc:function(a){this.manager.session.prevented=true;a.preventDefault()}};function Za(a){if(y(a,Ua)){return Ua}var b=y(a,Va);var c=y(a,Wa);if(b&&c){return Ua}if(b||c){return b?Va:Wa}if(y(a,Ta)){return Ta}return Sa}function $a(){if(!Qa){return false}var b={};var c=a.CSS&&a.CSS.supports;["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(d){b[d]=c?a.CSS.supports("touch-action",d):true});return b}var _a=1;var ab=2;var bb=4;var cb=8;var db=cb;var eb=16;var fb=32;function gb(a){this.options=o({},this.defaults,a||{});this.id=F();this.manager=null;this.options.enable=u(this.options.enable,true);this.state=_a;this.simultaneous={};this.requireFail=[]}gb.prototype={defaults:{},set:function(a){o(this.options,a);this.manager&&this.manager.touchAction.update();return this},recognizeWith:function(a){if(l(a,"recognizeWith",this)){return this}var b=this.simultaneous;a=jb(a,this);if(!b[a.id]){b[a.id]=a;a.recognizeWith(this)}return this},dropRecognizeWith:function(a){if(l(a,"dropRecognizeWith",this)){return this}a=jb(a,this);delete this.simultaneous[a.id];return this},requireFailure:function(a){if(l(a,"requireFailure",this)){return this}var b=this.requireFail;a=jb(a,this);if(A(b,a)===-1){b.push(a);a.requireFailure(this)}return this},dropRequireFailure:function(a){if(l(a,"dropRequireFailure",this)){return this}a=jb(a,this);var b=A(this.requireFail,a);if(b>-1){this.requireFail.splice(b,1)}return this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(a){return!!this.simultaneous[a.id]},emit:function(a){var b=this;var c=this.state;function d(c){b.manager.emit(c,a)}if(c<cb){d(b.options.event+hb(c))}d(b.options.event);if(a.additionalEvent){d(a.additionalEvent)}if(c>=cb){d(b.options.event+hb(c))}},tryEmit:function(a){if(this.canEmit()){return this.emit(a)}this.state=fb},canEmit:function(){var a=0;while(a<this.requireFail.length){if(!(this.requireFail[a].state&(fb|_a))){return false}a++}return true},recognize:function(a){var b=o({},a);if(!t(this.options.enable,[this,b])){this.reset();this.state=fb;return}if(this.state&(db|eb|fb)){this.state=_a}this.state=this.process(b);if(this.state&(ab|bb|cb|eb)){this.tryEmit(b)}},process:function(a){},getTouchAction:function(){},reset:function(){}};function hb(a){if(a&eb){return"cancel"}else if(a&cb){return"end"}else if(a&bb){return"move"}else if(a&ab){return"start"}return""}function ib(a){if(a==Y){return"down"}else if(a==X){return"up"}else if(a==V){return"left"}else if(a==W){return"right"}return""}function jb(a,b){var c=b.manager;if(c){return c.get(a)}return a}function kb(){gb.apply(this,arguments)}r(kb,gb,{defaults:{pointers:1},attrTest:function(a){var b=this.options.pointers;return b===0||a.pointers.length===b},process:function(a){var b=this.state;var c=a.eventType;var d=b&(ab|bb);var e=this.attrTest(a);if(d&&(c&T||!e)){return b|eb}else if(d||e){if(c&S){return b|cb}else if(!(b&ab)){return ab}return b|bb}return fb}});function lb(){kb.apply(this,arguments);this.pX=null;this.pY=null}r(lb,kb,{defaults:{event:"pan",threshold:10,pointers:1,direction:aa},getTouchAction:function(){var a=this.options.direction;var b=[];if(a&Z){b.push(Wa)}if(a&_){b.push(Va)}return b},directionTest:function(a){var b=this.options;var c=true;var d=a.distance;var e=a.direction;var f=a.deltaX;var g=a.deltaY;if(!(e&b.direction)){if(b.direction&Z){e=f===0?U:f<0?V:W;c=f!=this.pX;d=Math.abs(a.deltaX)}else{e=g===0?U:g<0?X:Y;c=g!=this.pY;d=Math.abs(a.deltaY)}}a.direction=e;return c&&d>b.threshold&&e&b.direction},attrTest:function(a){return kb.prototype.attrTest.call(this,a)&&(this.state&ab||!(this.state&ab)&&this.directionTest(a))},emit:function(a){this.pX=a.deltaX;this.pY=a.deltaY;var b=ib(a.direction);if(b){a.additionalEvent=this.options.event+b}this._super.emit.call(this,a)}});function mb(){kb.apply(this,arguments)}r(mb,kb,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ua]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.scale-1)>this.options.threshold||this.state&ab)},emit:function(a){if(a.scale!==1){var b=a.scale<1?"in":"out";a.additionalEvent=this.options.event+b}this._super.emit.call(this,a)}});function nb(){gb.apply(this,arguments);this._timer=null;this._input=null}r(nb,gb,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Sa]},process:function(a){var b=this.options;var c=a.pointers.length===b.pointers;var d=a.distance<b.threshold;var e=a.deltaTime>b.time;this._input=a;if(!d||!c||a.eventType&(S|T)&&!e){this.reset()}else if(a.eventType&Q){this.reset();this._timer=k(function(){this.state=db;this.tryEmit()},b.time,this)}else if(a.eventType&S){return db}return fb},reset:function(){clearTimeout(this._timer)},emit:function(a){if(this.state!==db){return}if(a&&a.eventType&S){this.manager.emit(this.options.event+"up",a)}else{this._input.timeStamp=j();this.manager.emit(this.options.event,this._input)}}});function ob(){kb.apply(this,arguments)}r(ob,kb,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ua]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.rotation)>this.options.threshold||this.state&ab)}});function pb(){kb.apply(this,arguments)}r(pb,kb,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Z|_,pointers:1},getTouchAction:function(){return lb.prototype.getTouchAction.call(this)},attrTest:function(a){var b=this.options.direction;var c;if(b&(Z|_)){c=a.overallVelocity}else if(b&Z){c=a.overallVelocityX}else if(b&_){c=a.overallVelocityY}return this._super.attrTest.call(this,a)&&b&a.offsetDirection&&a.distance>this.options.threshold&&a.maxPointers==this.options.pointers&&i(c)>this.options.velocity&&a.eventType&S},emit:function(a){var b=ib(a.offsetDirection);if(b){this.manager.emit(this.options.event+b,a)}this.manager.emit(this.options.event,a)}});function qb(){gb.apply(this,arguments);this.pTime=false;this.pCenter=false;this._timer=null;this._input=null;this.count=0}r(qb,gb,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Ta]},process:function(a){var b=this.options;var c=a.pointers.length===b.pointers;var d=a.distance<b.threshold;var e=a.deltaTime<b.time;this.reset();if(a.eventType&Q&&this.count===0){return this.failTimeout()}if(d&&e&&c){if(a.eventType!=S){return this.failTimeout()}var f=this.pTime?a.timeStamp-this.pTime<b.interval:true;var g=!this.pCenter||na(this.pCenter,a.center)<b.posThreshold;this.pTime=a.timeStamp;this.pCenter=a.center;if(!g||!f){this.count=1}else{this.count+=1}this._input=a;var h=this.count%b.taps;if(h===0){if(!this.hasRequireFailures()){return db}else{this._timer=k(function(){this.state=db;this.tryEmit()},b.interval,this);return ab}}}return fb},failTimeout:function(){this._timer=k(function(){this.state=fb},this.options.interval,this);return fb},reset:function(){clearTimeout(this._timer)},emit:function(){if(this.state==db){this._input.tapCount=this.count;this.manager.emit(this.options.event,this._input)}}});function rb(a,b){b=b||{};b.recognizers=u(b.recognizers,rb.defaults.preset);return new ub(a,b)}rb.VERSION="2.0.7";rb.defaults={domEvents:false,touchAction:Ra,enable:true,inputTarget:null,inputClass:null,preset:[[ob,{enable:false}],[mb,{enable:false},["rotate"]],[pb,{direction:Z}],[lb,{direction:Z},["swipe"]],[qb],[qb,{event:"doubletap",taps:2},["tap"]],[nb]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var sb=1;var tb=2;function ub(a,b){this.options=o({},rb.defaults,b||{});this.options.inputTarget=this.options.inputTarget||a;this.handlers={};this.session={};this.recognizers=[];this.oldCssProps={};this.element=a;this.input=ea(this);this.touchAction=new Ya(this,this.options.touchAction);vb(this,true);m(this.options.recognizers,function(a){var b=this.add(new a[0](a[1]));a[2]&&b.recognizeWith(a[2]);a[3]&&b.requireFailure(a[3])},this)}ub.prototype={set:function(a){o(this.options,a);if(a.touchAction){this.touchAction.update()}if(a.inputTarget){this.input.destroy();this.input.target=a.inputTarget;this.input.init()}return this},stop:function(a){this.session.stopped=a?tb:sb},recognize:function(a){var b=this.session;if(b.stopped){return}this.touchAction.preventDefaults(a);var c;var d=this.recognizers;var e=b.curRecognizer;if(!e||e&&e.state&db){e=b.curRecognizer=null}var f=0;while(f<d.length){c=d[f];if(b.stopped!==tb&&(!e||c==e||c.canRecognizeWith(e))){c.recognize(a)}else{c.reset()}if(!e&&c.state&(ab|bb|cb)){e=b.curRecognizer=c}f++}},get:function(a){if(a instanceof gb){return a}var b=this.recognizers;for(var c=0;c<b.length;c++){if(b[c].options.event==a){return b[c]}}return null},add:function(a){if(l(a,"add",this)){return this}var b=this.get(a.options.event);if(b){this.remove(b)}this.recognizers.push(a);a.manager=this;this.touchAction.update();return a},remove:function(a){if(l(a,"remove",this)){return this}a=this.get(a);if(a){var b=this.recognizers;var c=A(b,a);if(c!==-1){b.splice(c,1);this.touchAction.update()}}return this},on:function(a,b){if(a===d){return}if(b===d){return}var c=this.handlers;m(z(a),function(a){c[a]=c[a]||[];c[a].push(b)});return this},off:function(a,b){if(a===d){return}var c=this.handlers;m(z(a),function(a){if(!b){delete c[a]}else{c[a]&&c[a].splice(A(c[a],b),1)}});return this},emit:function(a,b){if(this.options.domEvents){wb(a,b)}var c=this.handlers[a]&&this.handlers[a].slice();if(!c||!c.length){return}b.type=a;b.preventDefault=function(){b.srcEvent.preventDefault()};var d=0;while(d<c.length){c[d](b);d++}},destroy:function(){this.element&&vb(this,false);this.handlers={};this.session={};this.input.destroy();this.element=null}};function vb(a,b){var c=a.element;if(!c.style){return}var d;m(a.options.cssProps,function(e,f){d=D(c.style,f);if(b){a.oldCssProps[d]=c.style[d];c.style[d]=e}else{c.style[d]=a.oldCssProps[d]||""}});if(!b){a.oldCssProps={}}}function wb(a,c){var d=b.createEvent("Event");d.initEvent(a,true,true);d.gesture=c;c.target.dispatchEvent(d)}o(rb,{INPUT_START:Q,INPUT_MOVE:R,INPUT_END:S,INPUT_CANCEL:T,STATE_POSSIBLE:_a,STATE_BEGAN:ab,STATE_CHANGED:bb,STATE_ENDED:cb,STATE_RECOGNIZED:db,STATE_CANCELLED:eb,STATE_FAILED:fb,DIRECTION_NONE:U,DIRECTION_LEFT:V,DIRECTION_RIGHT:W,DIRECTION_UP:X,DIRECTION_DOWN:Y,DIRECTION_HORIZONTAL:Z,DIRECTION_VERTICAL:_,DIRECTION_ALL:aa,Manager:ub,Input:da,TouchAction:Ya,TouchInput:Ha,MouseInput:ua,PointerEventInput:za,TouchMouseInput:La,SingleTouchInput:Da,Recognizer:gb,AttrRecognizer:kb,Tap:qb,Pan:lb,Swipe:pb,Pinch:mb,Rotate:ob,Press:nb,on:v,off:w,each:m,merge:q,extend:p,assign:o,inherit:r,bindFn:s,prefixed:D});var xb=typeof a!=="undefined"?a:typeof self!=="undefined"?self:{};xb.Hammer=rb;if(typeof define==="function"&&define.amd){define("hammerjs/hammer",function(){return rb})}else if(typeof module!="undefined"&&module.exports){module.exports=rb}else{a[c]=rb}})(window,document,"Hammer");define("hammerjs",["hammerjs/hammer"],function(a){return a});(function(a,b){typeof exports==="object"&&typeof module!=="undefined"?b(exports):typeof define==="function"&&define.amd?define("@iframe/amp-viewer/amp-viewer",["exports"],b):(a=typeof globalThis!=="undefined"?globalThis:a||self,b(a["@iframe/amp-viewer"]={}))})(this,function(exports){"use strict";var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)if(Object.prototype.hasOwnProperty.call(b,c))a[c]=b[c]};return a(b,c)};function b(b,c){a(b,c);function d(){this.constructor=b}b.prototype=c===null?Object.create(c):(d.prototype=c.prototype,new d)}var c=function(){c=Object.assign||function a(b){for(var c,d=1,e=arguments.length;d<e;d++){c=arguments[d];for(var f in c)if(Object.prototype.hasOwnProperty.call(c,f))b[f]=c[f]}return b};return c.apply(this,arguments)};function d(){for(var a=0,b=0,c=arguments.length;b<c;b++)a+=arguments[b].length;for(var d=Array(a),e=0,b=0;b<c;b++)for(var f=arguments[b],g=0,h=f.length;g<h;g++,e++)d[e]=f[g];return d}function e(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a["default"]:a}function f(a,b){return b={exports:{}},a(b,b.exports),b.exports}var g=f(function(a,exports){Object.defineProperty(exports,"__esModule",{value:true});var b="initial";function c(a,b,c){if(typeof b==="function"){return new d(a,void 0,b)}return new d(a,b,c)}var d=function(){function a(a,b,c){this.state=a;this.signal=b;this.implementation=c}a.prototype.onConditionsMet=function(a){};a.prototype.onConditionsUnmet=function(a){};return a}();var e=function(){function a(a){this.transitions=a;this.currentState=b;this.possibleTransitions=[]}Object.defineProperty(a.prototype,"state",{get:function(){return this.currentState},enumerable:true,configurable:true});a.prototype.transition=function(a){var b=[];for(var c=1;c<arguments.length;c++){b[c-1]=arguments[c]}var d=this.findTransitions(a);var e=this.state;for(var f=0,g=d;f<g.length;f++){var h=g[f];this.doTransition.apply(this,[h.implementation].concat(b));if(e!==this.state){return}}};a.prototype.reset=function(){this.doTransition(b)};a.prototype.doTransition=function(a){var b=this;var c=[];for(var d=1;d<arguments.length;d++){c[d-1]=arguments[d]}this.possibleTransitions.forEach(function(a){return a.onConditionsUnmet(b)});if(typeof a==="function"){this.currentState=a.apply(void 0,[this].concat(c))}else{this.currentState=a}this.possibleTransitions=this.getPossibleTransitions();this.possibleTransitions.forEach(function(a){return a.onConditionsMet(b)})};a.prototype.getPossibleTransitions=function(){var a=this;return this.transitions.filter(function(b){return b.state===a.state})};a.prototype.findTransitions=function(a){return this.getPossibleTransitions().filter(function(b){return b.signal===a||b.signal===void 0})};return a}();function f(a){return new e(a)}var g=function(a,b){g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)if(b.hasOwnProperty(c))a[c]=b[c]};return g(a,b)};function h(a,b){g(a,b);function c(){this.constructor=a}a.prototype=b===null?Object.create(b):(c.prototype=b.prototype,new c)}var i=function(a){h(b,a);function b(c,d,e){var f=a.call(this,c,b.signal(e),d)||this;f.ms=e;return f}b.signal=function(a){return"_$timer"+a};b.prototype.onConditionsMet=function(b){a.prototype.onConditionsMet.call(this,b);this.timer=setTimeout(this.handleTimer.bind(this,b),this.ms)};b.prototype.onConditionsUnmet=function(b){a.prototype.onConditionsUnmet.call(this,b);clearTimeout(this.timer)};b.prototype.handleTimer=function(a){a.transition(b.signal(this.ms))};return b}(d);function j(a,b,c){return new i(a,c,b)}var k=function(a){h(b,a);function b(b,c,d){return a.call(this,b,c,function(){var a=[];for(var c=0;c<arguments.length;c++){a[c]=arguments[c]}d.apply(void 0,a);return b})||this}return b}(d);function l(a,b,c){if(typeof b==="function"){c=b;b=void 0}return new k(a,b,c)}function m(a){var b=function(c){if(typeof c==="function"){return b({})(c)}return function(b){var d=function(b){h(d,b);function d(){var d=[];for(var e=0;e<arguments.length;e++){d[e]=arguments[e]}var f=b.apply(this,d)||this;a.onConstruct(f,c);return f}return d}(b);a.onPatch(d,c);return d}};return b}function n(a,b,c){var d=a.prototype[b];var e=typeof d==="function";a.prototype[b]=function a(){c.apply(this,arguments);if(e){return d.apply(this,arguments)}}}var o="create";var p="mount";var q="update";var r="unmount";var s="catch";var t=function(a){h(b,a);function b(b){var c=a.call(this,b.transitions||[])||this;c.component=b;c.handlers={};return c}b.prototype.signal=function(a){var b=this;var c=String(a);if(!this.handlers[c]){this.handlers[c]=function(c){b.transition(a,c)}}return this.handlers[c]};b.prototype.transition=function(b){var c=[];for(var d=1;d<arguments.length;d++){c[d-1]=arguments[d]}var e;a.prototype.transition.apply(this,[b].concat(c));if(typeof this.mapToState!=="string"){return}if(this.component.state[this.mapToState]!==this.state){this.component.setState((e={},e[this.mapToState]=this.state,e))}};b.prototype.doTransition=function(b){var c=this;var d=[];for(var e=1;e<arguments.length;e++){d[e-1]=arguments[e]}if(typeof b!=="function"){return a.prototype.doTransition.call(this,b)}a.prototype.doTransition.call(this,function(){return b.apply(void 0,[c.component].concat(d))},d)};return b}(e);var u={onPatch:function(a,b){var c=b.catching;n(a,"componentDidMount",function(){this.automaton.transition(p)});n(a,"componentDidUpdate",function(a,b){this.automaton.transition(q,a,b)});n(a,"componentWillUnmount",function(){this.automaton.transition(r);this.automaton.reset()});c&&n(a,"componentDidCatch",function(a,b){this.automaton.transition(s,a,b)})},onConstruct:function(a,b){a.automaton=new t(a);a.automaton.transition(o,a);if(typeof b.mapToState==="string"){if(!a.state){a.state={}}a.state[b.mapToState]=a.automaton.state;a.automaton.mapToState=b.mapToState}}};var v=m(u);function w(a){return a.automaton}function x(a,b){return w(a).signal(b)}exports.INITIAL=b;exports.transition=c;exports.automaton=f;exports.Automaton=e;exports.Transition=d;exports.timer=j;exports.sideEffect=l;exports.CATCH=s;exports.CREATE=o;exports.MOUNT=p;exports.UNMOUNT=r;exports.UPDATE=q;exports.withAutomaton=v;exports.automatonOf=w;exports.asSignal=x});e(g);var h=g.INITIAL;var i=g.transition;var j=g.automaton;var k=g.Automaton;var l=g.Transition;var m=g.timer;var n=g.sideEffect;var o=g.CATCH;var p=g.CREATE;var q=g.MOUNT;var r=g.UNMOUNT;var s=g.UPDATE;var t=g.withAutomaton;var u=g.automatonOf;var v=g.asSignal;var w=function(){function a(){this.handlers={}}a.prototype.on=function(a,b){this.handlers[a]||(this.handlers[a]=[]);this.handlers[a].push(b)};a.prototype.off=function(a,b){if(!this.handlers[a]){return}this.handlers[a]=this.handlers[a].filter(function(a){return b!==a})};a.prototype.emit=function(a,b){(this.handlers[a]||[]).forEach(function(a){return a(b)})};return a}();var x="ready";var y="content";var z="resize";var A="theme";var B="css_selector_theme";var C="configure";var D="configured";var E="error";var F="navigate";var G="radar";var H="#?__mrg_frame_id=";var I="timeout";var J="@@mail-amp-postMessage$";var K=function(a){b(d,a);function d(b){var e=a.call(this)||this;e.id=d.lastId++;e.options=c({},b);e.id=b.id||e.id;e.handleMessage=e.handleMessage.bind(e);return e}d.prototype.setup=function(){this.options.selfWindow.addEventListener("message",this.handleMessage)};d.prototype.teardown=function(){this.options.selfWindow.removeEventListener("message",this.handleMessage)};d.prototype.sendMessage=function(a){var b=a.type;if(this.options.debug){console.warn("[SEND]",b,a)}var c=this.id+J;this.options.targetWindow.postMessage(c+JSON.stringify(a),this.options.targetOrigin||"*")};d.prototype.setDebug=function(a){this.options.debug=a};d.prototype.setTargetWindow=function(a){this.options.targetWindow=a};d.prototype.setTargetOrigin=function(a){this.options.targetOrigin=a};d.prototype.setId=function(a){this.id=a};d.prototype.getId=function(){return this.id};d.prototype.handleMessage=function(a){var b=this.options.originRegexp;if(b&&!b.test(a.origin)){if(this.options.debug){console.error("[RECEIVE] Received message from prohibited origin:",a.origin)}return}var c;try{var d=String(a.data);var e=""+this.id+J;if(d.startsWith(e)){c=JSON.parse(a.data.slice(e.length))}else{return}}catch(a){console.error(a);return}if(this.options.debug){console.warn("[RECEIVE]",c.type,c)}this.emit(c.type,c)};d.lastId=0;return d}(w);function L(a){return Object.keys(a).map(function(b){return encodeURIComponent(b)+"="+encodeURIComponent(a[b])}).join("&")}var M=/^(https?:\/\/)?(.*\.)?(imgs|dev|mini-)?mail\.ru$/;var N=/^(https?:\/\/)?localhost:?/;var O=N.test(location.href)?undefined:M;var P="initial";var Q="creation";var R="loading";var S="error";var T="configuring";var U="ready";var V="event-error";var W="ready";var X="error";var Y="warning";var Z="resize";var _="navigate";var aa="radar";var ba=function(a){b(e,a);function e(b){var d=a.call(this)||this;d.theme=null;d.options=c({},b);d.transport=new K(c({selfWindow:window,originRegexp:O,debug:b.debug},b.transport));return d}e.prototype.setup=function(){var a=this;this.initializeController();this.transport.setup();[x,D,z,B,F,G,E].forEach(function(b){return a.transport.on(b,a.asSignal(b))});this.automaton.transition(undefined)};e.prototype.teardown=function(){this.automaton.reset();this.transport.teardown()};e.prototype.loadLetter=function(a){this.letter=a;if(this.automaton.state===U){this.transport.sendMessage({type:y,data:this.letter})}};e.prototype.setTheme=function(a){this.theme=a;if(this.automaton.state===U){this.transport.sendMessage({type:A,data:this.theme})}};e.prototype.onChangeCssSelectorTheme=function(a){this.transport.on(B,function(b){var c=b.data;return a(c)})};e.prototype.errorReporter=function(a,b){var c=this;return function(){var d={data:{type:a,error:b}};c.emit(X,d.data);return S}};e.prototype.asSignal=function(a){var b=this;return function(c){b.automaton.transition(a,c)}};e.prototype.initializeController=function(){var a=this;this.automaton=j(d([i(P,"create",Q),i(Q,function(){var b=a.options.iframeSrc;a.iframe=a.options.iframe||document.createElement("iframe");var c=["xhrInterceptor","viewerRenderTemplate"];a.iframe.setAttribute("scrolling","no");a.iframe.setAttribute("allowfullscreen","false");a.iframe.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin");a.iframe.setAttribute("allow","accelerometer 'none';autoplay 'none';"+"camera 'none';document-domain 'none';encrypted-media 'none';fullscreen 'none';"+"geolocation 'none';gyroscope 'none';magnetometer 'none';microphone 'none';midi 'none';"+"payment 'none';picture-in-picture 'none';sync-xhr 'none';usb 'none';xr-spatial-tracking 'none';");a.iframe.src=b+H+a.transport.getId()+"&"+L({origin:window.location.origin,prerenderSize:0,visibilityState:"visible",viewportType:a.options.mobileSafari?"natural":"natural-ios-embed",paddingTop:0,history:1,p2r:0,storage:0,development:0,log:1,cap:c.join(","),csi:0});if(/^https?:\/\//.test(b)){var d=b.split("/");var e=d[0]+"//"+d[2];a.transport.setTargetOrigin(e)}a.iframe.onerror=a.asSignal(V);return R}),m(R,this.options.timeout,this.errorReporter(I,"Iframe loading timed out")),i(R,x,function(){a.transport.setTargetWindow(a.iframe.contentWindow);a.transport.sendMessage({type:C,data:a.options});return T}),m(T,this.options.timeout,this.errorReporter(I,"Iframe configuring timed out")),i(T,D,function(){if(a.letter){a.transport.sendMessage({type:y,data:a.letter})}if(a.theme!==null){a.transport.sendMessage({type:A,data:a.theme})}a.emit(W,undefined);return U}),n(U,z,function(b,c){a.iframe.style.height=c.data.height+"px";a.emit(Z,c.data)}),n(U,F,function(b,c){a.emit(_,c.data)})],[P,R,T,U,S].map(function(b){return n(b,G,function(b,c){a.emit(aa,c.data)})}),[P,R,T,U].map(function(b){return i(b,E,function(c,d){if(d.data.type==="timeout"||d.data.type==="validation"||d.data.type==="lib_untrusted"){a.emit(X,d.data);return S}a.emit(Y,d.data);return b})})));this.automaton.transition("create")};return e}(w);function ca(a){return new ba(a)}exports.createAmpViewer=ca;Object.defineProperty(exports,"__esModule",{value:true})});define("@iframe/amp-viewer",["@iframe/amp-viewer/amp-viewer"],function(a){return a});(function(){"use strict";var a=Function("return this")();var b,c={},d={16:false,18:false,17:false,91:false},e="all",f={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,command:91},g={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220},h=function(a){return g[a]||a.toUpperCase().charCodeAt(0)},i=[];for(b=1;b<20;b++)g["f"+b]=111+b;function j(a,b){var c=a.length;while(c--)if(a[c]===b)return c;return-1}function k(a,b){if(a.length!=b.length)return false;for(var c=0;c<a.length;c++){if(a[c]!==b[c])return false}return true}var l={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"};function m(a){for(b in d)d[b]=a[l[b]]}function n(a){o(a);var b,e,g,h,k,l;b=a.keyCode;if(j(i,b)==-1){i.push(b)}if(b==93||b==224)b=91;if(b in d){d[b]=true;for(g in f)if(f[g]==b)s[g]=true;return}m(a);if(!s.filter.call(this,a))return;if(!(b in c))return;l=z();h=c[b].length;while(h--){e=c[b][h];if(e.scope==l||e.scope=="all"||p(e.scope)){k=e.mods.length>0;for(g in d)if(!d[g]&&j(e.mods,+g)>-1||d[g]&&j(e.mods,+g)==-1)k=false;if(e.mods.length==0&&!d[16]&&!d[18]&&!d[17]&&!d[91]||k){if(e.method(a,e)===false){a.preventDefault();a.stopPropagation()}if(a.isImmediatePropagationStopped()){return true}}}}}function o(a){var b=false,c=false,d=a.stopImmediatePropagation;!a.target&&(a.target=a.srcElement);!a.isDefaultPrevented&&(a.isDefaultPrevented=function(){return b});!a.isImmediatePropagationStopped&&(a.isImmediatePropagationStopped=function(){return c});!a.preventDefault&&(a.preventDefault=function(){b=true;a.returnValue=false});!a.stopPropagation&&(a.stopPropagation=function(){a.cancelBubble=false});a.stopImmediatePropagation=function(){c=true;a.stopPropagation();d&&d.call(a)}}function p(a){if(a&&a.nodeType===1){do{if(a===document.body){return true}}while(a=a.parentNode)}return false}function q(a){var b=a.keyCode,c,e=j(i,b);if(e>=0){i.splice(e,1)}if(b==93||b==224)b=91;if(b in d){d[b]=false;for(c in f)if(f[c]==b)s[c]=false}}function r(){for(b in d)d[b]=false;for(b in f)s[b]=false}function s(a,b,d){var e,f,g;e=B(a);if(d===undefined){d=b;b="all"}for(var i=0;i<e.length;i++){f=[];a=e[i].split("+");if(a.length>1){f=C(a);a=[a[a.length-1]]}a=a[0];a=h(a);if(!(a in c))c[a]=[];g=u(a,b,d,f);if(g>-1){c[a].push(c[a].splice(g,1)[0])}else{c[a].push({shortcut:e[i],scope:b,method:d,key:e[i],mods:f})}}}function t(a,b,d){var e,f,g=[],i,j;e=B(a);if(!b||typeof b==="function"){d=b;b="all"}for(i=0;i<e.length;i++){f=e[i].split("+");if(f.length>1){g=C(f)}a=f[f.length-1];a=h(a);if(b===undefined){b=z()}do{j=u(a,b,d,g);if(j>-1){c[a].splice(j,1)}}while(j!=-1)}}function u(a,b,d,e){var f,g,h=c[a];if(h){for(f=0;f<h.length;f++){g=h[f];if(g.scope===b&&(d===undefined||g.method===d)&&k(g.mods,e)){return f}}}return-1}function v(a){if(typeof a=="string"){a=h(a)}return j(i,a)!=-1}function w(){return i.slice(0)}function x(a){var b=a.target.tagName;return!(b=="INPUT"||b=="SELECT"||b=="TEXTAREA")}for(b in f)s[b]=false;function y(a){e=a||"all"}function z(){return e||"all"}function A(a){var b,d,e;for(b in c){d=c[b];for(e=0;e<d.length;){if(d[e].scope===a)d.splice(e,1);else e++}}}function B(a){var b;a=a.replace(/\s/g,"");b=a.split(",");if(b[b.length-1]==""){b[b.length-2]+=","}return b}function C(a){var b=a.slice(0,a.length-1);for(var c=0;c<b.length;c++)b[c]=f[b[c]];return b}function D(a,b,c){if(a.addEventListener)a.addEventListener(b,c,false);else if(a.attachEvent)a.attachEvent("on"+b,function(){c(window.event)})}D(document,"keydown",function(a){if(n(a)!==true){var b=key.listeners,c=0,d=b.length;for(;c<d;c++){b[c](a);if(a.isImmediatePropagationStopped()){return true}}}});D(document,"keyup",q);D(window,"focus",r);var E=a.key;function F(){var b=a.key;a.key=E;return b}a.key=s;a.key.setScope=y;a.key.getScope=z;a.key.deleteScope=A;a.key.filter=x;a.key.isPressed=v;a.key.getPressedKeyCodes=w;a.key.noConflict=F;a.key.unbind=t;a.key.on=s;a.key.off=t;a.key.listeners=[];if(typeof module!=="undefined")module.exports=s;define("@mail/keymaster",[],function(){return s})})(this);(function(a,b){typeof exports==="object"&&typeof module!=="undefined"?b(exports):typeof define==="function"&&define.amd?define("@mail/release-detect",["exports"],b):(a=typeof globalThis!=="undefined"?globalThis:a||self,b(a["@mail/release-detect"]={}))})(this,function(exports){"use strict";var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)if(b.hasOwnProperty(c))a[c]=b[c]};return a(b,c)};function b(b,c){a(b,c);function d(){this.constructor=b}b.prototype=c===null?Object.create(c):(d.prototype=c.prototype,new d)}var c=function(){c=Object.assign||function a(b){for(var c,d=1,e=arguments.length;d<e;d++){c=arguments[d];for(var f in c)if(Object.prototype.hasOwnProperty.call(c,f))b[f]=c[f]}return b};return c.apply(this,arguments)};var d=function(a){b(c,a);function c(b){var c=a.call(this,"Assertion error: "+b)||this;c.name="AssertionError";return c}return c}(Error);function e(a,b){if(a&&typeof a=="object"){return}throw new d(b+" is not an object")}function f(a,b){if(typeof a!=="string"){throw new d(b+" is not a string")}}function g(a,b){if(!(a instanceof Date)||isNaN(+a)){throw new d(b+" is not a valid Date")}}function h(a,b){e(a,b);f(a["name"],b+".name");f(a["branch"],b+".branch");g(a["date"],b+".date");f(a["dateStr"],b+".dateStr")}function i(a,b){if(a){var c=a.split("."),e=c[0],f=c[1];if(e&&f){var g=new Date(f.replace(/_/g,":"));var i={name:a,branch:e,date:g,dateStr:f};h(i,b);return i}}throw new d(b+" is not a valid build string")}function j(a,b){e(a,b);if(a["build"]!==undefined){f(a["build"],b+".build")}}function k(a,b){j(a,b);return a}function l(a){return!!a&&typeof a==="object"&&typeof a["status"]==="number"}function m(a){return!!a.body&&typeof a.body==="object"&&a.status>=200&&a.status<300}var n=function(a){b(c,a);function c(b,c){var d=a.call(this,"XHRError on url "+c+": status "+b)||this;d.name="XHRError";d.status=b;d.url=c;return d}return c}(Error);function o(a,b){return new Promise(function(c,d){var e=new XMLHttpRequest;e.onreadystatechange=function(){if(e.readyState===4){if(e.status>=200&&e.status<300){c(e.responseText)}else{d(new n(e.status,a))}}};e.open("GET",a,true);e.timeout=b;e.send()})}var p=function(){function a(a,b){var d=this;if(b===void 0){b=3e4}this._data={};this._initialData={};this.shadowReloadPage=function(a,b){var e;d._initialData=c(c({},d._initialData),d._data);b("deploy_shadow",{i:(e={},e[d.config.name]=1,e)})};this.config=a;this.timeout=b;if(a.initialData){this._data=a.initialData;this._initialData=a.initialData}}Object.defineProperty(a.prototype,"data",{get:function(){return this._data},enumerable:false,configurable:true});a.prototype.update=function(){var a=this;var b=this._initialData;var c=typeof this.config.endpoint==="function"?this.config.endpoint():this.config.endpoint;return o(c,this.timeout).then(function(d){var e,f;var g=JSON.parse(d);var h={};if(l(g)){if(!m(g)){throw new n(g.status,c)}h=g.body}else{h=k(g,a.config.name)}var i=a.config.comparator(b,h);a._data=h;(f=(e=a.config).ondata)===null||f===void 0?void 0:f.call(e,h,a.config);if(a.config.shadow&&i.changed){i.reloadPage=a.shadowReloadPage}return i})};return a}();var q=["code","errno","syscall"];function r(a){if(!a||typeof a!=="object"){return a}if(typeof a.toJSON==="function"){return a.toJSON()}var b=c(c({},a),{name:a.name,message:a.message,stack:a.stack});for(var d=0,e=q;d<e.length;d++){var f=e[d];b[f]=a[f]}return b}function s(a){return Number.isNaN(a[0])||Number.isNaN(a[1])}function t(a,b){return b[0]<a[0]}function u(a,b){return b[1]<a[1]}function v(a){var b=a[0],c=a[1];return Math.floor(Math.random()*(c-b))+b}var w=function(){function a(a){var b=this;this._onError=function(a){var c;var d=false;if(a&&typeof a==="object"){if(a.name==="AssertionError"){b._radar(["deploy_fail","upd"])}if(a.name==="XHRError"){b._radar(["deploy_fail","xhr"],{i:(c={},c["status_"+a.status]=1,c)});d=true}}b._radar("deploy_fetch-error",!d?{rlog:"deploy_fetch-error",rlog_message:a instanceof Error?r(a):{error:"unknown"}}:undefined)};this._reload=function(a){location.href=a};this._config=c({},a);this._models=this._config.sources.map(function(b){return new p(b,a.xhrTimeout)});this._config.router.on("route-end",function(){b._fetchAndProcessConfig()});this._data=this._currentData()}a.prototype._currentData=function(){var a={};for(var b=0,c=this._models;b<c.length;b++){var d=c[b];var e=d.data;var f=Object.keys(e);for(var g=0,h=f;g<h.length;g++){var i=h[g];a[i]=e[i]}}return a};a.prototype._updateAll=function(){var a=this;return Promise.all(this._models.map(function(b){return b.update().catch(a._onError)})).then(function(a){var b={changed:false,reloadTimeRange:[NaN,NaN]};for(var c=0,d=a;c<d.length;c++){var e=d[c];if(!e||!e.changed){continue}b.changed=true;b.reloadPage=e.reloadPage;if(e.reason!==undefined){b.reason=e.reason}var f=s(b.reloadTimeRange);var g=t(b.reloadTimeRange,e.reloadTimeRange);var h=u(b.reloadTimeRange,e.reloadTimeRange);if(f||g&&h){b.reloadTimeRange=e.reloadTimeRange}}return b})};a.prototype._fetchAndProcessConfig=function(){var a=this;this._updateAll().then(function(b){var c;if(!b.changed){return}var d=a._currentData();var e=i((c=d.build)!==null&&c!==void 0?c:"","next");a._scheduleReload(e,b);a._radar("deploy_upd")}).catch(this._onError)};a.prototype._scheduleReload=function(a,b){var c=this;var d=v(b.reloadTimeRange);var e=d*1e3*60;if(this._reloadTid){return}this._reloadTid=setTimeout(function(){c._reloadTid=undefined;c._config.router.one("before-route",function(a){var d,e;if(a.target.activeRequest){var f=(d=b.reloadPage)!==null&&d!==void 0?d:c._reload;var g=a.target.activeRequest.href;if(c._config.location){g=c._config.location(g)}f(g,(e=c._config.xraySend)!==null&&e!==void 0?e:function(){return undefined})}});c._radar("deploy_switch");c._radar(["deploy_"+a.branch,a.dateStr]);if(b.reason!==undefined){c._radar("deploy_"+b.reason)}},e);this._radar("deploy_switch_reload_timeout",{v:d})};a.prototype._radar=function(a,b){if(this._config.xraySend){this._config.xraySend(a,b)}};return a}();var x=function(a,b){var c=Object.keys(a);var d=Object.keys(b);var e=c.length===d.length&&c.every(function(c){if(a[c]===""||b[c]===""){return true}return a[c]===b[c]});return{changed:!e,reason:e?undefined:this.name,reloadTimeRange:this.reloadTimeRange}};var y=function(a,b){if(!a.build&&!b.build){return{changed:false,reloadTimeRange:this.reloadTimeRange}}if(!a.build||!b.build){return{changed:true,reason:"upd_empty",reloadTimeRange:this.reloadTimeRange}}var c=i(a.build,"current");var d=i(b.build,"next");var e=c.name===d.name;return{changed:!e,reason:e?undefined:"upd_"+(d.date>c.date?"up":"down"),reloadTimeRange:this.reloadTimeRange}};function z(a,b){return function(c){var d=encodeURIComponent(a)+"="+encodeURIComponent(b);var e=c.indexOf("?")>=0;return""+c+(e?"&":"?")+d}}function A(){var a=[];for(var b=0;b<arguments.length;b++){a[b]=arguments[b]}return function(b){for(var c=0,d=a;c<d.length;c++){var e=d[c];b=e(b)}return b}}function B(a){return new w(a)}exports.appendQuery=z;exports.buildComparator=y;exports.combine=A;exports.createReleaseDetectClient=B;exports.hashComparator=x;Object.defineProperty(exports,"__esModule",{value:true})});var __assign=this&&this.__assign||function(){__assign=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++){b=arguments[c];for(var e in b)if(Object.prototype.hasOwnProperty.call(b,e))a[e]=b[e]}return a};return __assign.apply(this,arguments)};var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("temporary/fix-signature",["require","exports","@mail/features","@mail/flags","@mail/xray","cfgUser","service/auth"],function(require,exports,a,b,c,d,e){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.fixSignature=void 0;a=__importDefault(a);b=__importDefault(b);c=__importDefault(c);d=__importDefault(d);e=__importDefault(e);var f=/[\x00-\x1F\x22\x3C\x3E\x3A\xAD]/g;function g(a){return a&&typeof a==="object"}function h(a){if(typeof a==="string"){var b=a.replace(f,"");if(b.length){return b}}return""}function i(a){return{body:a.body,status:a.status,requestID:a.requestID,uuid:a.uuid}}function j(a){if(!g(a)){try{return{notAnObject:JSON.stringify(a)}}catch(a){return{notAnObject:"JSON.stringify error"}}}if(a.status===406){if(g(a.data)){delete a.data.token}return __assign(__assign({},i(a)),{data:a.data})}if(typeof a.status==="number"){return i(a)}return{name:a.name,message:a.message,stack:a.stack}}function k(){var a=d.default.get("initialUser.signs");if(!Array.isArray(a)){c.default.send("sign-fix_emptysigns");return Promise.resolve({hasBroken:false})}if(a.length===0){c.default.send("sign-fix_zerosigns");return Promise.resolve({hasBroken:false})}var b=false;var f=a.map(function(a){if(!g(a)){c.default.send("sign-fix_emptysign");return{}}a.name=h(a.name);var d=a.sign,e=a.sign_html;if(d&&!e){c.default.send("sign-fix_nohtml");return a}var f=d;try{var i=document.createElement("div");i.style.cssText="position: fixed; top: -9999px; left: -9999px;";i.setAttribute("contenteditable","true");document.body.appendChild(i);i.innerHTML=e;f=i.innerText;document.body.removeChild(i)}catch(a){b=true;c.default.send("sign-fix_reparserr",{rlog:"octavius-sign-fix-err",rlog_message:{metric:"sign-fix_parseerr",error:a}})}return __assign(__assign({},a),{sign:f})});if(f.some(function(a){var b=a.name;return!b})){c.default.send("sign-fix_noname");return Promise.resolve({hasBroken:true})}return e.default.login().then(function(a){return a.save({signs:f}).catch(function(a){c.default.send("sign-fix_save_err",{rlog:"octavius-sign-fix-err",rlog_message:{metric:"sign-fix_save_err",e:j(a)}});return{hasBroken:true}}).then(function(){return{hasBroken:b}})},function(a){c.default.send("sign-fix_userget_err",{rlog:"octavius-sign-fix-err",rlog_message:{metric:"sign-fix_userget_err",e:a}});return{hasBroken:false}})}function l(){var d=b.default.get("user-signature-fix");var e=a.default.has("user-signature-fixer-enabled");var f=d.state;if(!e||f){return}k().then(function(a){var b=a.hasBroken;d.save({state:true,time:true,hit:b}).then(function(){c.default.send("sign-fix_success")},function(a){c.default.send("sign-fix_helpersave_err",{rlog:"octavius-sign-fix-err",rlog_message:{metric:"sign-fix_helpersave_err",e:a}})})})}exports.fixSignature=l});(function a(b,c){if(typeof exports==="object"&&typeof module==="object")module.exports=c();else if(typeof define==="function"&&define.amd)define("@mail/darkosha",[],c);else if(typeof exports==="object")exports["@mail/darkosha"]=c();else b["@mail/darkosha"]=c()})(self,function(){return function(){var a={"./node_modules/@kiy/color/index.js":function(a,b,c){var d=c("./node_modules/color-string/index.js");var e=c("./node_modules/color-convert/index.js");var f=[].slice;var g=["keyword","gray","hex"];var h={};for(var i=0,j=Object.keys(e);i<j.length;i++){var k=j[i];h[f.call(e[k].labels).sort().join("")]=k}var l={};function m(a,b){if(!(this instanceof m)){return new m(a,b)}if(b&&b in g){b=null}if(b&&!(b in e)){throw new Error("Unknown model: "+b)}var c;var i;if(a==null){this.model="rgb";this.color=[0,0,0];this.valpha=1}else if(a instanceof m){this.model=a.model;this.color=a.color.slice();this.valpha=a.valpha}else if(typeof a==="string"){var j=d.get(a);if(j===null){throw new Error("Unable to parse color from string: "+a)}this.model=j.model;i=e[this.model].channels;this.color=j.value.slice(0,i);this.valpha=typeof j.value[i]==="number"?j.value[i]:1}else if(a.length>0){this.model=b||"rgb";i=e[this.model].channels;var k=f.call(a,0,i);this.color=v(k,i);this.valpha=typeof a[i]==="number"?a[i]:1}else if(typeof a==="number"){this.model="rgb";this.color=[a>>16&255,a>>8&255,a&255];this.valpha=1}else{this.valpha=1;var n=Object.keys(a);if("alpha"in a){n.splice(n.indexOf("alpha"),1);this.valpha=typeof a.alpha==="number"?a.alpha:0}var o=n.sort().join("");if(!(o in h)){throw new Error("Unable to parse color from object: "+JSON.stringify(a))}this.model=h[o];var p=e[this.model].labels;var q=[];for(c=0;c<p.length;c++){q.push(a[p[c]])}this.color=v(q)}if(l[this.model]){i=e[this.model].channels;for(c=0;c<i;c++){var r=l[this.model][c];if(r){this.color[c]=r(this.color[c])}}}this.valpha=Math.max(0,Math.min(1,this.valpha));if(Object.freeze){Object.freeze(this)}}m.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(a){var b=this.model in d.to?this:this.rgb();b=b.round(typeof a==="number"?a:1);var c=b.valpha===1?b.color:b.color.concat(this.valpha);return d.to[b.model](c)},percentString:function(a){var b=this.rgb().round(typeof a==="number"?a:1);var c=b.valpha===1?b.color:b.color.concat(this.valpha);return d.to.rgb.percent(c)},array:function(){return this.valpha===1?this.color.slice():this.color.concat(this.valpha)},object:function(){var a={};var b=e[this.model].channels;var c=e[this.model].labels;for(var d=0;d<b;d++){a[c[d]]=this.color[d]}if(this.valpha!==1){a.alpha=this.valpha}return a},unitArray:function(){var a=this.rgb().color;a[0]/=255;a[1]/=255;a[2]/=255;if(this.valpha!==1){a.push(this.valpha)}return a},unitObject:function(){var a=this.rgb().object();a.r/=255;a.g/=255;a.b/=255;if(this.valpha!==1){a.alpha=this.valpha}return a},round:function(a){a=Math.max(a||0,0);return new m(this.color.map(r(a)).concat(this.valpha),this.model)},alpha:function(a){if(arguments.length>0){return new m(this.color.concat(Math.max(0,Math.min(1,a))),this.model)}return this.valpha},red:s("rgb",0,t(255)),green:s("rgb",1,t(255)),blue:s("rgb",2,t(255)),hue:s(["hsl","hsv","hsl","hwb","hcg"],0,function(a){return(a%360+360)%360}),saturationl:s("hsl",1,t(100)),lightness:s("hsl",2,t(100)),saturationv:s("hsv",1,t(100)),value:s("hsv",2,t(100)),chroma:s("hcg",1,t(100)),gray:s("hcg",2,t(100)),white:s("hwb",1,t(100)),wblack:s("hwb",2,t(100)),cyan:s("cmyk",0,t(100)),magenta:s("cmyk",1,t(100)),yellow:s("cmyk",2,t(100)),black:s("cmyk",3,t(100)),x:s("xyz",0,t(100)),y:s("xyz",1,t(100)),z:s("xyz",2,t(100)),l:s("lab",0,t(100)),a:s("lab",1),b:s("lab",2),keyword:function(a){if(arguments.length>0){return new m(a)}return e[this.model].keyword(this.color)},hex:function(a){if(arguments.length>0){return new m(a)}return d.to.hex(this.rgb().round().color)},hexa:function(a){if(arguments.length>0){return new m(a)}var b=this.rgb().round().color;var c=Math.round(this.valpha*255).toString(16).toUpperCase();if(c.length===1){c="0"+c}return d.to.hex(b)+c},rgbNumber:function(){var a=this.rgb().color;return(a[0]&255)<<16|(a[1]&255)<<8|a[2]&255},luminosity:function(){var a=this.rgb().color;var b=[];for(var c=0;c<a.length;c++){var d=a[c];var e=d/255;b[c]=e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}return.2126*b[0]+.7152*b[1]+.0722*b[2]},contrast:function(a){var b=this.luminosity();var c=a.luminosity();if(b>c){return(b+.05)/(c+.05)}return(c+.05)/(b+.05)},level:function(a){var b=this.contrast(a);if(b>=7.1){return"AAA"}return b>=4.5?"AA":""},isDark:function(){var a=this.rgb().color;var b=(a[0]*299+a[1]*587+a[2]*114)/1e3;return b<128},isLight:function(){return!this.isDark()},negate:function(){var a=this.rgb();for(var b=0;b<3;b++){a.color[b]=255-a.color[b]}return a},lighten:function(a){var b=this.hsl();b.color[2]+=b.color[2]*a;return b},darken:function(a){var b=this.hsl();b.color[2]-=b.color[2]*a;return b},saturate:function(a){var b=this.hsl();b.color[1]+=b.color[1]*a;return b},desaturate:function(a){var b=this.hsl();b.color[1]-=b.color[1]*a;return b},whiten:function(a){var b=this.hwb();b.color[1]+=b.color[1]*a;return b},blacken:function(a){var b=this.hwb();b.color[2]+=b.color[2]*a;return b},grayscale:function(){var a=this.rgb().color;var b=a[0]*.3+a[1]*.59+a[2]*.11;return m.rgb(b,b,b)},fade:function(a){return this.alpha(this.valpha-this.valpha*a)},opaquer:function(a){return this.alpha(this.valpha+this.valpha*a)},rotate:function(a){var b=this.hsl();var c=b.color[0];c=(c+a)%360;c=c<0?360+c:c;b.color[0]=c;return b},mix:function(a,b){if(!a||!a.rgb){throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof a)}var c=a.rgb();var d=this.rgb();var e=b===undefined?.5:b;var f=2*e-1;var g=c.alpha()-d.alpha();var h=((f*g===-1?f:(f+g)/(1+f*g))+1)/2;var i=1-h;return m.rgb(h*c.red()+i*d.red(),h*c.green()+i*d.green(),h*c.blue()+i*d.blue(),c.alpha()*e+d.alpha()*(1-e))}};var n=function(a){if(g.includes(a)){return"continue"}var b=e[a].channels;m.prototype[a]=function(){if(this.model===a){return new m(this)}if(arguments.length>0){return new m(arguments,a)}var c=typeof arguments[b]==="number"?b:this.valpha;return new m(u(e[this.model][a].raw(this.color)).concat(c),a)};m[a]=function(c){if(typeof c==="number"){c=v(f.call(arguments),b)}return new m(c,a)}};for(var o=0,p=Object.keys(e);o<p.length;o++){var k=p[o];n(k)}function q(a,b){return Number(a.toFixed(b))}function r(a){return function(b){return q(b,a)}}function s(a,b,c){a=Array.isArray(a)?a:[a];for(var d=0,e=a;d<e.length;d++){var f=e[d];(l[f]||(l[f]=[]))[b]=c}a=a[0];return function(d){var e;if(arguments.length>0){if(c){d=c(d)}e=this[a]();e.color[b]=d;return e}e=this[a]().color[b];if(c){e=c(e)}return e}}function t(a){return function(b){return Math.max(0,Math.min(a,b))}}function u(a){return Array.isArray(a)?a:[a]}function v(a,b){for(var c=0;c<b;c++){if(typeof a[c]!=="number"){a[c]=0}}return a}a.exports=m},"./node_modules/color-convert/conversions.js":function(a,b,c){var d=c("./node_modules/color-name/index.js");var e={};for(var f=0,g=Object.keys(d);f<g.length;f++){var h=g[f];e[d[h]]=h}var i={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};a.exports=i;for(var j=0,k=Object.keys(i);j<k.length;j++){var l=k[j];if(!("channels"in i[l])){throw new Error("missing channels property: "+l)}if(!("labels"in i[l])){throw new Error("missing channel labels property: "+l)}if(i[l].labels.length!==i[l].channels){throw new Error("channel and label counts mismatch: "+l)}var m=i[l],n=m.channels,o=m.labels;delete i[l].channels;delete i[l].labels;Object.defineProperty(i[l],"channels",{value:n});Object.defineProperty(i[l],"labels",{value:o})}i.rgb.hsl=function(a){var b=a[0]/255;var c=a[1]/255;var d=a[2]/255;var e=Math.min(b,c,d);var f=Math.max(b,c,d);var g=f-e;var h;var i;if(f===e){h=0}else if(b===f){h=(c-d)/g}else if(c===f){h=2+(d-b)/g}else if(d===f){h=4+(b-c)/g}h=Math.min(h*60,360);if(h<0){h+=360}var j=(e+f)/2;if(f===e){i=0}else if(j<=.5){i=g/(f+e)}else{i=g/(2-f-e)}return[h,i*100,j*100]};i.rgb.hsv=function(a){var b;var c;var d;var e;var f;var g=a[0]/255;var h=a[1]/255;var i=a[2]/255;var j=Math.max(g,h,i);var k=j-Math.min(g,h,i);var l=function(a){return(j-a)/6/k+1/2};if(k===0){e=0;f=0}else{f=k/j;b=l(g);c=l(h);d=l(i);if(g===j){e=d-c}else if(h===j){e=1/3+b-d}else if(i===j){e=2/3+c-b}if(e<0){e+=1}else if(e>1){e-=1}}return[e*360,f*100,j*100]};i.rgb.hwb=function(a){var b=a[0];var c=a[1];var d=a[2];var e=i.rgb.hsl(a)[0];var f=1/255*Math.min(b,Math.min(c,d));d=1-1/255*Math.max(b,Math.max(c,d));return[e,f*100,d*100]};i.rgb.cmyk=function(a){var b=a[0]/255;var c=a[1]/255;var d=a[2]/255;var e=Math.min(1-b,1-c,1-d);var f=(1-b-e)/(1-e)||0;var g=(1-c-e)/(1-e)||0;var h=(1-d-e)/(1-e)||0;return[f*100,g*100,h*100,e*100]};function p(a,b){return Math.pow(a[0]-b[0],2)+Math.pow(a[1]-b[1],2)+Math.pow(a[2]-b[2],2)}i.rgb.keyword=function(a){var b=e[a];if(b){return b}var c=Infinity;var f;for(var g=0,h=Object.keys(d);g<h.length;g++){var i=h[g];var j=d[i];var k=p(a,j);if(k<c){c=k;f=i}}return f};i.keyword.rgb=function(a){return d[a]};i.rgb.xyz=function(a){var b=a[0]/255;var c=a[1]/255;var d=a[2]/255;b=b>.04045?Math.pow((b+.055)/1.055,2.4):b/12.92;c=c>.04045?Math.pow((c+.055)/1.055,2.4):c/12.92;d=d>.04045?Math.pow((d+.055)/1.055,2.4):d/12.92;var e=b*.4124+c*.3576+d*.1805;var f=b*.2126+c*.7152+d*.0722;var g=b*.0193+c*.1192+d*.9505;return[e*100,f*100,g*100]};i.rgb.lab=function(a){var b=i.rgb.xyz(a);var c=b[0];var d=b[1];var e=b[2];c/=95.047;d/=100;e/=108.883;c=c>.008856?Math.pow(c,1/3):7.787*c+16/116;d=d>.008856?Math.pow(d,1/3):7.787*d+16/116;e=e>.008856?Math.pow(e,1/3):7.787*e+16/116;var f=116*d-16;var g=500*(c-d);var h=200*(d-e);return[f,g,h]};i.hsl.rgb=function(a){var b=a[0]/360;var c=a[1]/100;var d=a[2]/100;var e;var f;var g;if(c===0){g=d*255;return[g,g,g]}if(d<.5){e=d*(1+c)}else{e=d+c-d*c}var h=2*d-e;var i=[0,0,0];for(var j=0;j<3;j++){f=b+1/3*-(j-1);if(f<0){f++}if(f>1){f--}if(6*f<1){g=h+(e-h)*6*f}else if(2*f<1){g=e}else if(3*f<2){g=h+(e-h)*(2/3-f)*6}else{g=h}i[j]=g*255}return i};i.hsl.hsv=function(a){var b=a[0];var c=a[1]/100;var d=a[2]/100;var e=c;var f=Math.max(d,.01);d*=2;c*=d<=1?d:2-d;e*=f<=1?f:2-f;var g=(d+c)/2;var h=d===0?2*e/(f+e):2*c/(d+c);return[b,h*100,g*100]};i.hsv.rgb=function(a){var b=a[0]/60;var c=a[1]/100;var d=a[2]/100;var e=Math.floor(b)%6;var f=b-Math.floor(b);var g=255*d*(1-c);var h=255*d*(1-c*f);var i=255*d*(1-c*(1-f));d*=255;switch(e){case 0:return[d,i,g];case 1:return[h,d,g];case 2:return[g,d,i];case 3:return[g,h,d];case 4:return[i,g,d];case 5:return[d,g,h]}};i.hsv.hsl=function(a){var b=a[0];var c=a[1]/100;var d=a[2]/100;var e=Math.max(d,.01);var f;var g;g=(2-c)*d;var h=(2-c)*e;f=c*e;f/=h<=1?h:2-h;f=f||0;g/=2;return[b,f*100,g*100]};i.hwb.rgb=function(a){var b=a[0]/360;var c=a[1]/100;var d=a[2]/100;var e=c+d;var f;if(e>1){c/=e;d/=e}var g=Math.floor(6*b);var h=1-d;f=6*b-g;if((g&1)!==0){f=1-f}var i=c+f*(h-c);var j;var k;var l;switch(g){default:case 6:case 0:j=h;k=i;l=c;break;case 1:j=i;k=h;l=c;break;case 2:j=c;k=h;l=i;break;case 3:j=c;k=i;l=h;break;case 4:j=i;k=c;l=h;break;case 5:j=h;k=c;l=i;break}return[j*255,k*255,l*255]};i.cmyk.rgb=function(a){var b=a[0]/100;var c=a[1]/100;var d=a[2]/100;var e=a[3]/100;var f=1-Math.min(1,b*(1-e)+e);var g=1-Math.min(1,c*(1-e)+e);var h=1-Math.min(1,d*(1-e)+e);return[f*255,g*255,h*255]};i.xyz.rgb=function(a){var b=a[0]/100;var c=a[1]/100;var d=a[2]/100;var e;var f;var g;e=b*3.2406+c*-1.5372+d*-.4986;f=b*-.9689+c*1.8758+d*.0415;g=b*.0557+c*-.204+d*1.057;e=e>.0031308?1.055*Math.pow(e,1/2.4)-.055:e*12.92;f=f>.0031308?1.055*Math.pow(f,1/2.4)-.055:f*12.92;g=g>.0031308?1.055*Math.pow(g,1/2.4)-.055:g*12.92;e=Math.min(Math.max(0,e),1);f=Math.min(Math.max(0,f),1);g=Math.min(Math.max(0,g),1);return[e*255,f*255,g*255]};i.xyz.lab=function(a){var b=a[0];var c=a[1];var d=a[2];b/=95.047;c/=100;d/=108.883;b=b>.008856?Math.pow(b,1/3):7.787*b+16/116;c=c>.008856?Math.pow(c,1/3):7.787*c+16/116;d=d>.008856?Math.pow(d,1/3):7.787*d+16/116;var e=116*c-16;var f=500*(b-c);var g=200*(c-d);return[e,f,g]};i.lab.xyz=function(a){var b=a[0];var c=a[1];var d=a[2];var e;var f;var g;f=(b+16)/116;e=c/500+f;g=f-d/200;var h=Math.pow(f,3);var i=Math.pow(e,3);var j=Math.pow(g,3);f=h>.008856?h:(f-16/116)/7.787;e=i>.008856?i:(e-16/116)/7.787;g=j>.008856?j:(g-16/116)/7.787;e*=95.047;f*=100;g*=108.883;return[e,f,g]};i.lab.lch=function(a){var b=a[0];var c=a[1];var d=a[2];var e;var f=Math.atan2(d,c);e=f*360/2/Math.PI;if(e<0){e+=360}var g=Math.sqrt(c*c+d*d);return[b,g,e]};i.lch.lab=function(a){var b=a[0];var c=a[1];var d=a[2];var e=d/360*2*Math.PI;var f=c*Math.cos(e);var g=c*Math.sin(e);return[b,f,g]};i.rgb.ansi16=function(a,b){if(b===void 0){b=null}var c=a[0],d=a[1],e=a[2];var f=b===null?i.rgb.hsv(a)[2]:b;f=Math.round(f/50);if(f===0){return 30}var g=30+(Math.round(e/255)<<2|Math.round(d/255)<<1|Math.round(c/255));if(f===2){g+=60}return g};i.hsv.ansi16=function(a){return i.rgb.ansi16(i.hsv.rgb(a),a[2])};i.rgb.ansi256=function(a){var b=a[0];var c=a[1];var d=a[2];if(b===c&&c===d){if(b<8){return 16}if(b>248){return 231}return Math.round((b-8)/247*24)+232}var e=16+36*Math.round(b/255*5)+6*Math.round(c/255*5)+Math.round(d/255*5);return e};i.ansi16.rgb=function(a){var b=a%10;if(b===0||b===7){if(a>50){b+=3.5}b=b/10.5*255;return[b,b,b]}var c=(~~(a>50)+1)*.5;var d=(b&1)*c*255;var e=(b>>1&1)*c*255;var f=(b>>2&1)*c*255;return[d,e,f]};i.ansi256.rgb=function(a){if(a>=232){var b=(a-232)*10+8;return[b,b,b]}a-=16;var c;var d=Math.floor(a/36)/5*255;var e=Math.floor((c=a%36)/6)/5*255;var f=c%6/5*255;return[d,e,f]};i.rgb.hex=function(a){var b=((Math.round(a[0])&255)<<16)+((Math.round(a[1])&255)<<8)+(Math.round(a[2])&255);var c=b.toString(16).toUpperCase();return"000000".substring(c.length)+c};i.hex.rgb=function(a){var b=a.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!b){return[0,0,0]}var c=b[0];if(b[0].length===3){c=c.split("").map(function(a){return a+a}).join("")}var d=parseInt(c,16);var e=d>>16&255;var f=d>>8&255;var g=d&255;return[e,f,g]};i.rgb.hcg=function(a){var b=a[0]/255;var c=a[1]/255;var d=a[2]/255;var e=Math.max(Math.max(b,c),d);var f=Math.min(Math.min(b,c),d);var g=e-f;var h;var i;if(g<1){h=f/(1-g)}else{h=0}if(g<=0){i=0}else if(e===b){i=(c-d)/g%6}else if(e===c){i=2+(d-b)/g}else{i=4+(b-c)/g}i/=6;i%=1;return[i*360,g*100,h*100]};i.hsl.hcg=function(a){var b=a[1]/100;var c=a[2]/100;var d=c<.5?2*b*c:2*b*(1-c);var e=0;if(d<1){e=(c-.5*d)/(1-d)}return[a[0],d*100,e*100]};i.hsv.hcg=function(a){var b=a[1]/100;var c=a[2]/100;var d=b*c;var e=0;if(d<1){e=(c-d)/(1-d)}return[a[0],d*100,e*100]};i.hcg.rgb=function(a){var b=a[0]/360;var c=a[1]/100;var d=a[2]/100;if(c===0){return[d*255,d*255,d*255]}var e=[0,0,0];var f=b%1*6;var g=f%1;var h=1-g;var i=0;switch(Math.floor(f)){case 0:e[0]=1;e[1]=g;e[2]=0;break;case 1:e[0]=h;e[1]=1;e[2]=0;break;case 2:e[0]=0;e[1]=1;e[2]=g;break;case 3:e[0]=0;e[1]=h;e[2]=1;break;case 4:e[0]=g;e[1]=0;e[2]=1;break;default:e[0]=1;e[1]=0;e[2]=h}i=(1-c)*d;return[(c*e[0]+i)*255,(c*e[1]+i)*255,(c*e[2]+i)*255]};i.hcg.hsv=function(a){var b=a[1]/100;var c=a[2]/100;var d=b+c*(1-b);var e=0;if(d>0){e=b/d}return[a[0],e*100,d*100]};i.hcg.hsl=function(a){var b=a[1]/100;var c=a[2]/100;var d=c*(1-b)+.5*b;var e=0;if(d>0&&d<.5){e=b/(2*d)}else if(d>=.5&&d<1){e=b/(2*(1-d))}return[a[0],e*100,d*100]};i.hcg.hwb=function(a){var b=a[1]/100;var c=a[2]/100;var d=b+c*(1-b);return[a[0],(d-b)*100,(1-d)*100]};i.hwb.hcg=function(a){var b=a[1]/100;var c=a[2]/100;var d=1-c;var e=d-b;var f=0;if(e<1){f=(d-e)/(1-e)}return[a[0],e*100,f*100]};i.apple.rgb=function(a){return[a[0]/65535*255,a[1]/65535*255,a[2]/65535*255]};i.rgb.apple=function(a){return[a[0]/255*65535,a[1]/255*65535,a[2]/255*65535]};i.gray.rgb=function(a){return[a[0]/100*255,a[0]/100*255,a[0]/100*255]};i.gray.hsl=function(a){return[0,0,a[0]]};i.gray.hsv=i.gray.hsl;i.gray.hwb=function(a){return[0,100,a[0]]};i.gray.cmyk=function(a){return[0,0,0,a[0]]};i.gray.lab=function(a){return[a[0],0,0]};i.gray.hex=function(a){var b=Math.round(a[0]/100*255)&255;var c=(b<<16)+(b<<8)+b;var d=c.toString(16).toUpperCase();return"000000".substring(d.length)+d};i.rgb.gray=function(a){var b=(a[0]+a[1]+a[2])/3;return[b/255*100]}},"./node_modules/color-convert/index.js":function(a,b,c){var d=c("./node_modules/color-convert/conversions.js");var e=c("./node_modules/color-convert/route.js");var f={};var g=Object.keys(d);function h(a){var b=function(){var b=[];for(var c=0;c<arguments.length;c++){b[c]=arguments[c]}var d=b[0];if(d===undefined||d===null){return d}if(d.length>1){b=d}return a(b)};if("conversion"in a){b.conversion=a.conversion}return b}function i(a){var b=function(){var b=[];for(var c=0;c<arguments.length;c++){b[c]=arguments[c]}var d=b[0];if(d===undefined||d===null){return d}if(d.length>1){b=d}var e=a(b);if(typeof e==="object"){for(var f=e.length,g=0;g<f;g++){e[g]=Math.round(e[g])}}return e};if("conversion"in a){b.conversion=a.conversion}return b}g.forEach(function(a){f[a]={};Object.defineProperty(f[a],"channels",{value:d[a].channels});Object.defineProperty(f[a],"labels",{value:d[a].labels});var b=e(a);var c=Object.keys(b);c.forEach(function(c){var d=b[c];f[a][c]=i(d);f[a][c].raw=h(d)})});a.exports=f},"./node_modules/color-convert/route.js":function(a,b,c){var d=c("./node_modules/color-convert/conversions.js");function e(){var a={};var b=Object.keys(d);for(var c=b.length,e=0;e<c;e++){a[b[e]]={distance:-1,parent:null}}return a}function f(a){var b=e();var c=[a];b[a].distance=0;while(c.length){var f=c.pop();var g=Object.keys(d[f]);for(var h=g.length,i=0;i<h;i++){var j=g[i];var k=b[j];if(k.distance===-1){k.distance=b[f].distance+1;k.parent=f;c.unshift(j)}}}return b}function g(a,b){return function(c){return b(a(c))}}function h(a,b){var c=[b[a].parent,a];var e=d[b[a].parent][a];var f=b[a].parent;while(b[f].parent){c.unshift(b[f].parent);e=g(d[b[f].parent][f],e);f=b[f].parent}e.conversion=c;return e}a.exports=function(a){var b=f(a);var c={};var d=Object.keys(b);for(var e=d.length,g=0;g<e;g++){var i=d[g];var j=b[i];if(j.parent===null){continue}c[i]=h(i,b)}return c}},"./node_modules/color-name/index.js":function(a){"use strict";a.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},"./node_modules/color-string/index.js":function(a,b,c){var d=c("./node_modules/color-name/index.js");var e=c("./node_modules/simple-swizzle/index.js");var f=Object.hasOwnProperty;var g={};for(var h in d){if(f.call(d,h)){g[d[h]]=h}}var i=a.exports={to:{},get:{}};i.get=function(a){var b=a.substring(0,3).toLowerCase();var c;var d;switch(b){case"hsl":c=i.get.hsl(a);d="hsl";break;case"hwb":c=i.get.hwb(a);d="hwb";break;default:c=i.get.rgb(a);d="rgb";break}if(!c){return null}return{model:d,value:c}};i.get.rgb=function(a){if(!a){return null}var b=/^#([a-f0-9]{3,4})$/i;var c=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i;var e=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/;var g=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/;var h=/^(\w+)$/;var i=[0,0,0,1];var k;var l;var m;if(k=a.match(c)){m=k[2];k=k[1];for(l=0;l<3;l++){var n=l*2;i[l]=parseInt(k.slice(n,n+2),16)}if(m){i[3]=parseInt(m,16)/255}}else if(k=a.match(b)){k=k[1];m=k[3];for(l=0;l<3;l++){i[l]=parseInt(k[l]+k[l],16)}if(m){i[3]=parseInt(m+m,16)/255}}else if(k=a.match(e)){for(l=0;l<3;l++){i[l]=parseInt(k[l+1],0)}if(k[4]){if(k[5]){i[3]=parseFloat(k[4])*.01}else{i[3]=parseFloat(k[4])}}}else if(k=a.match(g)){for(l=0;l<3;l++){i[l]=Math.round(parseFloat(k[l+1])*2.55)}if(k[4]){if(k[5]){i[3]=parseFloat(k[4])*.01}else{i[3]=parseFloat(k[4])}}}else if(k=a.match(h)){if(k[1]==="transparent"){return[0,0,0,0]}if(!f.call(d,k[1])){return null}i=d[k[1]];i[3]=1;return i}else{return null}for(l=0;l<3;l++){i[l]=j(i[l],0,255)}i[3]=j(i[3],0,1);return i};i.get.hsl=function(a){if(!a){return null}var b=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/;var c=a.match(b);if(c){var d=parseFloat(c[4]);var e=(parseFloat(c[1])%360+360)%360;var f=j(parseFloat(c[2]),0,100);var g=j(parseFloat(c[3]),0,100);var h=j(isNaN(d)?1:d,0,1);return[e,f,g,h]}return null};i.get.hwb=function(a){if(!a){return null}var b=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/;var c=a.match(b);if(c){var d=parseFloat(c[4]);var e=(parseFloat(c[1])%360+360)%360;var f=j(parseFloat(c[2]),0,100);var g=j(parseFloat(c[3]),0,100);var h=j(isNaN(d)?1:d,0,1);return[e,f,g,h]}return null};i.to.hex=function(){var a=e(arguments);return"#"+k(a[0])+k(a[1])+k(a[2])+(a[3]<1?k(Math.round(a[3]*255)):"")};i.to.rgb=function(){var a=e(arguments);return a.length<4||a[3]===1?"rgb("+Math.round(a[0])+", "+Math.round(a[1])+", "+Math.round(a[2])+")":"rgba("+Math.round(a[0])+", "+Math.round(a[1])+", "+Math.round(a[2])+", "+a[3]+")"};i.to.rgb.percent=function(){var a=e(arguments);var b=Math.round(a[0]/255*100);var c=Math.round(a[1]/255*100);var d=Math.round(a[2]/255*100);return a.length<4||a[3]===1?"rgb("+b+"%, "+c+"%, "+d+"%)":"rgba("+b+"%, "+c+"%, "+d+"%, "+a[3]+")"};i.to.hsl=function(){var a=e(arguments);return a.length<4||a[3]===1?"hsl("+a[0]+", "+a[1]+"%, "+a[2]+"%)":"hsla("+a[0]+", "+a[1]+"%, "+a[2]+"%, "+a[3]+")"};i.to.hwb=function(){var a=e(arguments);var b="";if(a.length>=4&&a[3]!==1){b=", "+a[3]}return"hwb("+a[0]+", "+a[1]+"%, "+a[2]+"%"+b+")"};i.to.keyword=function(a){return g[a.slice(0,3)]};function j(a,b,c){return Math.min(Math.max(b,a),c)}function k(a){var b=Math.round(a).toString(16).toUpperCase();return b.length<2?"0"+b:b}},"./node_modules/micro-events/index.js":function(a){function b(a,b,c){for(var d=0;d<a.length;d++){b.call(c,a[d])}}function c(a,b){var c=a.indexOf(b);if(c!==-1){a.splice(c,1)}}function d(a,b){return a.indexOf(b)!==-1}function e(){this.listeners={}}e.prototype.maxListeners=10;function f(a){if(typeof a!=="string"){throw"eventName is not a string"}}function g(a){if(typeof a!=="function"){throw"listener is not a function"}}e.prototype.on=function(a,b){f(a);g(b);this.listeners[a]=this.listeners[a]||[];if(this.listeners[a].length>this.maxListeners){throw"Exceeded maxListeners - You might have a memory leak"}if(!d(this.listeners[a],b)){this.listeners[a].push(b);this.emit("on",{eventName:a,listener:b})}return this};e.prototype.emit=function(a,c){f(a);var d=Array.prototype.slice.call(arguments,1);b(this.listeners[a]||[],function(a){a.apply(this,d)},this);return this};e.prototype.off=function(a,b){f(a);g(b);c(this.listeners[a]||[],b);this.emit("off",{eventName:a,listener:b});return this};e.prototype.clearListeners=function(a){f(a);this.listeners[a]=null;return this};a.exports=e},"./node_modules/postcss-media-query-parser/dist/index.js":function(a,exports,b){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=g;var c=b("./node_modules/postcss-media-query-parser/dist/nodes/Container.js");var d=f(c);var e=b("./node_modules/postcss-media-query-parser/dist/parsers.js");function f(a){return a&&a.__esModule?a:{default:a}}function g(a){return new d.default({nodes:(0,e.parseMediaList)(a),type:"media-query-list",value:a.trim()})}},"./node_modules/postcss-media-query-parser/dist/nodes/Container.js":function(a,exports,b){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var c=b("./node_modules/postcss-media-query-parser/dist/nodes/Node.js");var d=e(c);function e(a){return a&&a.__esModule?a:{default:a}}function f(a){var b=this;this.constructor(a);this.nodes=a.nodes;if(this.after===undefined){this.after=this.nodes.length>0?this.nodes[this.nodes.length-1].after:""}if(this.before===undefined){this.before=this.nodes.length>0?this.nodes[0].before:""}if(this.sourceIndex===undefined){this.sourceIndex=this.before.length}this.nodes.forEach(function(a){a.parent=b})}f.prototype=Object.create(d.default.prototype);f.constructor=d.default;f.prototype.walk=function a(b,c){var d=typeof b==="string"||b instanceof RegExp;var e=d?c:b;var f=typeof b==="string"?new RegExp(b):b;for(var g=0;g<this.nodes.length;g++){var h=this.nodes[g];var i=d?f.test(h.type):true;if(i&&e&&e(h,g,this.nodes)===false){return false}if(h.nodes&&h.walk(b,c)===false){return false}}return true};f.prototype.each=function a(){var b=arguments.length<=0||arguments[0]===undefined?function(){}:arguments[0];for(var c=0;c<this.nodes.length;c++){var d=this.nodes[c];if(b(d,c,this.nodes)===false){return false}}return true};exports["default"]=f},"./node_modules/postcss-media-query-parser/dist/nodes/Node.js":function(a,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function b(a){this.after=a.after;this.before=a.before;this.type=a.type;this.value=a.value;this.sourceIndex=a.sourceIndex}exports["default"]=b},"./node_modules/postcss-media-query-parser/dist/parsers.js":function(a,exports,b){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.parseMediaFeature=h;exports.parseMediaQuery=i;exports.parseMediaList=j;var c=b("./node_modules/postcss-media-query-parser/dist/nodes/Node.js");var d=g(c);var e=b("./node_modules/postcss-media-query-parser/dist/nodes/Container.js");var f=g(e);function g(a){return a&&a.__esModule?a:{default:a}}function h(a){var b=arguments.length<=1||arguments[1]===undefined?0:arguments[1];var c=[{mode:"normal",character:null}];var d=[];var e=0;var f="";var g=null;var h=null;var i=b;var j=a;if(a[0]==="("&&a[a.length-1]===")"){j=a.substring(1,a.length-1);i++}for(var k=0;k<j.length;k++){var l=j[k];if(l==="'"||l==='"'){if(c[e].isCalculationEnabled===true){c.push({mode:"string",isCalculationEnabled:false,character:l});e++}else if(c[e].mode==="string"&&c[e].character===l&&j[k-1]!=="\\"){c.pop();e--}}if(l==="{"){c.push({mode:"interpolation",isCalculationEnabled:true});e++}else if(l==="}"){c.pop();e--}if(c[e].mode==="normal"&&l===":"){var m=j.substring(k+1);h={type:"value",before:/^(\s*)/.exec(m)[1],after:/(\s*)$/.exec(m)[1],value:m.trim()};h.sourceIndex=h.before.length+k+1+i;g={type:"colon",sourceIndex:k+i,after:h.before,value:":"};break}f+=l}f={type:"media-feature",before:/^(\s*)/.exec(f)[1],after:/(\s*)$/.exec(f)[1],value:f.trim()};f.sourceIndex=f.before.length+i;d.push(f);if(g!==null){g.before=f.after;d.push(g)}if(h!==null){d.push(h)}return d}function i(a){var b=arguments.length<=1||arguments[1]===undefined?0:arguments[1];var c=[];var e=0;var g=false;var i=void 0;function j(){return{before:"",after:"",value:""}}i=j();for(var k=0;k<a.length;k++){var l=a[k];if(!g){if(l.search(/\s/)!==-1){i.before+=l}else{if(l==="("){i.type="media-feature-expression";e++}i.value=l;i.sourceIndex=b+k;g=true}}else{i.value+=l;if(l==="{"||l==="("){e++}if(l===")"||l==="}"){e--}}if(g&&e===0&&(l===")"||k===a.length-1||a[k+1].search(/\s/)!==-1)){if(["not","only","and"].indexOf(i.value)!==-1){i.type="keyword"}if(i.type==="media-feature-expression"){i.nodes=h(i.value,i.sourceIndex)}c.push(Array.isArray(i.nodes)?new f.default(i):new d.default(i));i=j();g=false}}for(var m=0;m<c.length;m++){i=c[m];if(m>0){c[m-1].after=i.before}if(i.type===undefined){if(m>0){if(c[m-1].type==="media-feature-expression"){i.type="keyword";continue}if(c[m-1].value==="not"||c[m-1].value==="only"){i.type="media-type";continue}if(c[m-1].value==="and"){i.type="media-feature-expression";continue}if(c[m-1].type==="media-type"){if(!c[m+1]){i.type="media-feature-expression"}else{i.type=c[m+1].type==="media-feature-expression"?"keyword":"media-feature-expression"}}}if(m===0){if(!c[m+1]){i.type="media-type";continue}if(c[m+1]&&(c[m+1].type==="media-feature-expression"||c[m+1].type==="keyword")){i.type="media-type";continue}if(c[m+2]){if(c[m+2].type==="media-feature-expression"){i.type="media-type";c[m+1].type="keyword";continue}if(c[m+2].type==="keyword"){i.type="keyword";c[m+1].type="media-type";continue}}if(c[m+3]){if(c[m+3].type==="media-feature-expression"){i.type="keyword";c[m+1].type="media-type";c[m+2].type="keyword";continue}}}}}return c}function j(a){var b=[];var c=0;var e=0;var g=/^(\s*)url\s*\(/.exec(a);if(g!==null){var h=g[0].length;var j=1;while(j>0){var k=a[h];if(k==="("){j++}if(k===")"){j--}h++}b.unshift(new d.default({type:"url",value:a.substring(0,h).trim(),sourceIndex:g[1].length,before:g[1],after:/^(\s*)/.exec(a.substring(h))[1]}));c=h}for(var l=c;l<a.length;l++){var m=a[l];if(m==="("){e++}if(m===")"){e--}if(e===0&&m===","){var n=a.substring(c,l);var o=/^(\s*)/.exec(n)[1];b.push(new f.default({type:"media-query",value:n.trim(),sourceIndex:c+o.length,nodes:i(n,c),before:o,after:/(\s*)$/.exec(n)[1]}));c=l+1}}var p=a.substring(c);var q=/^(\s*)/.exec(p)[1];b.push(new f.default({type:"media-query",value:p.trim(),sourceIndex:c+q.length,nodes:i(p,c),before:q,after:/(\s*)$/.exec(p)[1]}));return b}},"./node_modules/simple-swizzle/index.js":function(a,b,c){"use strict";var d=c("./node_modules/simple-swizzle/node_modules/is-arrayish/index.js");var e=Array.prototype.concat;var f=Array.prototype.slice;var g=a.exports=function a(b){var c=[];for(var g=0,h=b.length;g<h;g++){var i=b[g];if(d(i)){c=e.call(c,f.call(i))}else{c.push(i)}}return c};g.wrap=function(a){return function(){return a(g(arguments))}}},"./node_modules/simple-swizzle/node_modules/is-arrayish/index.js":function(a){a.exports=function a(b){if(!b||typeof b==="string"){return false}return b instanceof Array||Array.isArray(b)||b.length>=0&&(b.splice instanceof Function||Object.getOwnPropertyDescriptor(b,b.length-1)&&b.constructor.name!=="String")}}};var b={};function c(d){var e=b[d];if(e!==undefined){return e.exports}var f=b[d]={exports:{}};a[d](f,f.exports,c);return f.exports}!function(){c.n=function(a){var b=a&&a.__esModule?function(){return a["default"]}:function(){return a};c.d(b,{a:b});return b}}();!function(){c.d=function(exports,a){for(var b in a){if(c.o(a,b)&&!c.o(exports,b)){Object.defineProperty(exports,b,{enumerable:true,get:a[b]})}}}}();!function(){c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)}}();!function(){c.r=function(exports){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(exports,"__esModule",{value:true})}}();var d={};!function(){"use strict";c.r(d);c.d(d,{Analytics:function(){return H},AnalyticsEvent:function(){return E},SyncPromise:function(){return L},TransformerMode:function(){return T},TransformerStatus:function(){return U},createDarkosha:function(){return Oa}});var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)if(Object.prototype.hasOwnProperty.call(b,c))a[c]=b[c]};return a(b,c)};function b(b,c){if(typeof c!=="function"&&c!==null)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");a(b,c);function d(){this.constructor=b}b.prototype=c===null?Object.create(c):(d.prototype=c.prototype,new d)}var e=function(){e=Object.assign||function a(b){for(var c,d=1,e=arguments.length;d<e;d++){c=arguments[d];for(var f in c)if(Object.prototype.hasOwnProperty.call(c,f))b[f]=c[f]}return b};return e.apply(this,arguments)};function f(a,b){var c={};for(var d in a)if(Object.prototype.hasOwnProperty.call(a,d)&&b.indexOf(d)<0)c[d]=a[d];if(a!=null&&typeof Object.getOwnPropertySymbols==="function")for(var e=0,d=Object.getOwnPropertySymbols(a);e<d.length;e++){if(b.indexOf(d[e])<0&&Object.prototype.propertyIsEnumerable.call(a,d[e]))c[d[e]]=a[d[e]]}return c}function g(a,b,c,d){var e=arguments.length,f=e<3?b:d===null?d=Object.getOwnPropertyDescriptor(b,c):d,g;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")f=Reflect.decorate(a,b,c,d);else for(var h=a.length-1;h>=0;h--)if(g=a[h])f=(e<3?g(f):e>3?g(b,c,f):g(b,c))||f;return e>3&&f&&Object.defineProperty(b,c,f),f}function h(a,b){return function(c,d){b(c,d,a)}}function i(a,b){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(a,b)}function j(a,b,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new(c||(c=Promise))(function(c,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d["throw"](a))}catch(a){f(a)}}function i(a){a.done?c(a.value):e(a.value).then(g,h)}i((d=d.apply(a,b||[])).next())})}function k(a,b){var c={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},d,e,f,g;return g={next:h(0),throw:h(1),return:h(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function h(a){return function(b){return i([a,b])}}function i(g){if(d)throw new TypeError("Generator is already executing.");while(c)try{if(d=1,e&&(f=g[0]&2?e["return"]:g[0]?e["throw"]||((f=e["return"])&&f.call(e),0):e.next)&&!(f=f.call(e,g[1])).done)return f;if(e=0,f)g=[g[0]&2,f.value];switch(g[0]){case 0:case 1:f=g;break;case 4:c.label++;return{value:g[1],done:false};case 5:c.label++;e=g[1];g=[0];continue;case 7:g=c.ops.pop();c.trys.pop();continue;default:if(!(f=c.trys,f=f.length>0&&f[f.length-1])&&(g[0]===6||g[0]===2)){c=0;continue}if(g[0]===3&&(!f||g[1]>f[0]&&g[1]<f[3])){c.label=g[1];break}if(g[0]===6&&c.label<f[1]){c.label=f[1];f=g;break}if(f&&c.label<f[2]){c.label=f[2];c.ops.push(g);break}if(f[2])c.ops.pop();c.trys.pop();continue}g=b.call(a,c)}catch(a){g=[6,a];e=0}finally{d=f=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:true}}}var l=Object.create?function(a,b,c,d){if(d===undefined)d=c;Object.defineProperty(a,d,{enumerable:true,get:function(){return b[c]}})}:function(a,b,c,d){if(d===undefined)d=c;a[d]=b[c]};function m(a,b){for(var c in a)if(c!=="default"&&!Object.prototype.hasOwnProperty.call(b,c))l(b,a,c)}function n(a){var b=typeof Symbol==="function"&&Symbol.iterator,c=b&&a[b],d=0;if(c)return c.call(a);if(a&&typeof a.length==="number")return{next:function(){if(a&&d>=a.length)a=void 0;return{value:a&&a[d++],done:!a}}};throw new TypeError(b?"Object is not iterable.":"Symbol.iterator is not defined.")}function o(a,b){var c=typeof Symbol==="function"&&a[Symbol.iterator];if(!c)return a;var d=c.call(a),e,f=[],g;try{while((b===void 0||b-- >0)&&!(e=d.next()).done)f.push(e.value)}catch(a){g={error:a}}finally{try{if(e&&!e.done&&(c=d["return"]))c.call(d)}finally{if(g)throw g.error}}return f}function p(){for(var a=[],b=0;b<arguments.length;b++)a=a.concat(o(arguments[b]));return a}function q(){for(var a=0,b=0,c=arguments.length;b<c;b++)a+=arguments[b].length;for(var d=Array(a),e=0,b=0;b<c;b++)for(var f=arguments[b],g=0,h=f.length;g<h;g++,e++)d[e]=f[g];return d}function r(a,b,c){if(c||arguments.length===2)for(var d=0,e=b.length,f;d<e;d++){if(f||!(d in b)){if(!f)f=Array.prototype.slice.call(b,0,d);f[d]=b[d]}}return a.concat(f||Array.prototype.slice.call(b))}function s(a){return this instanceof s?(this.v=a,this):new s(a)}function t(a,b,c){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var d=c.apply(a,b||[]),e,f=[];return e={},g("next"),g("throw"),g("return"),e[Symbol.asyncIterator]=function(){return this},e;function g(a){if(d[a])e[a]=function(b){return new Promise(function(c,d){f.push([a,b,c,d])>1||h(a,b)})}}function h(a,b){try{i(d[a](b))}catch(a){l(f[0][3],a)}}function i(a){a.value instanceof s?Promise.resolve(a.value.v).then(j,k):l(f[0][2],a)}function j(a){h("next",a)}function k(a){h("throw",a)}function l(a,b){if(a(b),f.shift(),f.length)h(f[0][0],f[0][1])}}function u(a){var b,c;return b={},d("next"),d("throw",function(a){throw a}),d("return"),b[Symbol.iterator]=function(){return this},b;function d(d,e){b[d]=a[d]?function(b){return(c=!c)?{value:s(a[d](b)),done:d==="return"}:e?e(b):b}:e}}function v(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var b=a[Symbol.asyncIterator],c;return b?b.call(a):(a=typeof n==="function"?n(a):a[Symbol.iterator](),c={},d("next"),d("throw"),d("return"),c[Symbol.asyncIterator]=function(){return this},c);function d(b){c[b]=a[b]&&function(c){return new Promise(function(d,f){c=a[b](c),e(d,f,c.done,c.value)})}}function e(a,b,c,d){Promise.resolve(d).then(function(b){a({value:b,done:c})},b)}}function w(a,b){if(Object.defineProperty){Object.defineProperty(a,"raw",{value:b})}else{a.raw=b}return a}var x=Object.create?function(a,b){Object.defineProperty(a,"default",{enumerable:true,value:b})}:function(a,b){a["default"]=b};function y(a){if(a&&a.__esModule)return a;var b={};if(a!=null)for(var c in a)if(c!=="default"&&Object.prototype.hasOwnProperty.call(a,c))l(b,a,c);x(b,a);return b}function z(a){return a&&a.__esModule?a:{default:a}}function A(a,b,c,d){if(c==="a"&&!d)throw new TypeError("Private accessor was defined without a getter");if(typeof b==="function"?a!==b||!d:!b.has(a))throw new TypeError("Cannot read private member from an object whose class did not declare it");return c==="m"?d:c==="a"?d.call(a):d?d.value:b.get(a)}function B(a,b,c,d,e){if(d==="m")throw new TypeError("Private method is not writable");if(d==="a"&&!e)throw new TypeError("Private accessor was defined without a setter");if(typeof b==="function"?a!==b||!e:!b.has(a))throw new TypeError("Cannot write private member to an object whose class did not declare it");return d==="a"?e.call(a,c):e?e.value=c:b.set(a,c),c}var C=c("./node_modules/micro-events/index.js");var D=c.n(C);var E;(function(a){a["All"]="*";a["Start"]="start";a["Success"]="success";a["Fail"]="fail";a["StartTransform"]="start:transform";a["SuccessTransform"]="success:transform";a["FailTransform"]="fail:transform";a["DisabledTransform"]="disabled:transform";a["DetectMediaQuery"]="detect:media-query";a["SuccessClipboard"]="success:clipboard";a["FailClipboard"]="fail:clipboard"})(E||(E={}));var F;(function(a){a["execCommand"]="execCommand";a["customRange"]="customRange"})(F||(F={}));var G=function(){function a(){}a.prototype.create=function(a,b){return{type:a,data:e({ts:performance.now()},b)}};a.prototype.mark=function(a){var b;var c=(b=window.performance)===null||b===void 0?void 0:b.now();return function(){var b;var d=(b=window.performance)===null||b===void 0?void 0:b.now();var e=Math.round(d-c);a(e)}};return a}();var H=function(){function a(){this._emitter=new(D());this._events=new G}a.prototype.emit=function(a,b){var c=this._events.create(a,b);this._emitter.emit("*",c);this._emitter.emit(a,c)};a.prototype.mark=function(a){return this._events.mark(a)};a.prototype.on=function(a,b){this._emitter.on(a,b)};a.prototype.off=function(a,b){this._emitter.off(a,b)};return a}();var I;function J(a){return typeof a==="function"}function K(a){if(a&&(typeof a==="object"||typeof a==="function")){var b=a.then;if(typeof b==="function"){return b}}}var L=function(){function a(a,b){var c=this;if(b===void 0){b=false}this._promiseValue=undefined;this._promiseError=undefined;this._status=0;this._onSettle=[];this._async=false;this[I]="[SyncPromise]";this._async=b;var d=function(){var a=c._onSettle;c._onSettle=[];if(c._async){setTimeout(function(){for(var b=0,c=a;b<c.length;b++){var d=c[b];d()}},1)}else{for(var b=0,d=a;b<d.length;b++){var e=d[b];e()}}};var e=function(a){if(c._status!==0){return}if(a===c){f(new TypeError("Promise cannot be resolved with itself"))}var b=false;try{var g=K(a);if(g){g.call(a,function(a){if(!b){b=true;e(a)}},function(a){if(!b){b=true;f(a)}})}else{c._promiseValue=a;c._status=1;d()}}catch(a){if(!b){f(a)}}};var f=function(a){if(c._status!==0){return}if(a===c){f(new TypeError("Promise cannot be resolved with itself"))}c._promiseError=a;c._status=2;d()};try{a(e,f)}catch(a){f(a)}}a.prototype.then=function(b,c){var d=this;return new a(function(a,e){var f=function(){try{if(d._status===1){a(J(b)?b(d._promiseValue):d._promiseValue)}else if(J(c)){a(c(d._promiseError))}else{e(d._promiseError)}}catch(a){e(a)}};if(d._status===0){d._onSettle.push(f)}else if(d._async){setTimeout(f,1)}else{f()}},this._async)};a.prototype.catch=function(a){return this.then(function(a){return a},a)};a.prototype.finally=function(a){return this.then(function(){return a()},function(){return a()})};Object.defineProperty(a,(I=Symbol.toStringTag,Symbol.species),{get:function(){return a},enumerable:false,configurable:true});a.all=function(a){return Promise.all(a)};a.allSettled=function(a){return Promise.allSettled(a)};a.race=function(a){return Promise.race(a)};a.resolve=function(b){return new a(function(a){a(b)})};a.reject=function(b){return new a(function(a,c){c(b)})};a.unwrap=function(a){return new Promise(function(b,c){a.then(b,c)})};return a}();function M(a){return a&&typeof a==="object"&&typeof a["then"]==="function"}function N(a,b,c){if(c===void 0){c=undefined}return new L(function(d,e){var f=false;var g=c;var h=0;var i=function(){if(h>=a.length){return L.resolve()}var c=b(a[h],function(a){f=true;g=a});if(!M(c)){c=L.resolve()}return c.then(function(){h++;if(!f&&h<a.length){return i()}})};return i().then(function(){return d(g)}).catch(function(a){return e(a)})})}var O=[{property:"name",enumerable:false},{property:"message",enumerable:false},{property:"stack",enumerable:false},{property:"code",enumerable:true}];var P=Symbol(".toJSON called");var Q=function(a){a[P]=true;var b=a.toJSON();delete a[P];return b};var R=function(a){var b=a.from,c=a.seen,d=a.to_,e=a.forceEnumerable,f=a.maxDepth,g=a.depth;var h=d||(Array.isArray(b)?[]:{});c.push(b);if(g>=f){return h}if(typeof b.toJSON==="function"&&b[P]!==true){return Q(b)}for(var i=0,j=Object.entries(b);i<j.length;i++){var k=j[i],l=k[0],m=k[1];if(typeof Buffer==="function"&&Buffer.isBuffer(m)){h[l]="[object Buffer]";continue}if(typeof m==="function"){continue}if(!m||typeof m!=="object"){h[l]=m;continue}if(!c.includes(b[l])){g++;h[l]=R({from:b[l],seen:c.slice(),forceEnumerable:e,maxDepth:f,depth:g});continue}h[l]="[Circular]"}for(var n=0,o=O;n<o.length;n++){var p=o[n],q=p.property,r=p.enumerable;if(typeof b[q]==="string"){Object.defineProperty(h,q,{value:b[q],enumerable:e?true:r,configurable:true,writable:true})}}return h};var S=function(a){var b=Number.POSITIVE_INFINITY;if(typeof a==="object"&&a!==null){return R({from:a,seen:[],forceEnumerable:true,maxDepth:b,depth:0})}if(typeof a==="function"){return"[Function: ".concat(a.name||"anonymous","]")}return a};var T;(function(a){a["ToLight"]="to_light";a["ToDark"]="to_dark"})(T||(T={}));var U;(function(a){a["Transformed"]="transformed";a["Rejected"]="rejected";a["Disabled"]="disabled";a["Skipped"]="skipped";a["Intact"]="intact"})(U||(U={}));var V="data-darkosha-skip";var W="data-darkosha-id";function X(a){while(a){if(a.hasAttribute(W)){return a}a=a.parentElement}}var Y=function(){function a(a,b){var c=this;this.id=a;this.factory=b;this._attributes={};this._firstRun=true;this._nodeFilter={acceptNode:function(a){var b=a;if(!c.shouldTransformNode(a)){return NodeFilter.FILTER_REJECT}if(b.hasAttribute&&b.getAttribute&&b.hasAttribute(W)&&b.getAttribute(W)!==c.id){var d=c.factory.find(b.getAttribute(W));if(d){c._isolatedNodes.push(b);return NodeFilter.FILTER_REJECT}}return NodeFilter.FILTER_ACCEPT}}}a.prototype.claim=function(a){a.setAttribute(W,this.id)};a.prototype.hasTransformerId=function(a){return a.hasAttribute(W)};a.prototype.getTransformerId=function(a){return this.hasTransformerId(a)?a.getAttribute(W):undefined};a.prototype.apply=function(a,b,c){var d=this;var e=this.factory;var f;var g=U.Rejected;var h=e.getAnalytics().mark(function(b){if(f){e.getAnalytics().emit(E.FailTransform,{transformer:d.name,mode:a,duration:b,error:S(f),errorRaw:f})}else if(g===U.Transformed){e.getAnalytics().emit(E.SuccessTransform,{transformer:d.name,mode:a,duration:b,cache:!d._firstRun,async:d.factory.getWorkFrame().isAsync()})}else{e.getAnalytics().emit(E.DisabledTransform,{transformer:d.name,mode:a,duration:b})}});e.getAnalytics().emit(E.StartTransform,{transformer:this.name,mode:a});if(!this.isEnabled(a)){g=U.Disabled;h();return L.resolve(g)}if(!this.shouldTransform(a,b)){g=U.Transformed;h();return L.resolve(g)}this._isolatedNodes=[];var i;try{this.claim(b);var j=document.createTreeWalker(c,NodeFilter.SHOW_ELEMENT,this._nodeFilter.acceptNode);var k=j.currentNode;i=function(a){try{if(!k){a(undefined);return{sync:false}}var b=k;k=j.nextNode();var c=!d.factory.getWorkFrame().runIfAsync(function(){return a(b)});return{sync:c,data:c?b:undefined}}catch(a){f=a;return{sync:true,data:undefined}}}}catch(a){f=a}return(i?this.process(a,i):L.reject(f)).then(function(b){g=b;d.setStoredAttribute("mode",a);return N(d._isolatedNodes,function(b){var c=e.find(b.getAttribute(W));if(c){return c.apply(a,b)}})}).catch(function(a){f=a}).then(function(){h();d._firstRun=false;return g})};a.prototype.destroy=function(){};a.prototype.setNodeTransformAllowed=function(a,b){if(this.shouldTransformNode(a)===b){return}if(b){a.removeAttribute(V)}else{a.setAttribute(V,V)}};a.prototype.getStoredMode=function(){var a;return(a=this.getStoredAttribute("mode"))!==null&&a!==void 0?a:T.ToLight};a.prototype.shouldTransformNode=function(a){return!a.hasAttribute(V)};a.prototype.getStoredAttribute=function(a){return this._attributes[a]};a.prototype.setStoredAttribute=function(a,b){this._attributes[a]=b};a.prototype.shouldTransform=function(a,b){return this.getStoredAttribute("mode")!==a};a.prototype.isEnabled=function(a){var b=this.factory.config;if(!Array.isArray(b.transformers[this.name])){return false}return b.transformers[this.name].includes(a)};return a}();var Z={target:undefined,baseColor:{r:31,g:31,b:31},contrastRatio:4.5,async:false,asyncAutoThreshold:100,asyncMaxFrameDuration:20,sneaky:false,sneakyTransition:"opacity .2s ease-in-out",transformers:{"color-contrast":[],"media-query":[],combined:[T.ToDark,T.ToLight]},rollbackOnCopy:false,onError:function(a){console.error("[Darkosha]",a)},contrastTableBorders:false};var _={};function aa(a){if(!_[a.type]){return}for(var b=0,c=_[a.type];b<c.length;b++){var d=c[b];var e=d.instances[0];if(e){d.handler(a,e)}}}function ba(a,b,c){if(!_[b]){_[b]=[{handler:c,instances:[a]}];window.addEventListener(b,aa);return}for(var d=0,e=_[b];d<e.length;d++){var f=e[d];if(f.handler===c){f.instances.push(a);return}}_[b].push({handler:c,instances:[a]})}function ca(a,b,c){if(_[b]){var d=_[b];_[b]=[];for(var e=0,f=d;e<f.length;e++){var g=f[e];if(g.handler!==c){continue}var h=g.instances;g.instances=[];for(var i=0,j=h;i<j.length;i++){var k=j[i];if(k!==a){g.instances.push(k)}}if(g.instances.length){_[b].push(g)}}if(!_[b].length){window.removeEventListener(b,aa);delete _[b]}}}var da=c("./node_modules/@kiy/color/index.js");var ea=c.n(da);var fa=-1;var ga="__darkoshaNodeId__";var ha=function(){function a(){this._store={};this._clean=true;this._claimAndGetNodeId=function(a){if(!a[ga]){a[ga]="node_".concat(++fa)}return a[ga]}}a.prototype.saveNodeStyle=function(a,b,c,d){if(d===void 0){d=false}var e=this._claimAndGetNodeId(a);this._store[e]=this._store[e]||{};this._store[e]["style_".concat(b).concat(d?"_important":"")]=c;this._clean=false};a.prototype.saveNodeAttr=function(a,b,c){var d=this._claimAndGetNodeId(a);this._store[d]=this._store[d]||{};this._store[d]["attr_".concat(b)]=c;this._clean=false};a.prototype.restoreNodeStyle=function(a){var b=this._claimAndGetNodeId(a);var c=this._store[b];if(c){var d=Object.keys(c);for(var e=0,f=d;e<f.length;e++){var g=f[e];var h=g.split("_"),i=h[0],j=h[1],k=h[2];var l=c[g];switch(i){case"style":a.style.setProperty(j,l,k);break;case"attr":a.setAttribute(j,l);break}}}};a.prototype.clear=function(){this._store={};this._clean=true};return a}();var ia=["top","right","bottom","left"];function ja(a){return"rgb(".concat(a.r,", ").concat(a.g,", ").concat(a.b,")")}var ka=function(a){b(c,a);function c(){var b=a!==null&&a.apply(this,arguments)||this;b.name="color-contrast";b._darkStore=new ha;b._lightStore=new ha;b._getFixedForegroundColor=function(a,b,c){var d=a.lab().array();var e;var f=b.lab().array()[0];var g=50;var h=50+c;var i=(h+g)/2;e=d[0]*((100-c)/100)+c;if(f>i){e=Math.min(e,2*i-e);e=(e-c)*(g-c)/(i-c)+c}else{e=Math.max(e,2*i-e);e=100-(100-e)*(100-h)/(100-i)}return ea().lab(e,d[1],d[2]).rgb()};return b}c.prototype.test=function(a){return true};c.prototype.destroy=function(){a.prototype.destroy.call(this);this._lightStore.clear();this._darkStore.clear()};c.prototype.process=function(a,b){var c=this;var d;var e=new(ea())(this.factory.config.baseColor);var f=ja(this.factory.config.baseColor);var g=[];var h=false;return this.factory.getWorkFrame().asyncWork(b,function(b,i){if(!d){d=b}if(!b){i();return}if(!c.shouldTransformNode(b)){return}g.push(b);if(a===T.ToDark){if(!c.getStoredAttribute("scanned")){c._computeAndSaveStyles(b,e)}else if(c.getStoredAttribute("color")!==f){c._lightStore.restoreNodeStyle(b);h=true}}}).then(function(){c.setStoredAttribute("color",f);if(a===T.ToDark){c.setStoredAttribute("scanned","true")}if(h){return c.factory.getWorkFrame().asyncIterate(g,function(a){c._computeAndSaveStyles(a,e)})}}).then(function(){var b=a===T.ToDark?c._darkStore:c._lightStore;return c.factory.getWorkFrame().asyncIterate(g,function(a){b.restoreNodeStyle(a)})}).then(function(){return U.Transformed})};c.prototype.shouldTransform=function(b,c){var d=a.prototype.shouldTransform.call(this,b,c);if(b===T.ToLight){return d}var e=ja(this.factory.config.baseColor);return d||this.getStoredAttribute("color")!==e};c.prototype._computeAndSaveStyles=function(a,b){var c=b.lab().array()[0];var d=window.getComputedStyle(a);var e=new(ea())(d.getPropertyValue("color")||undefined);var f=a.getAttribute("color");if(!this._isValidContrast(e,b)){e=this._getFixedForegroundColor(e,b,c);this._setNodeStyleProperty(a,"color",e.hex());if(f){this._setNodeAttr(a,"color",e.hex())}}var g=a.style.backgroundColor;var h=d.backgroundColor?new(ea())(d.backgroundColor):new(ea())(g||undefined);var i=a.getAttribute("bgcolor");if(!this._isValidContrast(h,e)){h=this._getFixedForegroundColor(h,e,c);this._setNodeStyleProperty(a,"background-color",h.hex());if(i){this._setNodeAttr(a,"bgcolor",h.hex())}}var j;var k;var l;for(var m=0,n=ia;m<n.length;m++){var o=n[m];k="border-".concat(o,"-color");l=d[k];if(l!==undefined&&l.length){j=new(ea())(l);if(this.factory.config.contrastTableBorders){if(!this._isValidContrast(h,j)){j=this._getFixedForegroundColor(j,h,c);this._setNodeStyleProperty(a,k,j.hex())}}else if(this._isValidContrast(h,j)){j=this._getFixedForegroundColor(h,j,c);this._setNodeStyleProperty(a,k,j.hex())}}}};c.prototype._setNodeStyleProperty=function(a,b,c){var d=a.style.getPropertyPriority(b)==="important";this._lightStore.saveNodeStyle(a,b,a.style.getPropertyValue(b),d);this._darkStore.saveNodeStyle(a,b,c,true)};c.prototype._setNodeAttr=function(a,b,c){this._lightStore.saveNodeAttr(a,b,a.getAttribute(b));this._darkStore.saveNodeAttr(a,b,c)};c.prototype._isValidContrast=function(a,b){return a.contrast(b)>=this.factory.config.contrastRatio};return c}(Y);var la=function(){function a(a){var b=this;this._workFrame=a;this._buffer=[];this.next=function(a){if(b._buffer.length){if(b._workFrame.runIfAsync(function(){return a(b._buffer.pop())})){return{sync:false}}return{sync:true,data:b._buffer.pop()}}b._subscription=a;return{sync:false}}}a.prototype.push=function(a){var b=this;if(this._subscription){if(!this._workFrame.runIfAsync(function(){return b._pushToSubscription(a)})){this._pushToSubscription(a)}}else{this._buffer.unshift(a)}};a.prototype._pushToSubscription=function(a){var b=this._subscription;this._subscription=undefined;b(a)};return a}();var ma=c("./node_modules/postcss-media-query-parser/dist/index.js");var na=4;function oa(a){var b;for(var c=0;c<document.styleSheets.length;c++){b=document.styleSheets[c];if(b.ownerNode===a||window.__DARKOSHA_TEST__){return b}}}function pa(a,b,c){if(a.type===b){c(a)}if(Array.isArray(a.nodes)){for(var d=0,e=a.nodes;d<e.length;d++){var f=e[d];pa(f,b,c)}}}function qa(a,b){var c=a.parent;if(!c||!Array.isArray(c.nodes)){return}var d=c.nodes.findIndex(function(b){return b===a});if(d===-1){return}c.nodes[d]=b;b.parent=c}function ra(a){var b,c,d;switch(a.type){case"media-feature-expression":return"(".concat(a.nodes.map(function(a){return ra(a)}).join(""),")");case"media-query":return a.nodes.map(function(a){return ra(a)}).join("");case"media-query-list":return a.nodes.map(function(a){return ra(a)}).join(",");case"colon":case"keyword":case"value":case"media-type":case"media-feature":case"url":default:return((b=a.before)!==null&&b!==void 0?b:"")+((c=a.value)!==null&&c!==void 0?c:"")+((d=a.after)!==null&&d!==void 0?d:"")}}function sa(a){var b=e({},a);if(Array.isArray(a.nodes)){b.nodes=[];for(var c=0,d=a.nodes;c<d.length;c++){var f=d[c];f=sa(f);f.parent=b;b.nodes.push(f)}}return b}var ta=function(a){b(c,a);function c(){var b=a!==null&&a.apply(this,arguments)||this;b.name="media-query";b._originalCssMediaText=[];return b}c.prototype.test=function(a){return/\(\s*prefers-color-scheme:\s*(dark|light)\s*\)/gi.test(a.innerHTML)};c.prototype.process=function(a,b){var c=this;var d;return this.factory.getWorkFrame().asyncWork(b,function(b,e){if(!d){d=b}if(c.getStoredAttribute("scanned")||!b){e();return}if(b.tagName!=="STYLE"){return}c._queryStyleSheet(b,a)}).then(function(){if(c.getStoredAttribute("scanned")){c.queryAndTransformMediaRules(a)}c.setStoredAttribute("scanned","true");return c._originalCssMediaText.length?U.Transformed:U.Rejected})};c.prototype.queryAndTransformMediaRules=function(a,b){if(this.getStoredAttribute("scanned")){for(var c=0,d=this._originalCssMediaText;c<d.length;c++){var e=d[c];this._patchMediaRule(e,a)}return this._originalCssMediaText}if(b){this._queryStyleSheet(b,a)}return this._originalCssMediaText};c.prototype.isFirstScanned=function(){return!!this.getStoredAttribute("scanned")};c.prototype.finishFirstScan=function(){this.setStoredAttribute("scanned","true")};c.prototype._queryStyleSheet=function(a,b){var c=oa(a);var d;if(!c){return}for(var e=0;e<c.cssRules.length;e++){d=c.cssRules[e];if(d.type!==na){continue}var f={rule:d,raw:d.media.mediaText};this._originalCssMediaText.push(f);this._patchMediaRule(f,b)}};c.prototype._patchMediaRule=function(a,b){var c;a.parsed=(c=a.parsed)!==null&&c!==void 0?c:(0,ma["default"])(a.raw);var d=sa(a.parsed);pa(d,"media-feature",function(c){if(c.value==="prefers-color-scheme"){var d=c.parent.nodes.find(function(a){return a.type==="value"});var e=b===T.ToDark?/^dark$/gi:/^light$/gi;var f=e.test(String(d.value));var g=f?"(min-height: 0px)":"(max-height: 0px)";qa(c.parent,{type:"media-type",value:g});a.hasPrefersColorsScheme=true}});a.rule.media.mediaText=ra(d)};return c}(Y);var ua=function(a){b(c,a);function c(b,c){var d=a.call(this,b,c)||this;d.name="combined";d.mediaQueryTransformer=new ta(b,c);return d}c.prototype.process=function(b,c){var d=this;var e;var f=false;var g=new la(this.factory.getWorkFrame());this.factory.getWorkFrame().runAsync(function(){d.factory.getWorkFrame().asyncWork(c,function(a,c){var h;if(!e){e=a}if(!a){c();return}var i;var j;if(a.tagName==="STYLE"&&!d.mediaQueryTransformer.isFirstScanned()){j=(h=i===null||i===void 0?void 0:i.length)!==null&&h!==void 0?h:0;i=d.mediaQueryTransformer.queryAndTransformMediaRules(b,a);for(var k=j;k<i.length;k++){if(i[k].hasPrefersColorsScheme){f=true;d._lockNodesInMediaQuery(i[k],e)}}}if(a.tagName!=="STYLE"){g.push(a)}}).then(function(){return g.push(undefined)})});return a.prototype.process.call(this,b,g.next).then(function(a){if(b===T.ToDark){d.setStoredAttribute("scanned","true")}if(d.mediaQueryTransformer.isFirstScanned()){d.mediaQueryTransformer.queryAndTransformMediaRules(b)}else{d.mediaQueryTransformer.finishFirstScan()}if(f){d.factory.getAnalytics().emit(E.DetectMediaQuery,{mode:b})}return a})};c.prototype._lockNodesInMediaQuery=function(a,b){for(var c=0;c<a.rule.cssRules.length;c++){var d=a.rule.cssRules[c].selectorText;if(typeof d==="string"){var e=b.querySelectorAll(d);for(var f=0;f<e.length;f++){this.setNodeTransformAllowed(e[f],false)}}}};return c}(ka);var va=1;function wa(a){var b;var c=a.commonAncestorContainer;if(c.nodeType===va){return c}return(b=c.parentElement)!==null&&b!==void 0?b:document.body}var xa={};var ya=0;function za(){ya=0}function Aa(){return xa}var Ba=function(){function a(a){this._factory=a;this.id="transformer_".concat(ya++);this._destroyed=false;this._transformers=[new ua(this.id,a),new ta(this.id,a),new ka(this.id,a)];xa[this.id]=this}a.prototype.claim=function(a){this._transformers[0].claim(a)};a.prototype.hasTransformerId=function(a){return this._transformers[0].hasTransformerId(a)};a.prototype.getTransformerId=function(a){return this._transformers[0].getTransformerId(a)};a.prototype.apply=function(a,b){var c=b instanceof Range;var d=c?wa(b):b;var e=c?X(d):d;if(!e){return L.resolve(U.Skipped)}if(c){var f=this.getTransformerId(e);if(f!==this.id){var g=xa[f];if(g){return g.apply(a,b)}return L.resolve(U.Skipped)}var h=this._transformers.every(function(a){return a.getStoredMode()===T.ToLight})?T.ToLight:T.ToDark;if(a===T.ToLight&&a===h){return L.resolve(U.Intact)}}return N(this._transformers,function(b,c){if(!b.test(d)){return}return b.apply(a,e,d).then(function(a){if(a===U.Transformed){c(U.Transformed)}})},U.Rejected)};a.prototype.destroy=function(){if(this._destroyed){return}this._destroyed=true;for(var a=0,b=this._transformers;a<b.length;a++){var c=b[a];c.destroy()}this._factory.delete(this);delete xa[this.id]};return a}();var Ca=function(){function a(a,b,c){this._workFrame=a;this.config=b;this._analytics=c;this._managers={}}a.prototype.create=function(){var a=new Ba(this);this._managers[a.id]=a;return a};a.prototype.find=function(a){return this._managers[a]};a.prototype.findForNode=function(a){var b=a.getAttribute("data-darkosha-id");return this.find(b)};a.prototype.delete=function(a){if(this._managers[a.id]){this._managers[a.id].destroy()}delete this._managers[a.id]};a.prototype.destroy=function(){var a=Object.values(this._managers);for(var b=0,c=a;b<c.length;b++){var d=c[b];this.delete(d)}};a.prototype.getWorkFrame=function(){return this._workFrame};a.prototype.getAnalytics=function(){return this._analytics};return a}();function Da(a){var b=document.getSelection();for(var c=0;c<b.rangeCount;c++){a(b.getRangeAt(c))}}function Ea(a,b){var c=a.cloneContents();for(var d=0;d<c.childNodes.length;d++){b(c.childNodes[d])}}function Fa(a){var b=[];var c=[];Ea(a,function(a){var d,e,f,g;if(!a){return}switch(a.nodeType){case Node.TEXT_NODE:b.push((d=a.textContent)!==null&&d!==void 0?d:"");c.push((e=a.textContent)!==null&&e!==void 0?e:"");break;case Node.ELEMENT_NODE:b.push((f=a.textContent)!==null&&f!==void 0?f:"");c.push((g=a.outerHTML)!==null&&g!==void 0?g:"");break}});return{text:b.join(""),html:c.join("")}}function Ga(a){if(a===void 0){a=false}var b,c;var d=new L(function(a,d){b=a;c=d},a);return{promise:d,resolve:b,reject:c}}function Ha(a,b){var c=a(b);if(c.sync){b(c.data)}}var Ia=false;function Ja(a){Ia=a}function Ka(){return Ia}var La=function(){function a(a,b){if(b===void 0){b=function(){return undefined}}this._config=a;this._onAsyncToggle=b;this._frameStartTs=0;this._async=false;this.clear()}a.prototype.start=function(){if(this._config.async){this._frameStartTs=performance.now()}};a.prototype.clear=function(){var a=Ia?false:this._config.async;if(a==="auto"){this._async=false}else{this._async=a}};a.prototype.isAsync=function(){return this._async};a.prototype.runIfAsync=function(a){var b=performance===null||performance===void 0?void 0:performance.now();var c=b-this._frameStartTs;if(!this._async&&this._config.async==="auto"){if(c>this._config.asyncAutoThreshold){this._onAsyncToggle();this._async=true}else{return false}}if(!this._async||!this._config.async){return false}if(c>this._config.asyncMaxFrameDuration){this.runAsync(a);return true}return false};a.prototype.run=function(a){if(!this.runIfAsync(a)){a()}};a.prototype.runAsync=function(a){if(this._async){this.runAlwaysAsync(a)}else{a()}};a.prototype.runAlwaysAsync=function(a){var b=this;requestAnimationFrame(function(){b.start();a()})};a.prototype.asyncWork=function(a,b){var c=Ga(),d=c.promise,e=c.resolve;var f=false;var g=function(a){f=true;e(a)};var h=function(c){b(c,g);if(!f){while(true){var d=a(h);if(d.sync){b(d.data,g);if(f){return}}else{return}}}};Ha(a,h);return d};a.prototype.asyncIterate=function(a,b){var c=this;var d=0;return this.asyncWork(function(b){var e={index:d,data:a[d]};d++;if(c.runIfAsync(function(){return b(e)})){return{sync:false}}return{sync:true,data:e}},function(c,d){if(c.index>=a.length){d();return}b(c.data)})};return a}();function Ma(a,b){if(a==="true"){return true}if(a==="false"){return false}if(b.includes(a)){return a}return false}var Na=function(){function a(b){var c=this;this.buildDate=1688039506691;this.buildVersion="2.3.1";this._analytics=new H;this._lastPromise=L.resolve();this._isCopyEventHandlerLocked=false;this._originalConfig=e(e({},Z),b);this._config=e(e({},this._originalConfig),{async:Ma(this._originalConfig.async,["auto"])});this._workFrame=new La(this._config,function(){c._config.sneaky=true;c._toggleVisibility(false)});this._factory=new Ca(this._workFrame,this._config,this._analytics);this._manager=this._factory.create();this._manager.claim(this._config.target);if(this._config.rollbackOnCopy){ba(this,"copy",a._globalHandleCopyEvent)}}a.prototype.transform=function(a){if(a===void 0){a=this._config.baseColor}return L.unwrap(this._applyTransform(a,T.ToDark)).then(function(){return undefined})};a.prototype.rollback=function(){return L.unwrap(this._applyTransform(this._config.baseColor,T.ToLight)).then(function(){return undefined})};a.prototype.setColor=function(a){this._config.baseColor=a};a.prototype.isolateSubtree=function(a){var b=this._factory.findForNode(a);if(b){return}b=this._factory.create();b.claim(a)};a.prototype.integrateSubtree=function(a){var b=this._factory.findForNode(a);if(b){b.destroy()}};a.prototype.destroy=function(){this._factory.destroy();ca(this,"copy",a._globalHandleCopyEvent)};a.prototype.on=function(a,b){this._analytics.on(a,b)};a.prototype.off=function(a,b){this._analytics.off(a,b)};a.prototype.getConfig=function(){return this._originalConfig};a._globalHandleCopyEvent=function(a,b){b._handleCopyEvent(a)};a.prototype._onCopyMeasured=function(a,b){this._analytics.emit(E.SuccessClipboard,{duration:b,method:a.method})};a.prototype._handleCopyEvent=function(a){var b=this;var c,d;if(this._isCopyEventHandlerLocked||this._currentMode!==T.ToDark){return}try{Ja(true);var e={method:F.customRange};var f=this._analytics.mark(this._onCopyMeasured.bind(this,e));if((c=document.queryCommandEnabled)===null||c===void 0?void 0:c.call(document,"copy")){e.method=F.execCommand;this._isCopyEventHandlerLocked=true;this._applyTransform(this._config.baseColor,T.ToLight);(d=document.execCommand)===null||d===void 0?void 0:d.call(document,"copy",false);this._applyTransform(this._config.baseColor,T.ToDark);f();this._isCopyEventHandlerLocked=false}else{e.method=F.customRange;var g=[];var h=[];Da(function(a){b._applyTransform(b._config.baseColor,T.ToLight,a).then(function(b){if(b!==U.Skipped){g.push(a);if(b!==U.Intact){h.push(a)}}})});if(!g.length){return}var i=[];var j=[];for(var k=0,l=g;k<l.length;k++){var m=l[k];var n=Fa(m);i.push(n.html);j.push(n.text)}var o=j.join("");var p=i.join("");a.clipboardData.setData("text/plain",o);a.clipboardData.setData("text/html",p);for(var q=0,r=h;q<r.length;q++){var m=r[q];this._applyTransform(this._config.baseColor,T.ToDark,m)}f()}a.preventDefault();Ja(false)}catch(a){Ja(false);this._analytics.emit(E.FailClipboard,{})}};a.prototype._toggleVisibility=function(a){if(!this._config.sneaky){return}if(a){this._config.target.style.transition=this._config.sneakyTransition;this._config.target.style.opacity="1"}else{this._config.target.style.transition="none";this._config.target.style.opacity="0"}};a.prototype._onMeasured=function(a,b){if(a.status===U.Transformed){this._analytics.emit(E.Success,{duration:b,mode:a.mode})}else{this._analytics.emit(E.Fail,{duration:b,mode:a.mode})}};a.prototype._applyTransform=function(a,b,c){var d=this;return this._lastPromise.then(function(){var e={mode:b};var f=d._analytics.mark(d._onMeasured.bind(d,e));d._analytics.emit(E.Start,{mode:b});var g=Ga(),h=g.promise,i=g.resolve;d._lastPromise=h;d.setColor(a);if(d._config.async==="auto"){d._workFrame.clear();d._config.sneaky=false}d._toggleVisibility(false);d._workFrame.runAsync(function(){d._workFrame.start();d._manager.apply(b,c!==null&&c!==void 0?c:d._config.target).then(function(a){e.status=a;d._currentMode=b;d._toggleVisibility(true);f();i(a)})});return h})};return a}();function Oa(a){return new Na(a)}}();return d}()});var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("service/darkosha",["require","exports","@mail/darkosha","@mail/xray","default-values"],function(require,exports,a,b,c){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.createConfiguredDarkosha=void 0;b=__importDefault(b);var d=/\(\s*prefers-color-scheme:\s*(dark|light)\s*\)/gi;function e(e,f){if(!f&&!d.test(e.innerHTML)){return undefined}var g=document.visibilityState==="visible"||c.DARK_MODE_BACKGROUND_ASYNC;var h=(0,a.createDarkosha)({target:e,baseColor:c.DARK_MODE_BASE_COLOR,async:g?c.DARK_MODE_ASYNC:false,asyncAutoThreshold:c.DARK_MODE_ASYNC_THRESHOLD,asyncMaxFrameDuration:c.DARK_MODE_FRAME_BUDGET,sneaky:c.DARK_MODE_SNEAKY,rollbackOnCopy:c.DARK_MODE_ROLLBACK_ON_COPY,transformers:c.DARK_MODE_MEDIA_QUERY?{combined:[a.TransformerMode.ToDark,a.TransformerMode.ToLight]}:{"color-contrast":[a.TransformerMode.ToDark,a.TransformerMode.ToLight]},contrastTableBorders:c.DARKOSHA_TABLE_BORDER_FIX_ENABLED});h.on(a.AnalyticsEvent.Start,function(a){var c;b.default.send("darkosha_start",{i:(c={},c[a.data.mode]=1,c)})});h.on(a.AnalyticsEvent.FailTransform,function(a){var b=window.coreLogger;b===null||b===void 0?void 0:b.dispatchError(a.data.errorRaw,{darkosha:true,from:"letter-body",transformer:a.data.transformer,mode:a.data.mode,duration:a.data.duration})});h.on(a.AnalyticsEvent.Fail,function(a){var c;b.default.send("darkosha_fail",{i:(c={},c[a.data.mode]=1,c.duration=a.data.duration,c)})});h.on(a.AnalyticsEvent.SuccessClipboard,function(a){var c;b.default.send("darkosha_copy",{i:(c={},c["duration_".concat(a.data.method)]=a.data.duration,c)})});h.on(a.AnalyticsEvent.FailClipboard,function(){b.default.send("darkosha_fail",{i:{clipboard:1}})});h.on(a.AnalyticsEvent.Success,function(a){var c;b.default.send("darkosha_success",{i:(c={},c[a.data.mode]=1,c.duration=a.data.duration,c)})});var i=false;h.on(a.AnalyticsEvent.DetectMediaQuery,function(){i=true;b.default.send("darkosha_mq")});h.on(a.AnalyticsEvent.SuccessTransform,function(a){var c;if(!a.data.cache){b.default.send("darkosha_transform",{i:(c={},c["duration_".concat(a.data.mode)]=a.data.duration,c["mq_".concat(i)]=1,c["async_".concat(a.data.async)]=1,c["async_".concat(a.data.async,"_duration")]=a.data.duration,c)})}});return h}exports.createConfiguredDarkosha=e});var __assign=this&&this.__assign||function(){__assign=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++){b=arguments[c];for(var e in b)if(Object.prototype.hasOwnProperty.call(b,e))a[e]=b[e]}return a};return __assign.apply(this,arguments)};var __createBinding=this&&this.__createBinding||(Object.create?function(a,b,c,d){if(d===undefined)d=c;var e=Object.getOwnPropertyDescriptor(b,c);if(!e||("get"in e?!b.__esModule:e.writable||e.configurable)){e={enumerable:true,get:function(){return b[c]}}}Object.defineProperty(a,d,e)}:function(a,b,c,d){if(d===undefined)d=c;a[d]=b[c]});var __setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(a,b){Object.defineProperty(a,"default",{enumerable:true,value:b})}:function(a,b){a["default"]=b});var __importStar=this&&this.__importStar||function(a){if(a&&a.__esModule)return a;var b={};if(a!=null)for(var c in a)if(c!=="default"&&Object.prototype.hasOwnProperty.call(a,c))__createBinding(b,a,c);__setModuleDefault(b,a);return b};var __awaiter=this&&this.__awaiter||function(a,b,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new(c||(c=Promise))(function(c,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d["throw"](a))}catch(a){f(a)}}function i(a){a.done?c(a.value):e(a.value).then(g,h)}i((d=d.apply(a,b||[])).next())})};var __generator=this&&this.__generator||function(a,b){var c={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},d,e,f,g;return g={next:h(0),throw:h(1),return:h(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function h(a){return function(b){return i([a,b])}}function i(g){if(d)throw new TypeError("Generator is already executing.");while(c)try{if(d=1,e&&(f=g[0]&2?e["return"]:g[0]?e["throw"]||((f=e["return"])&&f.call(e),0):e.next)&&!(f=f.call(e,g[1])).done)return f;if(e=0,f)g=[g[0]&2,f.value];switch(g[0]){case 0:case 1:f=g;break;case 4:c.label++;return{value:g[1],done:false};case 5:c.label++;e=g[1];g=[0];continue;case 7:g=c.ops.pop();c.trys.pop();continue;default:if(!(f=c.trys,f=f.length>0&&f[f.length-1])&&(g[0]===6||g[0]===2)){c=0;continue}if(g[0]===3&&(!f||g[1]>f[0]&&g[1]<f[3])){c.label=g[1];break}if(g[0]===6&&c.label<f[1]){c.label=f[1];f=g;break}if(f&&c.label<f[2]){c.label=f[2];c.ops.push(g);break}if(f[2])c.ops.pop();c.trys.pop();continue}g=b.call(a,c)}catch(a){g=[6,a];e=0}finally{d=f=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:true}}};var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("helpers/logger",["require","exports","@mail/features","helpers/parse","logger","mail/Attachment","service/notify","service/radars/index","./create-message-form-data"],function(require,exports,a,b,c,d,e,f,g){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.sendLogs=void 0;a=__importDefault(a);c=__importDefault(c);d=__importDefault(d);e=__importDefault(e);f=__importStar(f);function h(a,b){var c=new Blob([a],{type:"text/plain"});c.name=b;return c}var i=a.default.getAsJSON("logger-config",{});var j={Body:true,Subject:true,body:true,"body.html":true,subject:true,name:true,signature:true,translate_query:true,token:true};if(i.ignoreKeys){Object.assign(j,i.ignoreKeys)}var k={"/api/v1/utils/translate":{query:true}};if(i.ignoreUrlKeys){Object.assign(k,i.ignoreUrlKeys)}var l={insert_success:{result:true},success:{jqXHR:true,direct:true,target:true}};var m=parseInt(i.maxDepth,10)||10;var n=function(a){if(a&&typeof a==="object"){return a.length}return void 0};var o=function(a,b,c,d){if(c===void 0){c=0}if(d===void 0){d=j}if(!a){return a}if(typeof a!=="object"){return a}if(a.toLogJSON){a=a.toLogJSON()}if(b&&l[b]){d=__assign(__assign({},d),l[b])}return Object.keys(a).reduce(function(b,e){var f=a[e];if(e==="url"&&k[f]){d=__assign(__assign({},d),k[f])}if(typeof f==="object"){if(d[e]){b[e]=n(f);return b}if(c<=m&&!(f&&f.nodeType)){b[e]=o(f,null,c+1,d);return b}}else{b[e]=d[e]?n(f):f}return b},{})};c.default.filterArguments=o;function p(){var j,k;return __awaiter(this,void 0,void 0,function(){var l,m,n,o,p,q,r,s,t,u;return __generator(this,function(v){switch(v.label){case 0:l={in_code:(j=window.__trackJS)===null||j===void 0?void 0:j.__errors,external:(k=window.__trackJS)===null||k===void 0?void 0:k.__externalErrors};m={errors:l,loadLog:window.loadlogSteps};try{n=f.radarService.loadPerformanceLog();if(Array.isArray(n)){n.slice().sort(function(a,b){if(a.startTime&&b.startTime&&a.startTime!==b.startTime){return a.startTime-b.startTime}return a.endTime-b.endTime})}else{(0,f.default)("invalid_notarr_perflog")}if((0,b.parseStringToBoolean)(i.inlinePerfLog)){c.default.add(JSON.stringify(n))}else{m.perfLog=n}}catch(a){c.default.add(a);console.error(a)}m.logs=(0,b.parseStringToBoolean)(i.usePrint)?c.default.print(true):c.default.entries;try{o=JSON.stringify(m)}catch(a){c.default.add(a);console.error(a)}p=a.default.getAsArray("email_logs_to");if(!p.length){console.error("No emails to send logs to found");return[2]}q=p[0];r=p.slice(1,p.length);return[4,(0,g.createMessageFormData)({subject:"[octavius client logs]",priority:1,body:{text:"",html:""},correspondents:{to:[{email:q}],cc:r.map(function(a){return{email:a}})}})];case 1:s=v.sent();try{t=d.default.from(h(o,"logs.json"))}catch(a){s.set("body.html",o);console.error(a);(0,f.default)("log_file_create_fail")}u=t?s.addAttachment(t):Promise.resolve();u.then(function(){return s.send()}).then(function(){if(e.default.isReady()){e.default.add({qa:"sent-logs",text:i18n("Логи отправлены")})}}).catch(function(a){console.error(a);(0,f.default)("logs_send_fail");e.default.add({type:e.default.types.error,text:i18n("Логи не отправлены")})});return[2]}})})}function q(){require(["default-values"],function(a){if(a.ENABLE_LOGGING){p()}})}exports.sendLogs=q});define("feast-tpl!app/feast-tpl!ui-block/drag-and-drop/drag-and-drop.html",["feast"],function(a){return a.smartParse("<div></div>\n","app/feast-tpl!ui-block/drag-and-drop/drag-and-drop.html")});define("feast-tpl!ui-block/drag-and-drop/drag-and-drop.html",["feast-tpl!app/feast-tpl!ui-block/drag-and-drop/drag-and-drop.html"],function(a){return a});var __createBinding=this&&this.__createBinding||(Object.create?function(a,b,c,d){if(d===undefined)d=c;var e=Object.getOwnPropertyDescriptor(b,c);if(!e||("get"in e?!b.__esModule:e.writable||e.configurable)){e={enumerable:true,get:function(){return b[c]}}}Object.defineProperty(a,d,e)}:function(a,b,c,d){if(d===undefined)d=c;a[d]=b[c]});var __setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(a,b){Object.defineProperty(a,"default",{enumerable:true,value:b})}:function(a,b){a["default"]=b});var __importStar=this&&this.__importStar||function(a){if(a&&a.__esModule)return a;var b={};if(a!=null)for(var c in a)if(c!=="default"&&Object.prototype.hasOwnProperty.call(a,c))__createBinding(b,a,c);__setModuleDefault(b,a);return b};var __awaiter=this&&this.__awaiter||function(a,b,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new(c||(c=Promise))(function(c,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d["throw"](a))}catch(a){f(a)}}function i(a){a.done?c(a.value):e(a.value).then(g,h)}i((d=d.apply(a,b||[])).next())})};var __generator=this&&this.__generator||function(a,b){var c={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},d,e,f,g;return g={next:h(0),throw:h(1),return:h(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function h(a){return function(b){return i([a,b])}}function i(g){if(d)throw new TypeError("Generator is already executing.");while(c)try{if(d=1,e&&(f=g[0]&2?e["return"]:g[0]?e["throw"]||((f=e["return"])&&f.call(e),0):e.next)&&!(f=f.call(e,g[1])).done)return f;if(e=0,f)g=[g[0]&2,f.value];switch(g[0]){case 0:case 1:f=g;break;case 4:c.label++;return{value:g[1],done:false};case 5:c.label++;e=g[1];g=[0];continue;case 7:g=c.ops.pop();c.trys.pop();continue;default:if(!(f=c.trys,f=f.length>0&&f[f.length-1])&&(g[0]===6||g[0]===2)){c=0;continue}if(g[0]===3&&(!f||g[1]>f[0]&&g[1]<f[3])){c.label=g[1];break}if(g[0]===6&&c.label<f[1]){c.label=f[1];f=g;break}if(f&&c.label<f[2]){c.label=f[2];c.ops.push(g);break}if(f[2])c.ops.pop();c.trys.pop();continue}g=b.call(a,c)}catch(a){g=[6,a];e=0}finally{d=f=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:true}}};var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("helpers/create-message-with-attach",["require","exports","service/auth","service/compose","service/getModule","service/layer","service/radars/index","./check-files-from-event","./create-message-form-data","./signature"],function(require,exports,a,b,c,d,e,f,g,h){"use strict";Object.defineProperty(exports,"__esModule",{value:true});a=__importDefault(a);b=__importDefault(b);c=__importDefault(c);d=__importDefault(d);e=__importDefault(e);f=__importStar(f);var i="<div><br/></div>";function j(){return __awaiter(this,void 0,void 0,function(){var b,c;return __generator(this,function(d){switch(d.label){case 0:return[4,(0,g.createMessageFormData)()];case 1:b=d.sent();b.set("features.subject_from_attachments",true);c=(0,h.getHTMLSignature)(a.default.user);b.set("body.html",i+i+c);return[2,{formData:b}]}})})}function k(a,c){var d=c.slice(0,a.MAX_ATTACHMENTS_COUNT);b.default.add(a,{isDragAndDrop:true,dragAndDropItem:{files:d}})}function l(a){return __awaiter(this,void 0,void 0,function(){var g,h,i,l,m,n,o;return __generator(this,function(p){switch(p.label){case 0:g=(0,f.getDragEventCopyWithFiles)(a);h=d.default.getInstance();if(h){h.onHide()}p.label=1;case 1:p.trys.push([1,4,,5]);return[4,j()];case 2:i=p.sent().formData;return[4,(0,f.default)({event:g,limit:i.MAX_ATTACHMENTS_COUNT})];case 3:l=p.sent(),m=l.files,n=l.error;if(n){if(n===f.CheckFilesError.MAX_FILES){d.default.open("max-attach-count",{onAttachClick:function(){return k(i,m)}},{})}return[2]}k(i,m);(0,e.default)("dnd_create_msg_success");return[3,5];case 4:o=p.sent();b.default.onFailSent({},o);if(o&&o.get){(0,e.default)("dnd_create_msg_err",o.status)}else{(0,c.default)("trackJS").then(function(a){return a.addErrorFromApp(o,"dnd-create-msg")})}return[3,5];case 5:return[2]}})})}exports.default=l});var __createBinding=this&&this.__createBinding||(Object.create?function(a,b,c,d){if(d===undefined)d=c;var e=Object.getOwnPropertyDescriptor(b,c);if(!e||("get"in e?!b.__esModule:e.writable||e.configurable)){e={enumerable:true,get:function(){return b[c]}}}Object.defineProperty(a,d,e)}:function(a,b,c,d){if(d===undefined)d=c;a[d]=b[c]});var __setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(a,b){Object.defineProperty(a,"default",{enumerable:true,value:b})}:function(a,b){a["default"]=b});var __importStar=this&&this.__importStar||function(a){if(a&&a.__esModule)return a;var b={};if(a!=null)for(var c in a)if(c!=="default"&&Object.prototype.hasOwnProperty.call(a,c))__createBinding(b,a,c);__setModuleDefault(b,a);return b};var __awaiter=this&&this.__awaiter||function(a,b,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new(c||(c=Promise))(function(c,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d["throw"](a))}catch(a){f(a)}}function i(a){a.done?c(a.value):e(a.value).then(g,h)}i((d=d.apply(a,b||[])).next())})};var __generator=this&&this.__generator||function(a,b){var c={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},d,e,f,g;return g={next:h(0),throw:h(1),return:h(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function h(a){return function(b){return i([a,b])}}function i(g){if(d)throw new TypeError("Generator is already executing.");while(c)try{if(d=1,e&&(f=g[0]&2?e["return"]:g[0]?e["throw"]||((f=e["return"])&&f.call(e),0):e.next)&&!(f=f.call(e,g[1])).done)return f;if(e=0,f)g=[g[0]&2,f.value];switch(g[0]){case 0:case 1:f=g;break;case 4:c.label++;return{value:g[1],done:false};case 5:c.label++;e=g[1];g=[0];continue;case 7:g=c.ops.pop();c.trys.pop();continue;default:if(!(f=c.trys,f=f.length>0&&f[f.length-1])&&(g[0]===6||g[0]===2)){c=0;continue}if(g[0]===3&&(!f||g[1]>f[0]&&g[1]<f[3])){c.label=g[1];break}if(g[0]===6&&c.label<f[1]){c.label=f[1];f=g;break}if(f&&c.label<f[2]){c.label=f[2];c.ops.push(g);break}if(f[2])c.ops.pop();c.trys.pop();continue}g=b.call(a,c)}catch(a){g=[6,a];e=0}finally{d=f=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:true}}};var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("helpers/save-file-to-yourself",["require","exports","default-values","service/auth","service/compose","service/getModule","service/layer","service/radars/index","./check-files-from-event","./check-oversize-files","./create-message-form-data","./signature"],function(require,exports,a,b,c,d,e,f,g,h,i,j){"use strict";Object.defineProperty(exports,"__esModule",{value:true});b=__importDefault(b);c=__importDefault(c);d=__importDefault(d);e=__importDefault(e);f=__importDefault(f);g=__importStar(g);var k="<div><br/></div>";function l(){return __awaiter(this,void 0,void 0,function(){var a,c,d,e,f,g,h;return __generator(this,function(l){switch(l.label){case 0:return[4,(0,i.createMessageFormData)()];case 1:a=l.sent();c=b.default.user.attributes.name,d=c.first,e=c.last;f=(0,j.getHTMLSignature)(b.default.user);a.set("body.html",k+k+f);g=b.default.user.getEmail();h=d||"";if(e){h="".concat(h," ").concat(e)}a.set("correspondents.to",[{email:g,name:h||g}]);a.set("features.subject_from_attachments",true);return[2,{formData:a}]}})})}function m(b,d){var e=d.slice(0,b.MAX_ATTACHMENTS_COUNT);return(0,h.checkOversizeFiles)(e).then(function(d){var f=!(a.OVERSIZE_CLOUD_ATTACHES&&d);c.default.add(b,{autosend:f,isDragAndDrop:true,dragAndDropItem:{files:e}})})}function n(a){return __awaiter(this,void 0,void 0,function(){var b,h,i,j,k,n,o;return __generator(this,function(p){switch(p.label){case 0:b=(0,g.getDragEventCopyWithFiles)(a);h=e.default.getInstance();if(h){h.onHide()}p.label=1;case 1:p.trys.push([1,4,,5]);return[4,l()];case 2:i=p.sent().formData;return[4,(0,g.default)({event:b,limit:i.MAX_ATTACHMENTS_COUNT})];case 3:j=p.sent(),k=j.files,n=j.error;if(n){if(n===g.CheckFilesError.MAX_FILES){e.default.open("max-attach-count",{onAttachClick:function(){return m(i,k)}},{})}return[2]}m(i,k);(0,f.default)("dnd_to_yourself_success");return[3,5];case 4:o=p.sent();c.default.onFailSent({},o);if(o&&o.get){(0,f.default)("dnd_send_self_msg_err",o.status)}else{(0,d.default)("trackJS").then(function(a){return a.addErrorFromApp(o,"dnd-to-yourself")})}return[3,5];case 5:return[2]}})})}exports.default=n});var __createBinding=this&&this.__createBinding||(Object.create?function(a,b,c,d){if(d===undefined)d=c;var e=Object.getOwnPropertyDescriptor(b,c);if(!e||("get"in e?!b.__esModule:e.writable||e.configurable)){e={enumerable:true,get:function(){return b[c]}}}Object.defineProperty(a,d,e)}:function(a,b,c,d){if(d===undefined)d=c;a[d]=b[c]});var __setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(a,b){Object.defineProperty(a,"default",{enumerable:true,value:b})}:function(a,b){a["default"]=b});var __importStar=this&&this.__importStar||function(a){if(a&&a.__esModule)return a;var b={};if(a!=null)for(var c in a)if(c!=="default"&&Object.prototype.hasOwnProperty.call(a,c))__createBinding(b,a,c);__setModuleDefault(b,a);return b};var __spreadArray=this&&this.__spreadArray||function(a,b,c){if(c||arguments.length===2)for(var d=0,e=b.length,f;d<e;d++){if(f||!(d in b)){if(!f)f=Array.prototype.slice.call(b,0,d);f[d]=b[d]}}return a.concat(f||Array.prototype.slice.call(b))};var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("ui-block/drag-and-drop/drag-and-drop",["require","exports","@mail/features","cfg","default-values","feast","feast-tpl!./drag-and-drop.html","helpers/create-message-with-attach","helpers/load-file-to-cloud","helpers/save-file-to-yourself","service/compose","service/layer","service/radars/index","service/smokescreen"],function(require,exports,a,b,c,d,e,f,g,h,i,j,k,l){"use strict";Object.defineProperty(exports,"__esModule",{value:true});a=__importDefault(a);b=__importDefault(b);d=__importDefault(d);e=__importDefault(e);f=__importDefault(f);g=__importDefault(g);h=__importDefault(h);i=__importDefault(i);j=__importDefault(j);k=__importDefault(k);exports.default=d.default.Block.extend({name:"drag-and-drop",template:e.default,_getContainer:function(){return document.querySelector("#drag-and-drop")},attrChanged:{"dark-mode":function(a){if(this.ui){this.ui.$set({darkMode:a})}}},didMount:function(){var a=this;require(["mediator/themes-manager"],function(b){var c=b.default;c.registerInstanceByName("drag-and-drop",a)});this.renderUI()},didUnmount:function(){this.unrenderUI()},renderUI:function(){var a=this;this.unrenderUI();new Promise(function(a,b){require(["cross.project.dnd"],a,b)}).then(__importStar).then(function(b){var c=b.default;a.ui=c(a.getParams())})},unrenderUI:function(){var a;(a=this.ui)===null||a===void 0?void 0:a.$destroy();this.ui=null},getParams:function(){var a={"unsafe-markOpen":"<mark>","unsafe-markClose":"</mark>","unsafe-br":"<br>"};var d=i18n("Перетащите файлы в эту область,{br}чтобы {markOpen}написать письмо{markClose}",a);var e=i18n("Отправить {markOpen}письмо себе{markClose}",a);var i=i18n("Загрузить {markOpen}в Облако{markClose}",a);var j=this.is("dark-mode");var l=!!b.default.qa;return{target:this._getContainer(),darkMode:j,isQA:l,zones:[{size:1.5,zones:[{size:1,text:d,radarFunction:function(){return(0,k.default)("dnd_drop_create_letter")},iconSize:"large",iconName:"mail",dropFunction:f.default,testId:"drop-zone-mail"}]},{size:1,zones:__spreadArray([{size:1,text:e,radarFunction:function(){return(0,k.default)("dnd_drop_to_yourself")},iconSize:"small",iconName:"self-mail",dropFunction:h.default,testId:"drop-zone-self-mail"}],c.DND_CLOUD_ENABLED?[{size:1,text:i,radarFunction:function(){return(0,k.default)("dnd_drop_to_cloud")},iconSize:"small",iconName:"cloud",dropFunction:g.default,testId:"drop-zone-cloud"}]:[],true)}],showRule:this._getShowRule(),onShow:this.showRadar,imgsBaseUrl:b.default.urls.packagesUrl,imgsPath:c.DND_IMAGES_PATH}},showRadar:function(){(0,k.default)("dnd_show")},_getShowRule:function(){var b=this;var c=a.default.has("drag-and-drop");if(!c){return function(){return false}}return function(){var a;var c=j.default.getInstance();var d=document.querySelectorAll((0,l.selector)('[data-test-id="popup-wrapper"]')).length!==0;var e=b.get("router").model.route&&b.get("router").model.route.is("#attachment #attachment-temporary #attachment-editor");var f=(a=window===null||window===void 0?void 0:window.__PH)===null||a===void 0?void 0:a.authForm.isVisible();return!i.default.isComposeActive()&&!c&&!d&&!e&&!f}}})});var __awaiter=this&&this.__awaiter||function(a,b,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new(c||(c=Promise))(function(c,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d["throw"](a))}catch(a){f(a)}}function i(a){a.done?c(a.value):e(a.value).then(g,h)}i((d=d.apply(a,b||[])).next())})};var __generator=this&&this.__generator||function(a,b){var c={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},d,e,f,g;return g={next:h(0),throw:h(1),return:h(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function h(a){return function(b){return i([a,b])}}function i(g){if(d)throw new TypeError("Generator is already executing.");while(c)try{if(d=1,e&&(f=g[0]&2?e["return"]:g[0]?e["throw"]||((f=e["return"])&&f.call(e),0):e.next)&&!(f=f.call(e,g[1])).done)return f;if(e=0,f)g=[g[0]&2,f.value];switch(g[0]){case 0:case 1:f=g;break;case 4:c.label++;return{value:g[1],done:false};case 5:c.label++;e=g[1];g=[0];continue;case 7:g=c.ops.pop();c.trys.pop();continue;default:if(!(f=c.trys,f=f.length>0&&f[f.length-1])&&(g[0]===6||g[0]===2)){c=0;continue}if(g[0]===3&&(!f||g[1]>f[0]&&g[1]<f[3])){c.label=g[1];break}if(g[0]===6&&c.label<f[1]){c.label=f[1];f=g;break}if(f&&c.label<f[2]){c.label=f[2];c.ops.push(g);break}if(f[2])c.ops.pop();c.trys.pop();continue}g=b.call(a,c)}catch(a){g=[6,a];e=0}finally{d=f=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:true}}};var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("actions/autoreply",["require","exports","@mail/jssdk/next/action/global","RPC"],function(require,exports,a,b){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.fetchAutoreply=exports.url=void 0;b=__importDefault(b);exports.url="filters/autoreply";function c(a){var c=a.emails,d=a.only_enabled,e=d===void 0?true:d;if(!c){return Promise.reject({emails:"required"})}if(!Array.isArray(c)){return Promise.reject({emails:"invalid"})}return b.default.call(exports.url,{emails:c,only_enabled:e})}exports.fetchAutoreply=(0,a.createGlobalAction)(exports.url,function(a){return __awaiter(void 0,void 0,Promise,function(){var b;return __generator(this,function(d){switch(d.label){case 0:return[4,c(a)];case 1:b=d.sent();return[2,b.body]}})})})});define("feast-tpl!app/feast-tpl!ui-block/compose-app/compose-app.html",["feast"],function(a){return a.smartParse('<div qa:id="{(attrs[\'window-mode\'] === \'collapsed\') ? \'\' : \'compose-app\'}"\n\t qa:state="extended:{attrs[\'support-extend\'] && attrs.extended}"\n\t message-uid="{attrs.form.uid}">\n\t<bem:mod name="fix"/>\n\t<bem:mod name="fullscreen" test="attrs.fullscreen"/>\n\t<bem:mod name="mobile" test="attrs.mobile"/>\n\t<bem:mod name="mobile-xxs" test="attrs[\'mobile-xxs\']"/>\n\t<bem:mod name="popup" test="!attrs.fullscreen"/>\n\t<bem:mod name="popup-extended" test="attrs[\'support-extend\'] && attrs.extended"/>\n\t<bem:mod name="window" test="attrs[\'window-mode\'] === \'window\'"/>\n\t<bem:mod name="collapsed" test="attrs[\'window-mode\'] === \'collapsed\' || attrs.hidden"/>\n\t<bem:mod name="adaptive" test="attrs.adaptive && !attrs.fullscreen"/>\n\t<bem:mod name="fixed" test="!attrs.adaptive && !attrs.fullscreen"/>\n\n\t<b:focus-zone\n\t\t\tfluid\n\t\t\tenabled="{attrs[\'window-mode\'] !== \'collapsed\' && !attrs[\'focusoff\'] && !attrs[\'hidden\']}"\n\t\t\tbem:block="compose-app"\n\t\t\tremit:first="focus-zone:first"\n\t\t\tremit:last="focus-zone:last">\n\t\t<fn:match name="content">\n\t\t\t\x3c!--<div bem:elem="wrapper" ref="wrapper">--\x3e\n\t\t\t\t<div\n\t\t\t\t\t\tbem:elem="compose"\n\t\t\t\t\t\tref="compose"\n\t\t\t\t>\n\t\t\t\t\t\x3c!-- COMPOSE.MAIL.RU --\x3e\n\t\t\t\t</div>\n\t\t</fn:match>\n\t</b:focus-zone>\n</div>\n',"app/feast-tpl!ui-block/compose-app/compose-app.html")});define("feast-tpl!ui-block/compose-app/compose-app.html",["feast-tpl!app/feast-tpl!ui-block/compose-app/compose-app.html"],function(a){return a});define("helpers/char-to-key",["exports"],function(exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=a;function a(a){return String.fromCharCode(a).toLowerCase()}});define("helpers/scrollbar-width",["exports"],function(exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var a=function a(){var b=document.createElement("div");b.style.overflowY="scroll";b.style.msOverflowStyle="scrollbar";b.style.width="50px";b.style.height="50px";b.style.visibility="hidden";document.body.appendChild(b);var c=b.offsetWidth-b.clientWidth;document.body.removeChild(b);return c}();exports.default=a});define("helpers/translation",["exports","default-values"],function(exports,a){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.isCyrillic=b;function b(b){var c=b.length;var d=0;var e=0;for(var f=0;f<c;){var g=b.charCodeAt(f++);if(g>1040&&g<1103){d++;e++;continue}if(g>0&&g<64){continue}if((g&63488)==55296&&f<c){var h=b.charCodeAt(f++);if((h&64512)==56320){continue}}e++}return d*100/e>a.LETTER_CYRILLIC_PERCENT}});define("mail/actions/Schedule",function(require){"use strict";var a=require("Action"),b=require("RPC");var c=a.extend({operation:function(a){switch(a.method){case c.UPDATE:return this._update(a.data);case c.REMOVE:return this._remove(a.data);default:throw new Error("Действие не найдено",a.method)}},_update:function(a){return b.post("messages/schedule/update",a)},_remove:function(a){return b.post("messages/schedule/remove",a)}});c.UPDATE="UPDATE";c.REMOVE="REMOVE";a.register("mail.Schedule",c);c.version="0.2.0";return c});define("tab-indexes",["exports"],function(exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var a=exports.compose={LABEL_TO:-1,LABEL_CC:-1,LABEL_BCC:-1,INPUT_ATTACH_FILE:-1,INPUT_TO:100,INPUT_CC:200,INPUT_BCC:300,INPUT_SUBJECT:400,BUTTON_ATTACH_FILE:500,EDITOR:505,EDITOR_ADDLINK_HREF:510,EDITOR_ADDLINK_TEXT:515,EDITOR_ADDLINK_SAVE:520,EDITOR_ADDLINK_CANCEL:525,EDITOR_ADDLINK_DELETE:530,INSERT_TABLE_ROWS:560,INSERT_TABLE_COLUMNS:561,INSERT_TABLE_SUBMIT:562,BUTTON_SEND:570,BUTTON_SAVE:580,BUTTON_CANCEL:590,BUTTON_COLLAPSE:600,BUTTON_EXTEND:650,BUTTON_CLOSE:700,HEAD_CONTROL_FROM:710,HEAD_CONTROL_CC:720,HEAD_CONTROL_BCC:730,BUTTON_CLOSE_CC:900,BUTTON_CLOSE_BCC:1100,BUTTON_MONEY_SEND:1300,BUTTON_ATTACH_CLOUD:1400,BUTTON_ATTACH_MAIL:1500,DROPDOWN_TEMPLATES:1600}});var __assign=this&&this.__assign||function(){__assign=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++){b=arguments[c];for(var e in b)if(Object.prototype.hasOwnProperty.call(b,e))a[e]=b[e]}return a};return __assign.apply(this,arguments)};var __createBinding=this&&this.__createBinding||(Object.create?function(a,b,c,d){if(d===undefined)d=c;var e=Object.getOwnPropertyDescriptor(b,c);if(!e||("get"in e?!b.__esModule:e.writable||e.configurable)){e={enumerable:true,get:function(){return b[c]}}}Object.defineProperty(a,d,e)}:function(a,b,c,d){if(d===undefined)d=c;a[d]=b[c]});var __setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(a,b){Object.defineProperty(a,"default",{enumerable:true,value:b})}:function(a,b){a["default"]=b});var __importStar=this&&this.__importStar||function(a){if(a&&a.__esModule)return a;var b={};if(a!=null)for(var c in a)if(c!=="default"&&Object.prototype.hasOwnProperty.call(a,c))__createBinding(b,a,c);__setModuleDefault(b,a);return b};var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("ui-block/compose-app/compose-app",["require","exports","@mail/contact-validation","@mail/features","@mail/flags","actions/autoreply","actions/checkContactsPossessing","actions/lastSeen","cfg","cloud/Entry","default-values","Emitter","feast","feast-mod/file-count","feast-mod/file-size","feast-mod/letter-date","feast-tpl!./compose-app.html","helpers/browser","helpers/char-to-key","helpers/on-oversize-attach-add","helpers/opener","helpers/scrollbar-width","helpers/signature","helpers/translation","lazy.modules","logger","mail/actions/ContactSuggests","mail/actions/Schedule","mail/Alias","mail/Attachment","mail/Collector","mail/Folder","mail/Message","mail/MessageFormData","mrg-xray","RPC","service/addressbook/addressbook","service/auth","service/calls","service/cloud","service/compose","service/emoji","service/fishing","service/getModule","service/lastseenStrings","service/layer","service/mailbox/loader","service/notify","service/radars/decorator","service/radars/index","service/smokescreen","service/storage","service/viewer","tab-indexes","ui-block/button-link/button-link","ui-block/button2/button2","ui-block/focus-zone/focus-zone","ui-block/react-async/react-async"],function(require,exports,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_,aa,ba,ca){"use strict";Object.defineProperty(exports,"__esModule",{value:true});a=__importStar(a);b=__importDefault(b);c=__importDefault(c);g=__importDefault(g);h=__importDefault(h);j=__importDefault(j);k=__importDefault(k);o=__importDefault(o);p=__importDefault(p);q=__importDefault(q);r=__importDefault(r);s=__importDefault(s);t=__importDefault(t);x=__importDefault(x);y=__importDefault(y);z=__importDefault(z);A=__importDefault(A);B=__importDefault(B);C=__importDefault(C);D=__importDefault(D);E=__importDefault(E);F=__importDefault(F);G=__importDefault(G);H=__importDefault(H);I=__importDefault(I);J=__importDefault(J);K=__importDefault(K);L=__importDefault(L);M=__importDefault(M);N=__importDefault(N);O=__importDefault(O);P=__importDefault(P);Q=__importDefault(Q);R=__importDefault(R);S=__importDefault(S);T=__importDefault(T);U=__importDefault(U);V=__importStar(V);X=__importDefault(X);Y=__importDefault(Y);_=__importDefault(_);aa=__importDefault(aa);ba=__importDefault(ba);ca=__importDefault(ca);exports.default=k.default.Block.extend((0,U.default)({events:[{name:"send",rename:function(a){return a.is("schedule")?"send_scheduled":"send"},data:function(a){return a.get("form")}},{name:"collapse"},{name:"mount",data:function(a){return a.get("form")}},{name:"close",data:function(a){return a.get("form")}}],explicit:true})({name:"compose-app",template:o.default,isolateEvents:false,performanceTrace:true,mods:{letterHours:n.letterHours},blocks:{button2:aa.default,"button-link":_.default,"focus-zone":ba.default,"react-async":ca.default},notVisualAttributes:{closing:true},defaults:{focusoff:false,form:null,"send-delay":0,"has-changes":false,"draft-on-close-enabled":true,"draft-timeout":i.AUTOSAVE_DRAFT_TIMEOUT_SECONDS,"template-enabled":false,saving:false,sending:false,fullscreen:false,mobile:i.TOUCH_MODE,ponymode:false,adaptive:false,hidden:false,"expand-status":false,closing:false,"translate-mode":false,darkMode:false,extended:false,"support-extend":true,autosend:false,"is-drag-and-drop":false,"drag-and-drop-item":null,errors:null,receipt:false,priority:3,schedule:false,scheduleDate:new Date,collectors:[],aliases:[]},events:{send:"onSend",save:"_updateComposeFields",shortcut:"onShortcut","nav:draft":"onNavDraft","nav:template":"onNavTemplate","focus-zone:first":"onRequestFirstFocus","focus-zone:last":"onRequestLastFocus","translation:use":"onTranslationSave","translation:cancel":"onTranslationCancel","translation:retry":"onTranslationRetry","first-render":"onFirstRender"},attrChanged:{errors:function(a){this.errors=a;this.composeRender()},priority:function(a){var b=this.get("form");b.set("priority",a);this.set("has-changes",true)},receipt:function(a){var b=this.get("form");b.set("receipt",a);this.set("has-changes",true)},sending:function(a,b){if(a!==b&&!a){this.get("form").set("finalized",false)}this.composeRender()},ponymode:function(){this.composeRender()},darkMode:function(){this.composeRender()},extended:function(){this.composeRender()},"mobile-xxs":function(){this.composeRender()},"support-extend":function(){this.composeRender()},"expand-status":function(){this._updateComposeVisuals()},"window-mode":function(){this.composeRender()},hidden:function(a){if(!a){this._setupFocus()}},sendDate:function(a){if(a){this.set({schedule:a,scheduleDate:new Date(a*1e3)})}this.composeRender()},schedule:function(a){var b=this.get("form");if(a){b.set("send_date",(this.get("scheduleDate").getTime()+"").slice(0,-3))}else{b.set("send_date","")}this.composeRender();this.set("has-changes",true)},scheduleDate:function(a){var b=this;new Promise(function(a,b){require(["ui-react"],a,b)}).then(__importStar).then(function(c){if(!b.isMounted()){return}var d=c.default;var e=b.get("form");if(b.get("schedule")){e.set("send_date",(a.getTime()+"").slice(0,-3));b.set("scheduleText",d.getFullMomentFormat(a))}b.set("has-changes",true);b.composeRender()})},remind:function(a){var b=this.get("form");b.set("remind",a);this.set("has-changes",true)},"draft-on-close-enabled":function(a){this.setAutosaveOnClose(a)}},tabIndexes:Z.compose,constructor:function(a,b){k.default.Block.call(this,a,b);this.onWindowUnload=this.onWindowUnload.bind(this);this.composeRender=this.composeRender.bind(this);this._updateComposeVisuals=this._updateComposeVisuals.bind(this);this._setupFocus=this._setupFocus.bind(this);this._changeTranslateMode=this._changeTranslateMode.bind(this);this.emitter=new j.default;this.emitter.on("translate-mode",this._changeTranslateMode);this.emitter.on("translation-error",this.onTranslationError.bind(this));this.emitter.on("translation-ok",this.onTranslationOk.bind(this))},didMount:function(){(0,V.default)("on_route_compose");this.composeRender()},composeRender:function(){var j=this;var k=this.get("compose-options");var o=this.get("form");var q=J.default.user.get("signs");var s=J.default.user.getEmail();var u=J.default.user.get("name");var z="".concat(u.first," ").concat(u.last);if(i.LOG_EMPTY_COLLECTORS&&!this.get("collectors")){G.default.send("empty-cltrs-compose",{rlog:"empty-collectors",rlog_message:{collectors:typeof this.get("collectors"),place:"composeRender"}})}var D=(this.get("collectors")||[]).filter(function(a){return a.canSendLetters()});var I=this.get("aliases");var K=this.is("support-extend")?this.onExtend.bind(this):null;this.onClose=this.onClose.bind(this);this.onCollapse=this.onCollapse.bind(this);this.sendLetter=this.sendLetter.bind(this);this.onReadyToSave=this.onReadyToSave.bind(this);this.onFilesFromCloud=this.onFilesFromCloud.bind(this);this.onFilesFromMail=this.onFilesFromMail.bind(this);this.onCallsInvite=this.onCallsInvite.bind(this);this.onCallTo=this.onCallTo.bind(this);this.onContactsFromMail=this.onContactsFromMail.bind(this);this.openAddressbook=this.openAddressbook.bind(this);this.onSignatureFromMail=this.onSignatureFromMail.bind(this);this.onTemplateSelect=this.onTemplateSelect.bind(this);this.onSaveAsTemplate=this.onSaveAsTemplate.bind(this);this.onExceedMaxSize=this.onExceedMaxSize.bind(this);this.onComposeCreateTo=this.onComposeCreateTo.bind(this);this.onSearchFrom=this.onSearchFrom.bind(this);this.onContactAdd=this.onContactAdd.bind(this);this.onOpenAddressbook=this.onOpenAddressbook.bind(this);this.updateMailboxQuotas=this.updateMailboxQuotas.bind(this);this.lastSeenUpdate=this.lastSeenUpdate.bind(this);this.onSend=this.onSend.bind(this);this.onTranslationSave=this.onTranslationSave.bind(this);this.onTranslationCancel=this.onTranslationCancel.bind(this);this.onChangePriority=this.onChangePriority.bind(this);this.onChangeReceipt=this.onChangeReceipt.bind(this);this.onClickRemind=this.onClickRemind.bind(this);this.onChangeRemind=this.onChangeRemind.bind(this);this.onClickSchedule=this.onClickSchedule.bind(this);this.onChangeSchedule=this.onChangeSchedule.bind(this);this.onTranslationRetry=this.onTranslationRetry.bind(this);Promise.all([(0,w.lazyFileAPI)(),(0,w.lazyClipboard)(),M.default.preload(),new Promise(function(a,b){require(["ui-react"],a,b)}).then(__importStar)]).then(function(u){var w=u[0],G=u[1],M=u[2].ui,Q=u[3].default.PromtAboutAdWrapper;if(!j.isMounted()){return}var R=D.concat(I);j.compose=new M.default(j.refs.compose);j.compose.injectDependencies(__assign(__assign({Attachment:B.default,cloud:L.default,Alias:A.default,Collector:C.default,CloudEntry:h.default,Message:E.default,MessageFormData:F.default,FileAPI:w,RPC:H.default,ContactSuggests:y.default,checkContactsPossessing:e.checkContactsPossessing,Phishing:O.default},i.PROMT_LOGO_WITH_AD_DROPDOWN&&{PromtAboutAdWrapper:Q}),{Clipboard:G,TabIndex:Z.compose,browser:p.default,features:{CKE_ENABLE_TAB:i.CKE_ENABLE_TAB,CKE_DEFAULT_STYLES:i.CKE_DEFAULT_STYLES,CKE_ATTACH_BASE64:i.CKE_ATTACH_BASE64,CKE_CLIPBOARD_FIX:i.CKE_CLIPBOARD_FIX,CKE_AUTOCORRECT_AFTER_DELETE_CONTENTS_DISABLED:i.CKE_AUTOCORRECT_AFTER_DELETE_CONTENTS_DISABLED,CKE_AUTOCORRECT_ALPHABET_LIST:i.CKE_AUTOCORRECT_ALPHABET_LIST,CKE_QUOTE_PARSE_FIX_DISABLE:i.CKE_QUOTE_PARSE_FIX_DISABLE,COMPOSE_EMOJI:i.COMPOSE_EMOJI,COMPOSE_EMOJI_FILTER:i.COMPOSE_EMOJI_FILTER,COMPOSE_EMOJI_RECENTLY_COUNT:i.COMPOSE_EMOJI_RECENTLY_COUNT,COMPOSE_SLIDER_LAST_STEP_DELTA:i.COMPOSE_SLIDER_LAST_STEP_DELTA,COMPOSE_TRANSLATOR:i.COMPOSE_TRANSLATOR,COMPOSE_ENABLE_TABLES:i.COMPOSE_ENABLE_TABLES,CORRESPONDENTS_LIMIT:i.CORRESPONDENTS_LIMIT,DISABLE_CALLS_COMPOSE_TIP:i.DISABLE_CALLS_COMPOSE_TIP,DISABLE_CLOUD:i.COMPOSE_DISABLE_CLOUD_ATTACHES,DISABLE_FROM_MAIL_ATTACHES:i.DISABLE_FROM_MAIL_ATTACHES,EMOJI_FALLBACK:i.EMOJI_FALLBACK,ENABLE_WYSIWYG_STICKY:i.ENABLE_WYSIWYG_STICKY,EXPIRED_ATTACHES_TOOLTIP:i.EXPIRED_ATTACHES_TOOLTIP,IS_NEW_ADDRESSBOOK:i.IS_NEW_ADDRESSBOOK,LETTER_TO_YOURSELF:i.LETTER_TO_YOURSELF,NEW_AB_SUGGEST:i.NEW_AB_SUGGEST,TRANSLATOR_REQUEST_TIMEOUT:i.TRANSLATOR_REQUEST_TIMEOUT,MAX_CLOUD_STOCK_SIZE_LIMIT:i.MAX_CLOUD_STOCK_SIZE_LIMIT,OVERSIZE_CLOUD_ATTACHES:i.OVERSIZE_CLOUD_ATTACHES,OVERSIZE_CLOUD_ATTACHES_FOLDER:i.OVERSIZE_CLOUD_ATTACHES_FOLDER,VK:i.VK,MESSAGES_ATTACHES_BLOBCLOUD:i.MESSAGES_ATTACHES_BLOBCLOUD,MESSAGES_ATTACHES_BLOBCLOUD_PATH:i.MESSAGES_ATTACHES_BLOBCLOUD_PATH,LASTSEEN_ONLINE_STATUS:i.LASTSEEN_ONLINE_STATUS,TOUCH_MODE:i.TOUCH_MODE,COMPOSE_FETCH_AUTOREPLY:i.COMPOSE_FETCH_AUTOREPLY,ENABLE_MENTIONS:i.ENABLE_MENTIONS,MENTIONS_MARK:i.MENTIONS_MARK,WEBVIEW:i.WEBVIEW,WEBVIEW_MOBILE_MODE_ENABLED:i.WEBVIEW_MOBILE_MODE_ENABLED,B2B_INNER_ATTACHMENTS_NOTIFY:i.B2B_INNER_ATTACHMENTS_NOTIFY,FAKE_BUTTON_TYPE:i.FAKE_BUTTON_TYPE,FAKE_NOTE_IN_CONTACTS:i.FAKE_NOTE_IN_CONTACTS,FAKE_BUTTON_DISCUSS_DOCUMENT:i.FAKE_BUTTON_DISCUSS_DOCUMENT,FAKE_BUTTON_SIGNING:i.FAKE_BUTTON_SIGNING,FAKE_GOS_TEMPLATE_SUGGESTION:i.FAKE_GOS_TEMPLATE_SUGGESTION,CREATE_NOTE_FROM_COMPOSE:i.CREATE_NOTE_FROM_COMPOSE,NOTES_URL:i.NOTES_URL},ContactValidation:a,radar:(0,V.createConfiguredRadar)({prefix:"cmps",data:o}),onError:function(a,b){(0,P.default)("trackJS").then(function(c){return c.addErrorFromApp(a,b?"cmps_".concat(b):"cmps_internal_caught")})},logger:x.default,scrollbarWidth:t.default,Storage:X.default,mods:{fileSize:m.fileSize,fileSizeRange:m.fileSizeRange,fileCount:l.fileCount,letterAttachLinkDate:n.letterAttachLinkDate},flags:c.default,emojiParser:N.default}));var S=b.default.get("isNativeStickyDisabled");var T=b.default.get("compose-expand-contacts");var U=j.get("router");j.compose.render({signatures:q,fromOptions:R,defaultEmail:s,userName:z,model:o,scrollTarget:j.refs.compose,templatesFetch:j.templatesFetch,lastSeenUpdate:j.lastSeenUpdate,suggestFinder:j.getSuggestFinder(),onFilesFromCloud:j.onFilesFromCloud,onFilesFromMail:j.onFilesFromMail,onCallsInvite:i.CALLS&&!i.CALLS_DISABLE_COMPOSE_BTN?j.onCallsInvite:null,onCallTo:i.CALLS?j.onCallTo:undefined,onContactsFromMail:j.onContactsFromMail,onSignatureFromMail:j.onSignatureFromMail,onReadyToSave:j.onReadyToSave,onClose:j.onClose,onExtend:K,fetchAutoreply:d.fetchAutoreply,fetchLastSeen:f.fetchLastSeen,onComposeCreateTo:j.onComposeCreateTo,onSearchFrom:j.onSearchFrom,onTemplateSelect:j.onTemplateSelect,onSaveAsTemplate:j.onSaveAsTemplate,onExceedMaxSize:j.onExceedMaxSize,onCollapse:j.onCollapse,onContactAdd:j.onContactAdd,onOpenAddressbook:j.onOpenAddressbook,onOversizeAttachAdd:r.default,onAttachmentClick:function(a){if(i.DISABLE_COMPOSE_ATTACHMENT_CLICK){return}var b=a.isCloudStock()&&!i.VIEWER_ATTACH_TEMP_CLOUDSTOCK;var c=a.isCloud()&&!i.VIEWER_ATTACH_TEMP_CLOUD;if(b||c){return}Y.default.openTemporary({messageId:o.uid,formData:o,router:U,attachment:a})},updateMailboxQuotas:j.updateMailboxQuotas,isNativeStickyDisabled:S&&S.state,isNativeAttachThumbRotation:i.IS_COMPOSE_NATIVE_ATTACH_THUMB_ROTATION,isAllVisibleContactsFeature:T&&T.state,onChangeErrors:j.onChangeErrors,sendLetter:j.sendLetter,errors:j.errors||null,disableInterface:j.get("window-mode")==="collapsed"?true:j.get("sending"),eventEmitter:j.emitter,darkMode:j.get("darkMode"),extended:j.get("extended"),compressedMode:j.get("ponymode")&&!j.get("mobile-xxs"),isTouch:j.get("mobile"),mobilePhoneLayout:j.get("mobile-xxs"),qaParams:{enabled:g.default.get("qa")},additionalOptions:k,utils:{isCyrillic:v.isCyrillic},schedule:j.get("schedule"),scheduleText:j.get("scheduleText"),onSend:j.onSend.bind(j),onSave:j.onClickSave.bind(j),onTranslationUse:j.onTranslationSave,onTranslationCancel:j.onTranslationCancel,onChangePriority:j.onChangePriority,onChangeReceipt:j.onChangeReceipt,onClickRemind:j.onClickRemind,onChangeRemind:j.onChangeRemind,onClickSchedule:j.onClickSchedule,onChangeSchedule:j.onChangeSchedule,onTranslationRetry:j.onTranslationRetry,onFooterChooseTemplateClick:j.onFooterChooseTemplateClick.bind(j),onCreateNoteFromLetter:j.onCreateNoteFromLetter.bind(j),translationHref:j.getPromtLogoHref(),avatarBaseUrl:g.default.get("urls.avatarUrl"),quotasEnabled:J.default.user.get("common_purpose_flags.enabled_mbox_quotas"),hideAvatar:i.COMPOSE_HIDE_AVATAR&&j.get("mobile-xxs"),unclickableLabels:i.COMPOSE_DISABLE_CLICKABLE_LABELS&&j.get("mobile-xxs"),hideToolbar:i.COMPOSE_DISABLE_TOOLBAR&&j.get("mobile-xxs"),shortAttachPanel:i.COMPOSE_SHORT_ATTACH_PANEL&&j.get("mobile-xxs"),hideChangeSignature:i.HIDE_CHANGE_SIGNATURE&&j.get("mobile-xxs"),hideCancelButton:i.HIDE_COMPOSE_CANCEL_BUTTON&&j.get("mobile-xxs"),hideWidgets:i.HIDE_COMPOSE_WIDGETS&&j.get("mobile-xxs"),footerDropdown:i.COMPOSE_FOOTER_DROPDOWN&&j.get("mobile-xxs")});if(!j.hasRendered){j.broadcast("first-render");j.hasRendered=true}})},onFirstRender:function(){var a=this;if(this.get("is-drag-and-drop")){var b=this.get("drag-and-drop-item");if(b){var c=b.files;if(this.compose.appComponent){this.compose.appComponent.addFilesToModel(c).then(function(b){if(a.get("autosend")){a.broadcast("send")}a.compose.appComponent.uploadFiles(b)}).catch(function(b){a.radar("dnd_err_".concat(b))})}}}},onContactAdd:function(a){a.scope="compose-notify";this.broadcast("addressbook:addcontact",a)},onOpenAddressbook:function(a){this.openAddressbook({"free-space":false,composeMode:false,openEmail:a.email},true)},onChangeErrors:function(a){this.errors=a},onSend:function(){var a=this.get("form");this._updateComposeFields();a.set("body.html",(0,u.cleanHTMLSignature)(a.get("body.html")),{silent:true});var b=this.get("autosend");var c=b?true:this.compose.appComponent.checkSend();if(c){this.sendLetter()}},getSuggestFinder:function(){if(i.NEW_AB_SUGGEST){return null}return I.default.lazyInit()},lastSeenUpdate:function(a){if(!i.LAST_SEEN_V2_ENABLE){return null}var b=this.get("getLastSeen");G.default.send("lastseen-v2-compose",{skipdwh:true});var c=i.LASTSEEN_COMPOSE_ALLOW_GARAGE;return b(a,{allowUseGarage:c}).then(function(b){var c=b.payload;var d=a.map(function(a){var b=c[a];return(0,Q.default)(b).then(function(b){return{email:a,lastSeen:b}})});return Promise.all(d)})},sendLetter:function(){if(this.get("schedule")){this.broadcast("letter-schedule",{composeApp:this,scheduleText:this.get("scheduleText")})}else{this.broadcast("letter-send")}},templatesFetch:function(){return S.default.load({folder:D.default.TEMPLATES,limit:25}).catch(function(){return{threads:[]}}).then(function(a){return a.threads.map(function(a){var b=a.subject||a.snippet;return{data:{folder:a.folder,id:a.expand,value:b.trim()?b:"<".concat(i18n("Без темы"),">")}}})})},onTemplateSelect:function(a){var b=this;var c=a.id,d=a.folder;var e=this.get("form");e.fetchTemplate({id:c,folder:d}).then(function(a){if(e.is("source.reply")||e.is("source.forward")){var c=e.mergeTemplate(a,{attachments:true});b.compose.applyTemplate(c)}else{b.broadcast("close",Object.assign(b,{noAnimate:true}));M.default.open({mode:"template",model:a})}})},didUnmount:function(){this.setAutosaveInterval(false);this.setAutosaveOnClose(false);try{this.compose.unmount()}catch(a){if(i.IS_DEBUG){console.error(a)}(0,V.default)({type:"compose_unmount_error",rlog:"octavius_jserror",rlog_message:JSON.stringify(a)})}},removeScheduleFromDatalist:function(a){var b=this.get("router");b.model.letters.filter(function(b){var c=b.getFolder();return c.isOutbox()&&b.get("last")===a}).forEach(function(a){b.model.letters.remove(a)})},removeSchedule:function(){var a=this;var b=this.get("form");var c=b.get("source.schedule");var d=b.get("source.draft");var e={id:c};if(d){e.source={draft:d}}z.default.execute({method:z.default.REMOVE,data:e}).then(function(){b.set("source.schedule","");b.set("source.draft",c);a.radar("remove_schedule");a.removeScheduleFromDatalist(c)}).catch(function(){a.radar("remove_schedule_error")})},onClickSave:function(){this._updateComposeFields();this.broadcast("letter-save")},onCreateNoteFromLetter:function(){this._updateComposeFields();this.broadcast("create-note-from-letter")},onClickSchedule:function(a){var b=!this.get("schedule");var c=new Date(a);if(!b){c=new Date}this.set({schedule:b,scheduleDate:c});if(!b){this.removeSchedule()}this.composeRender()},onChangeSchedule:function(a){this.set({schedule:true,scheduleDate:new Date(a)})},onChangePriority:function(){this.set({priority:this.get("priority")===3?1:3})},onChangeReceipt:function(){this.set({receipt:!this.get("receipt")})},onClickRemind:function(a){var b=!!this.get("remind");this.set({remind:b?"":a})},onChangeRemind:function(a){this.set({remind:a})},onRequestFirstFocus:function(){var a=this.el.querySelector((0,W.selector)('[tabindex="'.concat(Z.compose.INPUT_SUBJECT,'"]')));a&&a.focus()},onRequestLastFocus:function(){var a=this.el.querySelector((0,W.selector)('[tabindex="'.concat(Z.compose.BUTTON_ATTACH_CLOUD,'"]')));a&&a.focus()},layerSingleton:function(a,b,c,d,e){var f=this;if(!this.activeLayer){this.activeLayer=new Promise(function(g,h){a.then(function(){if(!f.isMounted()){f.activeLayer=null;g();return}f.set("hidden",true);R.default.open(b,c,{dimmer:false,resolvable:true}).then(function(a){if(f.isMounted()){f.set("hidden",false)}return a}).then(function(a){if(e){return e(a)}return Promise.resolve(a)}).then(function(a){return g(a)}).catch(function(a){d(a);if(f.isMounted()){f.set("hidden",false)}if(i.IS_DEBUG){console.error(a)}f.activeLayer=null;h(a);return Promise.reject(a)}).then(function(){f.activeLayer=null})},h)})}return this.activeLayer},onFilesFromCloud:function(a){var b=a.attachments,c=a.selectLimit,d=a.freeSpace;(0,V.default)("compose_cloud_click");return this.layerSingleton(new Promise(function(a,b){require(["ui-block/layer-explorer-from-cloud/layer-explorer-from-cloud"],a,b)}).then(__importStar),"explorer-from-cloud",{attachments:b,"select-limit":c,"free-space":d},function(){return(0,V.default)("explorer-cloud_error")})},onFooterChooseTemplateClick:function(){var a="compose-template-select";var b={fetchTemplates:this.templatesFetch,onChoose:this.onTemplateSelect};require(["ui-block/layer-compose-template-select/layer-compose-template-select"],function(){R.default.open(a,b,{dimmer:false,resolvable:true,mobile:true})})},onContactsFromMail:function(a){var b=a.contacts,c=a.selectLimit,d=a.freeSpace;(0,V.default)("compose_contacts-search_click");var e=i.NEW_AB_COMPOSE_VIEW;return this.openAddressbook({contacts:b,"select-limit":c,"free-space":d,composeMode:e},i.NEW_AB_COMPOSE_VIEW)},openAddressbook:function(a){return this.layerSingleton(new Promise(function(a,b){require(["ui-block/layer-addressbook/layer-addressbook"],a,b)}).then(__importStar),"addressbook",__assign(__assign({},a),{router:this.get("router")}),function(){return(0,V.default)("new-addressbook-layer_error")})},onFilesFromMail:function(a){var b=a.attachments,c=a.selectLimit,d=a.freeSpace;(0,V.default)("compose_filesearch_click");return this.layerSingleton(new Promise(function(a,b){require(["ui-block/layer-explorer-from-filesearch/layer-explorer-from-filesearch"],a,b)}).then(__importStar),"explorer-from-filesearch",{attachments:b,"select-limit":c,"free-space":d},function(){return(0,V.default)("explorer-files_error")})},onCallTo:function(a){K.default.getCallsAPIClient().callTo([a]).then(function(a){if(a.redirectUrl){(0,s.default)(a.redirectUrl)}}).catch(function(a){x.default.add("onCallTo_compose_error",a);(0,V.default)({type:"onCallTo_compose_error",rlog:"onCallTo_compose_error",rlog_message:a})})},onCallsInvite:function(){return new Promise(function(a){K.default.createRoom().then(function(b){var c=K.default.getTemplate(b);a(c)}).catch(function(){T.default.error({text:i18n("Не удалось создать ссылку на звонок")},"compose-notify")})})},onSignatureFromMail:function(){(0,V.default)("compose_sign-edit_click");(0,s.default)(i.SIGNATURE_URL)},onWindowUnload:function(a){if(this.is("has-changes")||this.isUploadingAttachments()){var b=i18n("Текст письма будет потерян.");var c=Date.now();setTimeout(function(){var a=Date.now()-c;if(a<100){(0,G.default)("compose_unload_confirm_disabled&v=".concat(a),{immediately:true});x.default.add("compose_unload_confirm_disabled",{unloadConfirmDuration:a})}},0);(0,V.default)("compose_try_leave_with_unsaved");x.default.add("try to leave compose with unsaved changes");a.returnValue=b;return b}},onClose:function(){this.set("closing",true);if(this.is("translate-mode")){this.broadcast("save")}this.broadcast("close")},onExtend:function(){this.broadcast("extend")},onCollapse:function(){this._updateComposeFields();this.broadcast("collapse")},_updateComposeFields:function(){this.compose.updateFields()},_updateComposeVisuals:function(){if(this.compose){this.compose.updateVisuals()}},_setupFocus:function(){if(this.compose){this.compose.setupFocus()}},onSaveAsTemplate:function(){var a=this;this._updateComposeFields();return new Promise(function(b){a.broadcast("savetemplate",{composeApp:a,resolve:b})})},onExceedMaxSize:function(){this.broadcast("exceedmaxsize")},onAutoSave:function(){if(!this.isMounted()){this.setAutosaveInterval(false);return}if(this.get("saving")){return}this._updateComposeFields();this.broadcast("autosave")},onReadyToSave:function(){this.set("has-changes",true);this.setAutosaveInterval(true)},onShortcut:function(a){var b=a.originalEvent;var c=false;var d=b;var e=d.metaKey||d.ctrlKey;if(e&&d.keyCode==13){(0,V.default)("compose_action_send_shortcut");this.broadcast("send")}if(e&&(0,q.default)(d.keyCode)==="s"){(0,V.default)("compose_action_save_shortcut");this.broadcast("save");c=true}c&&d.preventDefault();return!!c},onNavDraft:function(){this.broadcast("collapse");this.get("router").go("#letters",{folder:D.default.DRAFTS})},onNavTemplate:function(){this.broadcast("collapse");this.get("router").go("#letters",{folder:D.default.TEMPLATES})},onTranslationOk:function(){this.get("form").set({"translation-error":null,"translation-first-ok":true})},onTranslationError:function(a){var b="some-error";if(a.status===Number(H.default.statuses.many_requests)){b="many-requests"}var c=this.showTranslationNotify("error");this.emitter.one("translation-ok",function(){c===null||c===void 0?void 0:c.close()});this.get("form").set("translation-error",b)},onTranslationCancel:function(){this.compose.disableTranslate(false);this.get("form").clearTranslation()},onTranslationSave:function(){var a=this;this.compose.disableTranslate(true);var b=this.showTranslationNotify("saved");this.emitter.one("translate-mode",function(a){a&&(b===null||b===void 0?void 0:b.close())});b===null||b===void 0?void 0:b.on("action",function(){a.compose.revertTranslation();b.close()})},onTranslationRetry:function(){this.compose.translate()},showTranslationNotify:function(a){var b="";var c=T.default.types.default;var d=[];if(a==="ok"){b=i18n("Переведено")}if(a==="loading"){b=i18n("Переводим...")}if(a==="error"){b=i18n("Не удалось перевести текст");c=T.default.types.error}if(a==="saved"){b=i18n("Вы перевели письмо");d=[{text:i18n("Отменить")}]}var e={text:b,type:c,actions:d,unique:true};return T.default.add(e,"compose-notify")},_changeTranslateMode:function(a){this.get("form").set({"translate-mode":a,"translation-first-ok":false})},onComposeCreateTo:function(a){this._updateComposeFields();this.broadcast("collapse",Object.assign(this,{noAnimate:true}));M.default.open({correspondents:{to:[a]}})},onSearchFrom:function(a){this._updateComposeFields();this.broadcast("collapse");this.get("router").go("#search",{},{q_from:a})},setAutosaveInterval:function(a){if(!a){clearTimeout(this._saveDraftTimeoutId);this._saveDraftTimeoutId=void 0;if(i.IS_DEBUG){console.warn("[compose-app]","Таймер автосохранения остановлен.")}return}if(!this.isMounted()){if(i.IS_DEBUG){console.warn("[compose-app]","Не удалось запустить таймер автосохранения: компонент не в DOM!")}return}if(!this._saveDraftTimeoutId){var b=this.get("draft-timeout")*1e3;this._saveDraftTimeoutId=setInterval(this.onAutoSave.bind(this),b);if(i.IS_DEBUG){console.warn("[compose-app]","Запущен таймер автосохранения. Таймаут",b,"мс")}}},setAutosaveOnClose:function(a){if(!a){window.removeEventListener("beforeunload",this.onWindowUnload);return}window.addEventListener("beforeunload",this.onWindowUnload)},getDraftUrl:function(){return this.get("router").getUrl("#letters",{folder:D.default.DRAFTS})},getTemplateUrl:function(){return this.get("router").getUrl("#letters",{folder:D.default.TEMPLATES})},isUploadingAttachments:function(){var a=this.get("form");return a.isUploadingAttachments()},insertHtml:function(a){if(this.compose.appComponent){this.compose.appComponent.insertHtml(a)}},updateMailboxQuotas:function(a,b){J.default.user.set("mbox_quotas.".concat(a),b);if(a==="attach"){this.get("form").resetSpaceLeft()}},getPromtLogoHref:function(){return i.PROMT_LOGO_HREF}}))});define("feast-tpl!app/feast-tpl!ui-block/compose-windows/compose-windows.html",["feast"],function(a){return a.smartParse('<div>\n\t<fn:var name="visible" value="{attrs.items.length > 0}"/>\n\t<fn:var name="collapsedCnt" value="{attrs.items.length - (attrs.active ? 1 : 0)}"/>\n\t<fn:var name="rise" value="{attrs.rise}"/>\n\n\t<bem:mod name="hidden" test="!visible"/>\n\t<bem:mod name="fullscreen" test="attrs.fullscreen"/>\n\t<bem:mod name="rise" test="rise"/>\n\n\t<bem:mod name="animate-open" test="attrs[\'animate-open\']"/>\n\t<bem:mod name="animate-close" test="attrs[\'animate-close\']"/>\n\t<bem:mod name="animate-expand" test="attrs[\'animate-expand\']"/>\n\t<bem:mod name="animate-collapse" test="attrs[\'animate-collapse\']"/>\n\n\t<bem:mod name="show-mobile-footer" test="attrs[\'show-mobile-footer\']"/>\n\n\t<bem:mod name="new-toolbar" test="_this.useNewToolbar()"/>\n\n\t<fn:if test="visible">\n\t\t<b:dimmer fn:if="attrs.active"\n\t\t\t\t  remit:click="window-collapse"\n\t\t\t\t  event:details="false"\n\t\t/>\n\n\t\t<fn:for data="attrs.items" as="item">\n\t\t\t<b:compose-app\n\t\t\t\t\tuse:mediator="compose-manager addressbook-manager themes-manager"\n\t\t\t\t\tkey="compose-{item.formData.uid}"\n\t\t\t\t\tid="{\'compose-\' + item.formData.uid}"\n\t\t\t\t\tform="{item.formData}"\n\t\t\t\t\twindow-mode="{attrs.active == item.formData.uid ? \'window\' : \'collapsed\'}"\n\t\t\t\t\texpand-status="{attrs.active == item.formData.uid && attrs[\'expand-status\']}"\n\t\t\t\t\trouter="{attrs.router}"\n\t\t\t\t\tpriority="{item.formData.get(\'priority\')}"\n\t\t\t\t\treceipt="{item.formData.get(\'receipt\')}"\n\t\t\t\t\tremind="{item.formData.get(\'remind\')}"\n\t\t\t\t\tsendDate="{item.formData.get(\'send_date\')}"\n\t\t\t\t\tcollectors="{_this._getCollectors()}"\n\t\t\t\t\taliases="{_this._getAliases()}"\n\t\t\t\t\tadaptive="{attrs.adaptive}"\n\t\t\t\t\tfullscreen="{attrs.fullscreen}"\n\t\t\t\t\tmobile-xxs="{attrs[\'mobile-xxs\']}"\n\t\t\t\t\tponymode="{attrs.ponymode}"\n\t\t\t\t\tsupport-extend="{attrs[\'support-extend\']}"\n\t\t\t\t\textended="{attrs.extended}"\n\t\t\t\t\tcompose-options="{item.additionalOptions}"\n\t\t\t\t\tautosend="{item.autosend}"\n\t\t\t\t\tsaving="{item.formData.isSaving}"\n\t\t\t\t\tis-drag-and-drop="{item.isDragAndDrop}"\n\t\t\t\t\tdrag-and-drop-item="{item.dragAndDropItem}"\n\t\t\t\t\tremit:open="window-open"\n\t\t\t\t\tremit:close="window-close"\n\t\t\t\t\tremit:collapse="window-collapse"\n\t\t\t\t\tremit:extend="window-extend"\n\t\t\t\t\tremit:autosave="letter-autosave"\n\t\t\t\t\tremit:savetemplate="letter-savetemplate"\n\t\t\t\t\tremit:exceedmaxsize="letter-exceedmaxsize"\n\t\t\t/>\n\t\t</fn:for>\n\n\t\t<b:compose-collapsed\n\t\t\t\tfn:if="collapsedCnt"\n\t\t\t\titems="{_this.getCollapsed(attrs.items)}"\n\t\t\t\tmultiple="{false}"\n\t\t\t\tmobile="{attrs.active && attrs.overlap}"\n\t\t\t\tcompact="{_this.isCompactCollapsed()}"\n\t\t\t\tabove-paginator="{_this.isAbovePaginator() && !_this.isCompactCollapsed()}"\n\t\t/>\n\t</fn:if>\n\n\t<div bem:elem="notify"\n\t\t qa:id="compose-notify-stack"\n\t\t qa:state="rise:{rise}">\n\t\t<b:notify-stack ref="compose-notify" id="compose-notify" fixed />\n\t</div>\n</div>\n',"app/feast-tpl!ui-block/compose-windows/compose-windows.html")});define("feast-tpl!ui-block/compose-windows/compose-windows.html",["feast-tpl!app/feast-tpl!ui-block/compose-windows/compose-windows.html"],function(a){return a});define("helpers/autocomplete",["exports"],function(exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=function(a,b){var c=document.createElement("iframe");c.setAttribute("name","autocomplete_iframe");c.style.display="none";document.body.appendChild(c);var d=document.createElement("form");d.setAttribute("target","autocomplete_iframe");d.setAttribute("action","about:blank");d.style.position="absolute";d.style.top="-9999px";d.setAttribute("tabindex","-1");document.body.appendChild(d);var e=document.createElement("input");e.setAttribute("name",a);e.setAttribute("value",b);e.setAttribute("type","text");d.appendChild(e);if(d.requestSubmit&&typeof d.requestSubmit==="function"){d.requestSubmit()}else{d.submit()}var f=function a(){d.remove();c.removeEventListener("load",a);c.remove()};c.addEventListener("load",f)}});define("helpers/email-length-postfix",["exports"],function(exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getEmailLengthPostfix=a;function a(a){switch(true){case a<100:{return"0"}case a<500:{return"100"}case a<1e3:{return"500"}case a<1e4:{return Math.floor(a/1e3)+"k"}case a<15e3:{return"10k"}case a<2e4:{return"15k"}case a<25e3:{return"20k"}case a<3e4:{return"25k"}case a<1e5:{return"30k"}case a<5e5:{return"100k"}case a<1e6:{return"500k"}case a<5e6:{return"1m"}case a<1e7:{return"5m"}default:{return Math.floor(a/1e6)+"m"}}}});define("helpers/user-track",["exports","default-values"],function(exports,a){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function b(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++){c[b]=a[b]}return c}else{return Array.from(a)}}function c(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}var d=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||false;d.configurable=true;if("value"in d)d.writable=true;Object.defineProperty(a,d.key,d)}}return function(b,c,d){if(c)a(b.prototype,c);if(d)a(b,d);return b}}();var e={Alt:1,AltGraph:2,CapsLock:3,Control:4,Fn:5,Shift:6,Enter:7,Tab:8,Space:9,ArrowDown:10,ArrowLeft:11,ArrowRight:12,ArrowUp:13,End:14,Home:15,PageDown:16,PageUp:17,Escape:18,Backspace:19,Clear:20,Delete:21};var f={" ":"Space",Down:"ArrowDown",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Esc:"Escape",Del:"Delete"};var g={passive:true,capture:true};var h=function(){function h(){var b=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},d=b.limit,e=d===undefined?a.COMPOSE_SEND_USER_TRACK_CONF[0]:d,f=b.trackMouseInterval,g=f===undefined?a.COMPOSE_SEND_USER_TRACK_CONF[1]:f;c(this,h);this.limit=e;this.trackMouseInterval=g;this.reset();this.trackMouse=this.trackMouse.bind(this);this.onMouseMove=this.onMouseMove.bind(this);this.onClick=this.onClick.bind(this);this.onKeyDown=this.onKeyDown.bind(this)}d(h,[{key:"reset",value:function a(){this.composes={};this.active={};this.lastPointerSpeed=0;this.lastPointerPositionX=0;this.lastPointerPositionY=0;this.mouseTrackLastEventTimestamp=0;this.currentPointerPositionX=0;this.currentPointerPositionY=0;this.trackMouseIntervalObj=null;this.mouseCaptured=false;this.started=false}},{key:"addEvent",value:function a(c,d,e){var f=this.composes[c];if(!f||!this.active[c]){return}var g=Date.now();var h=Math.max(g-f.lastEventTimestamp,0);f.lastEventTimestamp=g;f.events.push([d,h].concat(b(e)).join("|"));if(f.events.length>this.limit){f.events.shift()}}},{key:"hasComposes",value:function a(){return Object.keys(this.active).reduce(function(a,b){return b?a+1:a},0)>0}},{key:"addEvents",value:function a(b,c){var d=this;Object.keys(this.active).forEach(function(a){d.addEvent(a,b,c)})}},{key:"serialize",value:function a(b){var c=this.composes[b];if(!c){return""}return c.events.join(";")}},{key:"trackMouse",value:function a(){var b=Date.now();if(this.mouseCaptured){var c=Math.max(b-this.mouseTrackLastEventTimestamp,1);var d=this.currentPointerPositionX-this.lastPointerPositionX;var e=this.currentPointerPositionY-this.lastPointerPositionY;this.lastPointerPositionX=this.currentPointerPositionX;this.lastPointerPositionY=this.currentPointerPositionY;var f=Math.ceil(Math.sqrt(d*d+e*e));var g=f/c;var h=(g-this.lastPointerSpeed)/c;this.lastPointerSpeed=g;g=Math.ceil(g);h=Math.ceil(h);if(f||g||h){this.addEvents("m",[f,g,h])}}this.mouseTrackLastEventTimestamp=b;this.trackMouseIntervalObj=window.setTimeout(this.trackMouse,this.trackMouseInterval)}},{key:"onMouseMove",value:function a(b){this.currentPointerPositionX=b.clientX;this.currentPointerPositionY=b.clientY;this.mouseCaptured=true}},{key:"onClick",value:function a(b){this.addEvents("c",[b.button,b.clientX,b.clientY])}},{key:"onKeyDown",value:function a(b){var c=b.key;if(f[c]){c=f[c]}if(e[c]){this.addEvents("k",[e[c]])}}},{key:"addCompose",value:function a(b){this.composes[b]={events:[],lastEventTimestamp:Date.now()}}},{key:"removeCompose",value:function a(b){delete this.composes[b];delete this.active[b];if(!this.hasComposes()){this.stopTracking()}}},{key:"startComposeTrack",value:function a(b){if(!this.composes[b]){this.addCompose(b)}this.active[b]=true;this.startTracking()}},{key:"pauseComposeTrack",value:function a(b){if(!this.composes[b]){this.addCompose(b)}this.active[b]=false;if(!this.hasComposes()){this.stopTracking()}}},{key:"startTracking",value:function a(){if(this.started){return}document.body.addEventListener("keydown",this.onKeyDown,g);document.body.addEventListener("click",this.onClick,g);document.body.addEventListener("mousemove",this.onMouseMove,g);this.trackMouse();this.started=true}},{key:"stopTracking",value:function a(){if(this.trackMouseIntervalObj){window.clearInterval(this.trackMouseIntervalObj)}document.body.removeEventListener("keydown",this.onKeyDown,g);document.body.removeEventListener("click",this.onClick,g);document.body.removeEventListener("mousemove",this.onMouseMove,g);this.reset()}}]);return h}();var i=new h;exports.default=i});var __spreadArray=this&&this.__spreadArray||function(a,b,c){if(c||arguments.length===2)for(var d=0,e=b.length,f;d<e;d++){if(f||!(d in b)){if(!f)f=Array.prototype.slice.call(b,0,d);f[d]=b[d]}}return a.concat(f||Array.prototype.slice.call(b))};var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("service/compose-validators",["require","exports","lazy.modules","mail/Message","service/smokescreen"],function(require,exports,a,b,c){"use strict";Object.defineProperty(exports,"__esModule",{value:true});b=__importDefault(b);var d={checkOnMissingAttach:function(b){if(b.get("source.forward")||b.attachments.length){return Promise.resolve(false)}return(0,a.lazyMailTextAnalyzer)().then(function(a){return a.hasAttachment(d.getEnteredText(b.get("body.html")))})},checkOnRettachToReply:function(a){var c=this;var d=a.get("source.reply");if(!d){return Promise.resolve({})}var e=a.get("folder_id");return b.default.findOne({id:d,folder_id:e}).then(function(b){var d=c._hasNewEmails(b,a);var e=c._hasAttachToReattach(b);return{hasNewAttach:d&&e,source:b}})},getEnteredText:function(a){var b=document.createElement("div");b.innerHTML=a;Array.prototype.forEach.call(b.querySelectorAll((0,c.selector)("blockquote")),function(a){a.parentNode&&a.parentNode.removeChild(a)});Array.prototype.forEach.call(b.querySelectorAll((0,c.selector)("br")),function(a){if(a.parentNode){a.parentNode.insertBefore(document.createTextNode("\n"),a);a.parentNode.removeChild(a)}});return b.innerHTML},_hasNewEmails:function(a,b){var c=a.get("correspondents");var d=__spreadArray(__spreadArray(__spreadArray(__spreadArray([],c.from,true),c.to,true),c.cc,true),c.bcc,true).map(function(a){return a.email});var e=b.get("correspondents");var f=__spreadArray(__spreadArray(__spreadArray([],e.to,true),e.cc,true),e.bcc,true).map(function(a){return a.email});return f.some(function(a){return!d.includes(a)})},_hasAttachToReattach:function(a){var b=a.get("attaches.list");var c=["text/calendar","application/ics"];var d=new RegExp(/.ics$/);return b.some(function(a){return!c.includes(a.get("content_type"))&&!d.test(a.get("name"))})}};exports.default=d});define("feast-tpl!app/feast-tpl!ui-block/compose-collapsed/compose-collapsed.html",["feast"],function(a){return a.smartParse('<div qa:id="compose-collapsed">\n\t<fn:var name="messages" value="{_this.getMessages()}"/>\n\n\t<bem:mod name="multiple" test="attrs.multiple"/>\n\t<bem:mod name="empty" test="!attrs.items.length"/>\n\t<bem:mod name="mobile" test="attrs.mobile"/>\n\t<bem:mod name="compact" test="attrs.compact"/>\n\t<bem:mod name="above-paginator" test="attrs[\'above-paginator\']"/>\n\n\t<fn:for data="attrs.items" as="item" key="formKey">\n\t\t<div bem:elem="item"\n\t\t\t key="compose-collapsed-{item.formData.uid}"\n\t\t\t remit:click="window-expand"\n\t\t\t event:details="item.formData"\n\t\t\t qa:id="compose-collapsed-item:{item.formData.uid}">\n\n\t\t\t<fn:var name="isLast" value="{formKey === attrs.items.length - 1}"/>\n\t\t\t<div bem:elem="content">\n\t\t\t\t<span\n\t\t\t\t\tbem:elem="label"\n\t\t\t\t\tpromo:id="{isLast ? \'compose-collapsed-label\' : \'\'}"\n\t\t\t\t>\n\t\t\t\t\t<span promo:id="{isLast ? \'compose-collapsed-icon\' : \'\'}">\n\t\t\t\t\t\t\x3c!-- in_viewport не работает на svg, поэтому нужен враппер для плашки --\x3e\n\t\t\t\t\t\t<b:ico\n\t\t\t\t\t\t\tname="compose"\n\t\t\t\t\t\t\tsize="s"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</span>\n\n\t\t\t\t\t<span bem:elem="title" qa:id="subject">\n\t\t\t\t\t\t<fn:value>\n\t\t\t\t\t\t\tattrs.multiple ?\n\t\t\t\t\t\t\t\ti18n(\'Черновики\') :\n\t\t\t\t\t\t\t\t(item.formData.get(\'subject\') || messages.draft(Object.fromEntries([[\'draftId\', formKey + 1]])))\n\t\t\t\t\t\t</fn:value>\n\t\t\t\t\t</span>\n\t\t\t\t</span>\n\n\t\t\t\t<div bem:elem="ico-close">\n\t\t\t\t\t<b:button2\n\t\t\t\t\t\tico="actions:close"\n\t\t\t\t\t\tsize="s"\n\t\t\t\t\t\tsecondary\n\t\t\t\t\t\tshort\n\t\t\t\t\t\tremit:click="collapsed-item-close"\n\t\t\t\t\t\tevent:details="item.formData"\n\t\t\t\t\t\tqa:id="close"\n\t\t\t\t\t\tcentered\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</fn:for>\n</div>\n',"app/feast-tpl!ui-block/compose-collapsed/compose-collapsed.html")});define("feast-tpl!ui-block/compose-collapsed/compose-collapsed.html",["feast-tpl!app/feast-tpl!ui-block/compose-collapsed/compose-collapsed.html"],function(a){return a});define("ui-block/compose-collapsed/compose-collapsed",["exports","feast","feast-tpl!./compose-collapsed.html","service/radars/decorator","ui-block/button2/button2","ui-block/ico/ico"],function(exports,a,b,c,d,e){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var f=k(a);var g=k(b);var h=k(c);var i=k(d);var j=k(e);function k(a){return a&&a.__esModule?a:{default:a}}exports.default=f.default.Block.extend((0,h.default)({events:[{name:"window-expand",rename:"expand"}]})({name:"compose-collapsed",blocks:{button2:i.default,ico:j.default},defaults:{compact:false,mobile:false},events:{},template:g.default,isolateEvents:false,getMessages:function a(){return{draft:function a(b){return i18n("Черновик {draftId}",b)}}}}))});define("feast-tpl!app/feast-tpl!ui-block/layer-sent-page/layer-sent-page.html",["feast"],function(a){return a.smartParse('<div qa:id="layer-sent-page">\n\t<fn:var name="message" value="{attrs.model}"/>\n\t<fn:var name="messageAttachments" value="{_this.getAttachments()}"/>\n\t<fn:var name="isReady" value="{_this.isReady()}"/>\n\t<fn:var name="slim" value="{attrs.slim}"/>\n\t<fn:var name="messages" value="{_this.getMessages()}"/>\n\t<fn:var name="timerValueText" value="{_this.get(\'delivery-cancel-timer-text\')}"/>\n\t<fn:var name="isNotifyVersion" value="{_this.get(\'is-notify-version\')}"/>\n\t<fn:var name="isDeliveryCancelVersion" value="{_this.get(\'is-delivery-cancel-version\')}"/>\n\t<fn:var name="cancellationResultText" value="{_this.get(\'cancellation-result-text\')}"/>\n\t<fn:var name="cancellationOver" value="{_this.get(\'is-cancellation-over\')}"/>\n\t<fn:var name="cancellationWithDraft" value="{_this.get(\'cancellation-with-draft\')}"/>\n\t<fn:var name="cancelShortcut" value="{_this.getCancelShortcut()}"/>\n\t<fn:var name="cancellationInProgress" value="{_this.get(\'is-cancellation-progress\')}"/>\n\t<fn:var name="isLetterCanceled" value="{_this.get(\'is-letter-canceled\')}"/>\n\t<fn:var name="openDraftFail" value="{_this.get(\'open-draft-fail\')}"/>\n\n\t<bem:mod name="slim" test="slim"/>\n\t<bem:mod name="mobile" test="attrs.mobile"/>\n\n\t\x3c!-- Поле Кому --\x3e\n\t<fn:match name="correspondents" args="contactString, dir">\n\t\t<fn:var name="contacts" value="{_this.getContactList(contactString)}"/>\n\t\t<fn:var name="contactList" value="{contacts}"/>\n\n\t\t<fn:for data="contactList" as="contact" key="contactKey">\n\t\t\t<fn:var name="key" value="{_this.getContactKey(contactKey, dir)}"/>\n\n\t\t\t<span\n\t\t\t\ttitle="{contact.email}"\n\t\t\t\tdata-id="{key}"\n\t\t\t\tbem:elem="contact-item"\n\t\t\t\tkey="{key}">\n\n\t\t\t\t<fn:value mod="correspondent">contact</fn:value>\n\t\t\t\t<fn:value>contactKey === contactList.length - 1 ? \' \': \', \'</fn:value>\n\t\t\t</span>\n\t\t</fn:for>\n\t</fn:match>\n\n\t\x3c!-- Поле получателей --\x3e\n\t<fn:if test="!isDeliveryCancelVersion">\n\t\t<fn:match name="recipients" args="message, more, expanded">\n\t\t\t<div bem:elem="recipients">\n\t\t\t\t<bem:mod name="more" value="{more > 0}"/>\n\t\t\t\t<bem:mod name="expanded" value="{expanded}"/>\n\n\t\t\t\t<div bem:elem="recipients-container" ref="recipients">\n\t\t\t\t\t<span bem:elem="recipient" fn:if="message.get(\'correspondents.to.length\')">\n\t\t\t\t\t\t<span bem:elem="recipient-field">{i18n(\'Кому\')}: </span>\n\t\t\t\t\t\t<fn:apply-match name="correspondents" args="message.get(\'to\'), \'to\'"/>\n\t\t\t\t\t</span>\n\n\t\t\t\t\t<span bem:elem="recipient" fn:if="message.get(\'correspondents.cc.length\')">\n\t\t\t\t\t\t<span bem:elem="recipient-field">{i18n(\'Копия\')}: </span>\n\t\t\t\t\t\t<fn:apply-match name="correspondents" args="message.get(\'cc\'), \'cc\'"/>\n\t\t\t\t\t</span>\n\n\t\t\t\t\t<span bem:elem="recipient" fn:if="message.get(\'correspondents.bcc.length\')">\n\t\t\t\t\t\t<span bem:elem="recipient-field">{i18n(\'Скрытая\')}: </span>\n\t\t\t\t\t\t<fn:apply-match name="correspondents" args="message.get(\'bcc\'), \'bcc\'"/>\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\n\t\t\t\t<div\n\t\t\t\t\tbem:elem="recipients-more"\n\t\t\t\t\tfn:if="more > 0 && !expanded"\n\t\t\t\t\tremit:click="recipients-more:click">\n\t\t\t\t\t<fn:var name="contextMore" value="{Object.fromEntries([[\'more\', more]])}"/>\n\t\t\t\t\t<fn:value output="raw">messages.more(contextMore)</fn:value>\n\t\t\t\t</div>\n\n\t\t\t\t<div\n\t\t\t\t\tbem:elem="recipient-more"\n\t\t\t\t\tfn:if="more > 0 && expanded"\n\t\t\t\t\tremit:click="recipients-more:click">\n\t\t\t\t\t<span class="layer__link">{i18n(\'Свернуть\')}</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</fn:match>\n\t</fn:if>\n\n\t<fn:match name="controls" args="message, type" qa:id="controls">\n\t\t<div bem:elem="controls">\n\t\t\t<b:button2\n\t\t\t\tfn:if="type === \'error\'"\n\t\t\t\ttext="{i18n(\'Отправить ещё раз\')}"\n\t\t\t\tevent:details="message"\n\t\t\t\tremit:click="resend"\n\t\t\t\tqa:id="resend"\n\t\t\t/>\n\t\t\t<b:button2\n\t\t\t\tfn:if="type === \'error\'"\n\t\t\t\ttext="{i18n(\'Вернуться к письму\')}"\n\t\t\t\tevent:details="message"\n\t\t\t\tremit:click="compose-back"\n\t\t\t\tqa:id="compose-back"\n\t\t\t/>\n\n\t\t\t<fn:if test="isDeliveryCancelVersion">\n\t\t\t\t<div bem:elem="cancel">\n\t\t\t\t\t<fn:if test="!cancellationOver && !cancellationInProgress">\n\t\t\t\t\t\t<b:button2\n\t\t\t\t\t\t\ttext="{timerValueText}"\n\t\t\t\t\t\t\ttitle="{i18n(\'Отменить отправку\')}"\n\t\t\t\t\t\t\tremit:click="cancel"\n\t\t\t\t\t\t\tshortcut="ctrl+z|command+z"\n\t\t\t\t\t\t\tqa:id="cancel"\n\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t<p bem:elem="cancel-combination">{cancelShortcut}</p>\n\t\t\t\t\t</fn:if>\n\n\t\t\t\t\t<fn:if test="cancellationInProgress">\n\t\t\t\t\t\t<b:button2\n\t\t\t\t\t\t\ttext="{i18n(\'Идёт отмена отправки...\')}"\n\t\t\t\t\t\t\tqa:id="cancel-progress"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</fn:if>\n\n\t\t\t\t\t<fn:if test="cancellationOver && cancellationWithDraft && !openDraftFail">\n\t\t\t\t\t\t<b:button2\n\t\t\t\t\t\t\ttext="{i18n(\'Открываю черновик...\')}"\n\t\t\t\t\t\t\tqa:id="draft-progress"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</fn:if>\n\n\t\t\t\t\t<fn:if test="cancellationOver && cancellationWithDraft && openDraftFail">\n\t\t\t\t\t\t<b:button2\n\t\t\t\t\t\t\ttext="{i18n(\'Редактировать в черновике\')}"\n\t\t\t\t\t\t\tqa:id="draft-open-fail"\n\t\t\t\t\t\t\tremit:click="go-drafts"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</fn:if>\n\n\t\t\t\t\t<fn:if test="cancellationOver && !cancellationWithDraft">\n\t\t\t\t\t\t<b:button2\n\t\t\t\t\t\t\ttext="{i18n(\'Перейти во входящие\')}"\n\t\t\t\t\t\t\tremit:click="go-inbox"\n\t\t\t\t\t\t\tqa:id="go-inbox"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</fn:if>\n\t\t\t\t</div>\n\t\t\t</fn:if>\n\n\t\t\t<fn:if test="!isDeliveryCancelVersion">\n\t\t\t\t<fn:choose>\n\t\t\t\t\t\x3c!-- Шаблон сохраняется --\x3e\n\t\t\t\t\t<fn:when test="attrs[\'template-status\'] === \'saving\'">\n\t\t\t\t\t\t<b:spinner small color="gray"/>\n\t\t\t\t\t</fn:when>\n\n\t\t\t\t\t\x3c!-- Шаблон сохранили --\x3e\n\t\t\t\t\t<fn:when test="attrs[\'template-status\'] === \'saved\'">\n\t\t\t\t\t\t<span bem:elem="template-saved">\n\t\t\t\t\t\t\t<b:ico name="status:doneround"/>\n\t\t\t\t\t\t\t<span>{i18n(\'Шаблон сохранён\')}</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</fn:when>\n\n\t\t\t\t\t\x3c!-- Сохранение в шаблон не нажали --\x3e\n\t\t\t\t\t<fn:otherwise>\n\t\t\t\t\t\t<b:button2\n\t\t\t\t\t\t\ttext="{i18n(\'Сохранить в шаблон\')}"\n\t\t\t\t\t\t\tevent:details="message"\n\t\t\t\t\t\t\tremit:click="template"\n\t\t\t\t\t\t\tqa:id="template"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</fn:otherwise>\n\t\t\t\t</fn:choose>\n\t\t\t</fn:if>\n\t\t</div>\n\t</fn:match>\n\n\t\x3c!-- Ссылка на звонок --\x3e\n\t<fn:match name="calls" args="message, link">\n\t\t<div bem:elem="calls" qa:id="calls">\n\t\t\t<fn:var name="calls" value="{message.get(\'calls\')}"/>\n\n\t\t\t<fn:if test="calls.length === 1">\n\t\t\t\t<span>{i18n(\'Ссылка на видеозвонок:\')}</span>\n\t\t\t\t<a\n\t\t\t\t\tbem:elem="calls-link"\n\t\t\t\t\thref="{calls[0]}"\n\t\t\t\t\ttarget="_blank"\n\t\t\t\t\trel="noopener"\n\t\t\t\t\tremit:click="calls-link"\n\t\t\t\t\tqa:id="calls-link"\n\t\t\t\t>\n\t\t\t\t\t{calls[0]}\n\t\t\t\t</a>\n\t\t\t\t<span\n\t\t\t\t\tbem:elem="calls-ico"\n\t\t\t\t\tqa:id="copy"\n\t\t\t\t\tremit:click="calls-copy"\n\t\t\t\t\tref="callsLinkCopy"\n\t\t\t\t\ttitle="{i18n(\'Скопировать ссылку\')}"\n\t\t\t\t>\n\t\t\t\t\t<b:ico secondary name="actions:copy" size="s"/>\n\t\t\t\t</span>\n\t\t\t</fn:if>\n\n\t\t\t<fn:if test="calls.length > 1 && !!link">\n\t\t\t\t<span>{i18n(\'В письме есть несколько ссылок на звонки.\') }</span>\n\t\t\t\t<a\n\t\t\t\t\tbem:elem="calls-link"\n\t\t\t\t\tremit:click="calls-message-link"\n\t\t\t\t\thref="{link}"\n\t\t\t\t\trel="noopener"\n\t\t\t\t\tqa:id="calls-message-link"\n\t\t\t\t>\n\t\t\t\t\t{i18n(\'Перейти в письмо\')}\n\t\t\t\t</a>\n\t\t\t</fn:if>\n\t\t</div>\n\t</fn:match>\n\n\t\x3c!-- Поле аттачей --\x3e\n\t<fn:if test="!isDeliveryCancelVersion">\n\t\t<fn:match name="attachments" args="attachments, more, expanded">\n\t\t\t<div bem:elem="attachments" qa:id="attachments:{attachments.length}">\n\t\t\t\t<bem:mod name="more" value="{more > 0}"/>\n\t\t\t\t<bem:mod name="expanded" value="{expanded}"/>\n\n\t\t\t\t<div bem:elem="attachments-container" ref="attachments">\n\t\t\t\t\t<fn:for data="attachments" as="attach" key="attachKey">\n\t\t\t\t\t\t<fn:var name="key" value="{_this.getAttachKey(attachKey)}"/>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tkey="{key}"\n\t\t\t\t\t\t\tbem:elem="attach-item"\n\t\t\t\t\t\t\tdata-id="{key}">\n\t\t\t\t\t\t\t<b:attach-filename model="{attach}"/>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</fn:for>\n\t\t\t\t</div>\n\n\t\t\t\t<div\n\t\t\t\t\tbem:elem="attachments-more"\n\t\t\t\t\tfn:if="more > 0 && !expanded"\n\t\t\t\t\tremit:click="attachments-more:click">\n\t\t\t\t\t<fn:var name="contextMore" value="{Object.fromEntries([[\'more\', more]])}"/>\n\t\t\t\t\t<fn:value output="raw">messages.more(contextMore)</fn:value>\n\t\t\t\t</div>\n\n\t\t\t\t<div\n\t\t\t\t\tbem:elem="attachments-more"\n\t\t\t\t\tfn:if="more > 0 && expanded"\n\t\t\t\t\tremit:click="attachments-more:click">\n\t\t\t\t\t<span class="layer__link">{i18n(\'Свернуть\')}</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</fn:match>\n\t</fn:if>\n\n\t\x3c!-- Рекламный баннер --\x3e\n\t<fn:match name="banner">\n\t\t<div bem:elem="banner" ref="banner" qa:id="banner"></div>\n\t</fn:match>\n\n\t\x3c!-- Лейер не рисуем, если нужен только notify --\x3e\n\t<fn:if test="!isNotifyVersion">\n\t\t<fn:if test="!attrs.mobile">\n\t\t\t<b:layer\n\t\t\t\t\tremit:close="close"\n\t\t\t\t\thiddenfooter="{attrs[\'hide-ads\']}"\n\t\t\t\t\tclose\n\t\t\t\t\theader\n\t\t\t\t\tmedia\n\t\t\t\t\tcompose\n\t\t\t\t\twide="{!slim}"\n\t\t\t\t\tsize="{slim ? \'m\' : \'\'}"\n\t\t\t\t\tcenter>\n\n\t\t\t\t<fn:match name="header">\n\t\t\t\t\t<fn:if test="!attrs.error">\n\t\t\t\t\t\t<fn:if test="!isReady">\n\t\t\t\t\t\t\t<div qa:id="is-in-progress">\n\t\t\t\t\t\t\t\t{i18n(\'Письмо отправляется...\')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</fn:if>\n\t\t\t\t\t\t<fn:if test="isReady">\n\t\t\t\t\t\t\t<fn:choose>\n\t\t\t\t\t\t\t\t<fn:when test="attrs.isLateSent">\n\t\t\t\t\t\t\t\t\t<div qa:id="is-schedule-sent">\n\t\t\t\t\t\t\t\t\t\t{messages.lateSent}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</fn:when>\n\n\t\t\t\t\t\t\t\t<fn:otherwise>\n\t\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\t\t\tbem:elem="link"\n\t\t\t\t\t\t\t\t\t\t\thref="{attrs.link}"\n\t\t\t\t\t\t\t\t\t\t\tremit:click="link:click"\n\t\t\t\t\t\t\t\t\t\t\tqa:id="is-sent"\n\t\t\t\t\t\t\t\t\t\t\tfn:if="!isLetterCanceled"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{messages.sent}\n\t\t\t\t\t\t\t\t\t</a>\n\n\t\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\t\t\tbem:elem="link"\n\t\t\t\t\t\t\t\t\t\t\thref="{attrs.link}"\n\t\t\t\t\t\t\t\t\t\t\tremit:click="link:click"\n\t\t\t\t\t\t\t\t\t\t\tqa:id="is-canceled"\n\t\t\t\t\t\t\t\t\t\t\tfn:if="isLetterCanceled"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{cancellationResultText}\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</fn:otherwise>\n\t\t\t\t\t\t\t</fn:choose>\n\t\t\t\t\t\t</fn:if>\n\t\t\t\t\t</fn:if>\n\t\t\t\t\t<fn:if test="attrs.error">\n\t\t\t\t\t\t<div qa:id="error">\n\t\t\t\t\t\t\t{i18n(\'При отправке письма произошла ошибка\')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</fn:if>\n\t\t\t\t</fn:match>\n\t\t\t\t<fn:match name="content">\n\t\t\t\t\t<fn:if test="!isReady && !attrs.error">\n\t\t\t\t\t\t<b:spinner/>\n\t\t\t\t\t</fn:if>\n\n\t\t\t\t\t<fn:if test="isReady || attrs.error">\n\t\t\t\t\t\t<fn:apply-match\n\t\t\t\t\t\t\t\tname="recipients"\n\t\t\t\t\t\t\t\targs="message, attrs[\'recipients-more\'], attrs[\'recipients-expanded\']"/>\n\n\t\t\t\t\t\t<fn:apply-match\n\t\t\t\t\t\t\t\tname="calls"\n\t\t\t\t\t\t\t\tfn:if="!attrs[\'hide-calls\'] && message.get(\'calls\') && message.get(\'calls\').length"\n\t\t\t\t\t\t\t\targs="message, attrs.link"/>\n\n\t\t\t\t\t\t<fn:apply-match\n\t\t\t\t\t\t\t\tname="attachments"\n\t\t\t\t\t\t\t\tfn:if="messageAttachments && messageAttachments.length"\n\t\t\t\t\t\t\t\targs="messageAttachments, attrs[\'attachments-more\'], attrs[\'attachments-expanded\']"/>\n\n\t\t\t\t\t\t<fn:apply-match\n\t\t\t\t\t\t\t\tname="controls"\n\t\t\t\t\t\t\t\targs="message, attrs.error ? \'error\': \'ok\'"/>\n\t\t\t\t\t</fn:if>\n\t\t\t\t</fn:match>\n\t\t\t\t<fn:match name="footer">\n\t\t\t\t\t<fn:apply-match name="banner"/>\n\t\t\t\t</fn:match>\n\t\t\t</b:layer>\n\t\t</fn:if>\n\n\t\t<fn:if test="attrs.mobile">\n\t\t\t<b:layer-mobile media>\n\t\t\t\t<fn:match name="header">\n\t\t\t\t<span\n\t\t\t\t\t\tbem:elem="back"\n\t\t\t\t\t\tremit:click="layer:close">\n\t\t\t\t\t<b:button2 text="{i18n(\'Назад\')}"\n\t\t\t\t\t\t\t   ico="arrow-back"\n\t\t\t\t\t\t\t   pure\n\t\t\t\t\t\t\t   touch\n\t\t\t\t\t\t\t   short\n\t\t\t\t\t\t\t   text-center\n\t\t\t\t\t/>\n\t\t\t\t</span>\n\t\t\t\t\t<span bem:elem="title">\n\t\t\t\t\t<fn:choose>\n\t\t\t\t\t\t\t<fn:when test="attrs.isLateSent">\n\t\t\t\t\t\t\t\t{messages.lateSent}\n\t\t\t\t\t\t\t</fn:when>\n\t\t\t\t\t\t\t<fn:otherwise>\n\t\t\t\t\t\t\t\t{messages.sent}\n\t\t\t\t\t\t\t</fn:otherwise>\n\t\t\t\t\t\t</fn:choose>\n\t\t\t\t</span>\n\t\t\t\t</fn:match>\n\n\t\t\t\t<fn:match name="content">\n\t\t\t\t\t<fn:apply-match\n\t\t\t\t\t\t\tname="recipients"\n\t\t\t\t\t\t\targs="message, 0, true"/>\n\n\t\t\t\t\t<fn:apply-match\n\t\t\t\t\t\t\tname="calls"\n\t\t\t\t\t\t\tfn:if="!attrs[\'hide-calls\'] && message.get(\'calls\') && message.get(\'calls\').length"\n\t\t\t\t\t\t\targs="message, attrs.link"/>\n\n\t\t\t\t\t<fn:apply-match\n\t\t\t\t\t\t\tfn:if="messageAttachments.length"\n\t\t\t\t\t\t\tname="attachments"\n\t\t\t\t\t\t\targs="messageAttachments, 0, true"/>\n\t\t\t\t</fn:match>\n\n\t\t\t\t<fn:match name="footer">\n\t\t\t\t\t<fn:apply-match name="banner"/>\n\t\t\t\t</fn:match>\n\t\t\t</b:layer-mobile>\n\t\t</fn:if>\n\t</fn:if>\n</div>\n',"app/feast-tpl!ui-block/layer-sent-page/layer-sent-page.html")});define("feast-tpl!ui-block/layer-sent-page/layer-sent-page.html",["feast-tpl!app/feast-tpl!ui-block/layer-sent-page/layer-sent-page.html"],function(a){return a});define("feast-tpl!app/feast-tpl!ui-block/attach-filename/attach-filename.html",["feast"],function(a){return a.smartParse('<div>\n\t<span bem:elem="icon">\n\t\t<b:attach-icon name="{attrs.model.getExtension()}"/>\n\t</span>\n\t<span bem:elem="text">{attrs.model.get(\'name\')}</span>\n</div>\n',"app/feast-tpl!ui-block/attach-filename/attach-filename.html")});define("feast-tpl!ui-block/attach-filename/attach-filename.html",["feast-tpl!app/feast-tpl!ui-block/attach-filename/attach-filename.html"],function(a){return a});define("ui-block/attach-filename/attach-filename",["exports","feast","feast-tpl!./attach-filename.html","ui-block/attach-icon/attach-icon"],function(exports,a,b,c){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var d=g(a);var e=g(b);var f=g(c);function g(a){return a&&a.__esModule?a:{default:a}}exports.default=d.default.Block.extend({name:"attach-filename",template:e.default,blocks:{"attach-icon":f.default}})});var __assign=this&&this.__assign||function(){__assign=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++){b=arguments[c];for(var e in b)if(Object.prototype.hasOwnProperty.call(b,e))a[e]=b[e]}return a};return __assign.apply(this,arguments)};var __createBinding=this&&this.__createBinding||(Object.create?function(a,b,c,d){if(d===undefined)d=c;var e=Object.getOwnPropertyDescriptor(b,c);if(!e||("get"in e?!b.__esModule:e.writable||e.configurable)){e={enumerable:true,get:function(){return b[c]}}}Object.defineProperty(a,d,e)}:function(a,b,c,d){if(d===undefined)d=c;a[d]=b[c]});var __setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(a,b){Object.defineProperty(a,"default",{enumerable:true,value:b})}:function(a,b){a["default"]=b});var __importStar=this&&this.__importStar||function(a){if(a&&a.__esModule)return a;var b={};if(a!=null)for(var c in a)if(c!=="default"&&Object.prototype.hasOwnProperty.call(a,c))__createBinding(b,a,c);__setModuleDefault(b,a);return b};var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("ui-block/layer-sent-page/layer-sent-page",["require","exports","@mail/adman","data-source/index","default-values","feast","feast-mod/correspondents","feast-mod/utils","feast-tpl!./layer-sent-page.html","helpers/browser","lazy.modules","mail/Folder","mail/Message","service/adv/index","service/compose","service/notify","service/radars/decorator","service/radars/index","service/smokescreen","ui-block/attach-filename/attach-filename","ui-block/button2/button2","ui-block/ico/ico","ui-block/layer/layer","ui-block/layer-mobile/layer-mobile","ui-block/spinner/spinner"],function(require,exports,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){"use strict";Object.defineProperty(exports,"__esModule",{value:true});a=__importDefault(a);b=__importDefault(b);d=__importStar(d);g=__importStar(g);h=__importDefault(h);j=__importDefault(j);k=__importDefault(k);l=__importDefault(l);m=__importDefault(m);n=__importDefault(n);o=__importDefault(o);p=__importDefault(p);r=__importDefault(r);s=__importDefault(s);t=__importDefault(t);u=__importDefault(u);v=__importDefault(v);w=__importDefault(w);var x={ok:i18n("Вы отменили отправку письма"),fail:i18n("Не удалось отменить отправку"),openDraft:i18n("Отправка отменена, открываем черновик"),openDraftFail:i18n("Не удалось открыть черновик")};var y="command+z,ctrl+z";exports.default=d.Block.extend((0,o.default)({events:["calls-link","calls-copy","calls-message-link"]})((0,q.withWelter)({name:"layer-sent-page",template:g,clipboard:null,mods:{correspondent:e.correspondent},blocks:{layer:u.default,"attach-filename":r.default,button2:s.default,"layer-mobile":v.default,spinner:w.default,ico:t.default},events:{"attachments-more:click":"onAttachmentsToggle","recipients-more:click":"onRecipientsToggle","link:click":"onLinkClick","calls-message-link":"onLinkClick",close:"onClose",resend:"onResend","compose-back":"onComposeBack",template:"onTemplate","calls-copy":"onCallsCopyClick",cancel:"onCancel","go-inbox":"goToInboxFolder","go-drafts":"openDraft"},defaults:{mobile:false,visible:false,responsive:true,isLateSent:false,lateSentText:"",model:null,loading:false,error:false,"delay-visible":c.LAYER_SENT_PAGE_CONFIG.delayVisible,"hide-ads":c.HIDE_TOYS===c.BL_PROP_NAME,"hide-calls":c.DISABLE_CALLS_ON_SENT_PAGE,"loader-timeout-exceeded":false,"visibility-timeout-exceeded":false,"template-status":"idle","promo-disabled":false,"attachments-more":0,"attachments-expanded":false,"recipients-more":0,"recipients-expanded":false,"last-recipients-id":"","last-attachments-id":"","is-notify-version":false,"is-delivery-cancel-version":false,"delivery-cancel-timer-text":null,"cancellation-result-text":x.ok,"cancellation-interval":null,"is-cancellation-over":false,"cancellation-with-draft":false,"is-cancellation-progress":false,"is-letter-canceled":false,"timer-start":0,"prev-timer-value":0,"cancel-lifetime":0,"open-draft-fail":false},attrChanged:{visible:function(){this.isReady()&&this.redraw()},loading:function(){if(this.isMounted()){if(this.isReady()){this.redraw()}this.setVisibilityTimeout()}},error:function(a){if(a){this.is("visible")&&this.redraw();clearTimeout(this.visibleTimer)}},mobile:function(){this.isReady()&&this.redraw(true)},model:function(a){this._attachments=a.attachments.filter(function(a){return!a.isInline()})},"loader-timeout-exceeded":function(){this.isReady()&&this.redraw()},"visibility-timeout-exceeded":function(){if(this.isReady()){(0,p.default)("sent_close_timeout");this.onClose()}}},isReady:function(){return this.is("visible")&&!this.is("loading")&&!this.is("error")&&(this.is("loader-timeout-exceeded")||!this.loadingTimer)},redraw:function(a){var b=this;if(a===void 0){a=false}this.hideElements("attachments","layer-sent-page__attach-item",a);this.hideElements("recipients","layer-sent-page__contact-item",a);if(this.clipboard){this.clipboard.destroy()}var c=this.refs.callsLinkCopy;if(c){var d=this.get("model");var e=d===null||d===void 0?void 0:d.get("calls");if(!e||!e.length){return(0,p.default)([this.name,"calls","error","no-link-to-copy"])}c.setAttribute("data-clipboard-text",e[0]);(0,i.lazyClipboard)().then((0,i.uniqCallback)(this,function(a){b.clipboard=b.isMounted()?new a(c):null}))}this.sendCallsRadar()},hideElements:function(a,b,c){if(c===void 0){c=false}var d=this.refs[a];if(!d){return}var e=d.offsetWidth;if((c||!this.get("".concat(a,"-more")))&&d.scrollWidth>e){var f=d.getElementsByClassName(b);var g=0;while(g<f.length&&f[g].offsetLeft+f[g].offsetWidth<e){g++}if(g!==f.length){this.set("".concat(a,"-more"),f.length-g-1);this.set("last-".concat(a,"-id"),this.get("".concat(a,"-more"))>0?f[g].getAttribute("data-id"):"")}}(0,p.default)([this.name,a,"more",this.is("".concat(a,"-more")).toString()])},onAttachmentsToggle:function(){this.set("attachments-expanded",!this.is("attachments-expanded"));(0,p.default)([this.name,"attachments","more","click"])},onRecipientsToggle:function(){this.set("recipients-expanded",!this.is("recipients-expanded"));(0,p.default)([this.name,"recipients","more","click"])},onLinkClick:function(){var a=this;(0,p.default)([this.name,"link"]);this.get("router").nav(this.get("link")).then(function(){a.onClose()})},onResend:function(){var a=this;var b=this.get("model");this.set({loading:true,error:false});(0,p.default)([this.name,"resend","click"]);b.send().then(function(b){a.broadcast("resent",{sentMessage:b});(0,p.default)([a.name,"resend","ok"])}).catch(function(){a.set("error",true);(0,p.default)([a.name,"resend","fail"])})},onComposeBack:function(){var a=this.get("model");a.set("finalized",false);m.default.add(a);(0,p.default)([this.name,"compose-back","click"]);this.broadcast("layer:close",{type:"compose-back"})},prepareModelForTemplate:function(){var a=this.get("model");return k.default.findOne(this.get("sent-id")).then(function(b){return a.reattach({sync_space_left:true,sync_attachments:true,reset_attachments:true,source_model:b,force:true})})},onTemplate:function(){var a=this;var c=this.name;(0,p.default)([c,"template","click"]);this.set("template-status","saving");this.clearTimeouts();var d=this.get("model");this.prepareModelForTemplate().then(function(){return d.save({template:true})}).then(function(){(0,p.default)([c,"template","ok"]);if(a.isMounted()){a.set("template-status","saved");a.setVisibilityTimeout()}else{n.default.add({text:i18n("Сохранено в шаблоны")})}b.default.updateAll()}).catch(function(){if(a.isMounted()){a.broadcast("layer:close");a.set("template-status","idle")}(0,p.default)([c,"template","fail"]);n.default.add({type:n.default.types.error,text:i18n("Что-то пошло не так")})})},clearCancellationInterval:function(){var a=this.get("cancellation-interval");if(a){clearInterval(a);this.set("cancellation-interval",null)}},forceDelivery:function(){var a=this.get("model");var b=a.get("delivery_forced");var c=a.get("delivery_canceled");var d=a.get("cancellation_token");if(!b&&!c&&d){a.forceDelivery().then(function(a){var b=a.success;var c=b?"suc":"err";(0,p.default)("del_force_".concat(c))}).catch(function(a){(0,p.default)({type:"del_force_fail",rlog:"del_force_fail",rlog_message:a})})}},onCancel:function(){var a=this;(0,p.default)({type:"del_cancel_click",value:this.get("time-difference")});this.set("is-cancellation-progress",true);var b=this.get("cancellation-notify");b===null||b===void 0?void 0:b.close();clearTimeout(this.visibleTimer);var c=this.get("model");c.cancelDelivery().then(function(b){var d=b.success,e=b.error;var f=!a.get("cancellation-interval");var g=d&&!f?[x.ok,"ok"]:[x.fail,"error_".concat(e)],h=g[0],i=g[1];var j=d&&c.get("draft_id");a.set({"cancellation-result-text":h,"is-cancellation-over":true,"cancellation-with-draft":j,"is-cancellation-progress":false,"is-letter-canceled":true});if(a.get("is-notify-version")){n.default.add({text:d?x.openDraft:x.fail,qa:"cancellation-".concat(d?"ok":"fail","-notify")})}a.clearCancellationInterval();(0,p.default)("del_cancel_".concat(i));if(j){a.openDraft()}}).catch(function(b){a.set({"cancellation-result-text":x.fail,"is-cancellation-progress":false,"is-letter-canceled":true});if(a.get("is-notify-version")){n.default.add({text:x.fail,qa:"cancellation-error-notify"})}(0,p.default)({type:"del_cancel_fail",rlog:"del_cancel_fail",rlog_message:b})}).finally(function(){a.setVisibilityTimeout()})},setTimerValues:function(a,b){var c=this.get("prev-timer-value");if(a>=c){return}if(this.get("is-notify-version")){var d=this.get("cancellation-notify");d&&n.default.setData(d,{actions:[{text:this.getCancelMsg(a)}]});this.set({"time-difference":b,"prev-timer-value":a})}else{this.set({"delivery-cancel-timer-text":this.getCancelMsg(a,false),"time-difference":b,"prev-timer-value":a})}},setCancellationTimer:function(){var a=this;var b=this.get("cancel-lifetime");var d=setInterval(function(){var d=a.get("timer-start");var e=Math.round((Date.now()-d)/1e3);var f=b-e;var g=f+c.CANCELLATION_RESERVE_TIME;f<=0?a.onCancelTimerOver():a.setTimerValues(f,e);if(g===0){a.clearCancellationInterval()}},200);this.set({"timer-start":Date.now(),"delivery-cancel-timer-text":this.getCancelMsg(b,false),"cancellation-interval":d,"prev-timer-value":b})},onClose:function(){if((this===null||this===void 0?void 0:this.el)&&!this.get("is-cancellation-progress")){this.broadcast("layer:close")}},onBeforeHide:function(){this.clearTimeouts();var b=a.default.placement("sent");if(b){b.sleep()}l.default.wakeUp("sent");l.default.update();var d=(this===null||this===void 0?void 0:this.el)&&this.get("is-cancellation-progress");if(c.DELAY_FOR_CANCELLATION&&!d){this.forceDelivery()}if(d){return{stopHiding:true}}this.broadcast("layer:on-before-hide")},onCancelTimerOver:function(){var a=(this===null||this===void 0?void 0:this.el)&&this.get("is-cancellation-progress");if(!a){this.set("is-cancellation-over",true);this.forceDelivery();var b=this.get("cancellation-notify");b===null||b===void 0?void 0:b.close()}},showNotify:function(){var a=this.getMessages();var b=this.get("is-delivery-cancel-version");if(!b){n.default.add({text:this.get("isLateSent")?a.lateSent:a.sent,qa:"".concat(this.get("isLateSent")?"scheduled-":"","letter-sent-notify")});return}var c=n.default.add({text:a.sent,actions:[{text:this.getCancelMsg(this.get("cancel-lifetime"))}],qa:"letter-cancellation-notify",duration:this.get("cancel-lifetime")});c.on("action",this.onCancel.bind(this));c.on("closed",this.onClose.bind(this));this.set("cancellation-notify",c)},didMount:function(){var b=this;if(a.default.placement("sent")){var c=a.default.placement("sent");c.attachToContainer(this.refs.banner);c.wakeUp();c.render(true).catch(function(){return null})}var d=this.get("is-delivery-cancel-version");var e=this.get("is-notify-version");if(e){this.showNotify();(0,i.lazyMailKeymaster)().then(function(a){if(b.mounted&&!b.keyLib){b.keyLib=a;a(y,function(){b.onCancel()})}})}if(!d){return}(0,p.default)("cancel_on");this.setCancellationTimer()},didUnmount:function(){this.clearTimeouts();if(a.default.placement("sent")){a.default.placement("sent").destroy()}if(this.clipboard){this.clipboard.destroy()}this.clearCancellationInterval();if(this.keyLib){this.keyLib.unbind(y)}},setVisibilityTimeout:function(){var a=this;this.visibleTimer=setTimeout(function(){a.set("visibility-timeout-exceeded",true)},this.get("delay-visible"))},clearTimeouts:function(){clearTimeout(this.loadingTimer);clearTimeout(this.visibleTimer)},getContactList:function(a){return(0,e.correspondentsFull)(a)},getContactKey:function(a,b){return"contact-".concat(b,"-").concat(a)},getAttachKey:function(a){return"attach-".concat(a)},getAttachments:function(){return this._attachments},getMessages:function(){var a=this;var b=!Object.values(f.TRANSLATE_STRINGS_TO_MOMENT).find(function(b){return a.attrs.lateSentText.includes(b)});return{more:function(a){return i18n("и {spanOpen}ещё {more}{spanClose}",__assign({"unsafe-spanOpen":'<span class="layer__link">',"unsafe-spanClose":"</span>"},a))},sent:i18n("Письмо отправлено"),lateSent:b?i18n("Ваше письмо будет отправлено {lateSentText}",{lateSentText:this.attrs.lateSentText}):i18n("Ваше письмо будет отправлено {lateSentTextWithoutPrefix}",{lateSentTextWithoutPrefix:this.attrs.lateSentText})}},onCallsCopyClick:function(){n.default.add({text:i18n("Ссылка скопирована")},"layer-window")},sendCallsRadar:function(){var a=this.get("model");var b=a===null||a===void 0?void 0:a.get("calls");var c=this.get("hide-calls");if(c||!b||!b.length){(0,p.default)([this.name,"show","no-calls"])}else if(b.length===1){(0,p.default)([this.name,"show","calls-one"])}else{(0,p.default)([this.name,"show","calls-many"])}},goToInboxFolder:function(){var a=this.get("router");a===null||a===void 0?void 0:a.go("#letters");this.broadcast("layer:close");(0,p.default)([this.name,"go","inbox"])},openDraft:function(){var a=this;(0,p.default)("cncl_draft_clk");var b=this.get("model");return k.default.fetchData({id:b.get("draft_id"),folder_id:j.default.DRAFTS},true,true).then(function(b){(0,p.default)("cncl_draft_ok");k.default.set([b]);a.set("open-draft-fail",false);a.broadcast("compose:draft",new k.default(b));a.onClose()}).catch(function(b){(0,p.default)({type:"cncl_draft_fail",rlog:"cncl_draft_fail",rlog_message:b});a.set({"open-draft-fail":true,"cancellation-result-text":x.openDraftFail})})},getCancelShortcut:function(){return h.default.mac?"CMD+Z":"CTRL+Z"},getCancelMsg:function(a,b){if(b===void 0){b=true}var d=c.LETTER_SEND_CANCEL_TIMER_DISPLAY_TIME_AT_THE_END;if(d>0&&a<=d){return b?i18n("Отменить {timerValue}",{timerValue:a}):i18n("Отменить отправку {timerValue}",{timerValue:a})}return b?i18n("Отменить"):i18n("Отменить отправку")}})))});var __assign=this&&this.__assign||function(){__assign=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++){b=arguments[c];for(var e in b)if(Object.prototype.hasOwnProperty.call(b,e))a[e]=b[e]}return a};return __assign.apply(this,arguments)};var __createBinding=this&&this.__createBinding||(Object.create?function(a,b,c,d){if(d===undefined)d=c;var e=Object.getOwnPropertyDescriptor(b,c);if(!e||("get"in e?!b.__esModule:e.writable||e.configurable)){e={enumerable:true,get:function(){return b[c]}}}Object.defineProperty(a,d,e)}:function(a,b,c,d){if(d===undefined)d=c;a[d]=b[c]});var __setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(a,b){Object.defineProperty(a,"default",{enumerable:true,value:b})}:function(a,b){a["default"]=b});var __importStar=this&&this.__importStar||function(a){if(a&&a.__esModule)return a;var b={};if(a!=null)for(var c in a)if(c!=="default"&&Object.prototype.hasOwnProperty.call(a,c))__createBinding(b,a,c);__setModuleDefault(b,a);return b};var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("ui-block/compose-windows/compose-windows",["require","exports","@mail/adman","@mail/features","@mail/xray","cfg","data-source/actions","data-source/index","default-values","feast","feast-tpl!./compose-windows.html","helpers/autocomplete","helpers/email-length-postfix","helpers/opener","helpers/user-track","logger","mail/Folder","mail/Message","mail/Thread","mediator/layout-manager","RPC","service/addressbook/addressbook","service/adv/index","service/auth","service/captcha","service/compose-validators","service/layer","service/mailbox/loader","service/notify","service/radars/decorator","service/radars/index","service/smokescreen","ui-block/compose-app/compose-app","ui-block/compose-collapsed/compose-collapsed","ui-block/dimmer/dimmer","ui-block/layer-sent-page/layer-sent-page","ui-block/notify-stack/notify-stack","../../feast-mod/utils"],function(require,exports,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J){"use strict";Object.defineProperty(exports,"__esModule",{value:true});a=__importDefault(a);b=__importDefault(b);c=__importDefault(c);d=__importDefault(d);f=__importDefault(f);h=__importStar(h);i=__importStar(i);j=__importDefault(j);l=__importDefault(l);m=__importDefault(m);n=__importDefault(n);o=__importDefault(o);p=__importDefault(p);q=__importDefault(q);r=__importDefault(r);s=__importDefault(s);t=__importStar(t);u=__importStar(u);v=__importDefault(v);w=__importDefault(w);x=__importDefault(x);y=__importDefault(y);z=__importDefault(z);A=__importDefault(A);B=__importDefault(B);C=__importDefault(C);E=__importDefault(E);F=__importDefault(F);G=__importDefault(G);H=__importDefault(H);I=__importDefault(I);var K=100;var L=100;var M=350;var N=350;var O="too_long";var P=n.default.getScope("compose.mail.ru");var Q=function(){u.default.wakeUp.apply(u.default,u.SLOTS_EXCEPT_SENT);u.default.updateOnAction()};exports.default=h.Block.extend((0,B.default)({explicit:"radar"})({name:"compose-windows",blocks:{dimmer:G.default,"compose-app":E.default,"compose-collapsed":F.default,"notify-stack":I.default,"layer-sent-page":H.default},events:{"collapsed-item-close":"onCollapsedItemClose","window-close":"onClose","window-collapse":"onCollapse","window-expand":"onExpand","letter-send":"onLetterSend","letter-schedule":"onLetterSchedule","letter-save":"onLetterSave","letter-autosave":"onLetterAutosave","letter-savetemplate":"onLetterSaveTemplate","letter-exceedmaxsize":"onExceedSize","create-note-from-letter":"onCreateNoteFromLetter"},defaults:{adaptive:false,fullscreen:false,compact:false,overlap:false,ponymode:false,mobile:g.TOUCH_MODE,"mobile-layout":false,"expand-status":false,"has-right-column":false,"right-column-compact":false,rise:false,"support-extend":true,extended:false,"close-on-error":false,autosend:false,"show-mobile-footer":g.CAN_SHOW_FOOTER_APP_TOOLBAR},template:i,isolateEvents:false,constructor:function(){h.Block.prototype.constructor.apply(this,arguments);this.onLayoutUpdate=this.onLayoutUpdate.bind(this);this.onDataSourceChange=this.onDataSourceChange.bind(this)},didMount:function(){this._sending={};this._sendingCaptchaCallbacks={};A.default.setup(this.ids["compose-notify"],"compose-notify");f.default.on("change",this.onDataSourceChange);this.onLayoutUpdate();if(g.COMPOSE_INIT_ADDRESSBOOK){t.default.lazyInit()}},didUnmount:function(){f.default.off("change",this.onDataSourceChange)},animate:function(a,b,c){var d=this;if(g.COMPOSE_WINDOW_ANIMATION){var e="animate-".concat(a);setTimeout(function(){d.set(e,false);if(c){c()}},b);this.set(e,true)}else if(c){c()}},onCollapsedItemClose:function(a){var b=a.details;this.remove(b.uid);b.destroy();this.broadcast("window-collapsed-hide")},onClose:function(a){var b=this;var c=a.details;var d=c.get("form");var e=c.get("compose-options");var f=this.get("active");var g=function(){Q();d.uid===f&&b.set("active",null);b.remove(d.uid);d.destroy();b.broadcast("window-hide")};if(!c.noAnimate){this.animate("close",L,g)}else{g()}if(e===null||e===void 0?void 0:e.templateName){(0,C.default)({type:"compose-templates_close",dwh:{template:e.templateName}})}return false},onCollapse:function(a){var b=this;var c=a.details;var d=c&&c.get("form");var e=this.ids["compose-"+this.get("active")];var f=c||e;if(f){f._updateComposeFields();this.saveDraft(f,{silent:true})}var g=function(){b.hide(d.uid);b.set("expand-status",false);Q();b.broadcast("window-hide")};if(!c.noAnimate){this.animate("collapse",N,g)}else{g()}},onExpand:function(a){var b=this;var c=a.details;var d=c.get("form")||c;this.show(d.uid);this.animate("expand",M,function(){b.set("expand-status",true)})},onLetterAutosave:function(a){var b=a.details;(0,C.default)("compose_action_save_auto");P.add("autosave",{id:b.attrs.form.uid});this.saveDraft(b)},onLetterSave:function(a){var b=a.details;(0,C.default)("compose_action_save");var c=b.get("compose-options");this.saveDraft(b,{userAction:true});if(c===null||c===void 0?void 0:c.templateName){(0,C.default)({type:"compose-templates_save",dwh:{template:c.templateName}})}},onLetterSaveTemplate:function(a){var b=a.details,c=b.composeApp,d=b.resolve;(0,C.default)("compose_action_save_template");this.saveTemplate(c).then(d,d)},onLetterSchedule:function(a){var b=a.details,c=b.composeApp,d=b.scheduleText;var e=c.get("compose-options");this.letterSend({composeApp:c,scheduleText:d,schedule:true});if(e===null||e===void 0?void 0:e.templateName){(0,C.default)({type:"compose-templates_schedule",dwh:{template:e.templateName}})}},onExceedSize:function(){this.showExceedNotify()},onLetterSend:function(a){var b;var c=a.details;var d=this.get("active");if(d!=((b=c.get("form"))===null||b===void 0?void 0:b.uid)){return}var e=c.get("compose-options");this.letterSend({composeApp:c});if(e===null||e===void 0?void 0:e.templateName){(0,C.default)({type:"compose-templates_send",dwh:{template:e.templateName}})}},onDataSourceChange:function(a){var b=a.details;if(!b){return}var c=b.changes;if(!c){return}var d=c.some(function(a){var b=a.action;if(!b){return false}var c=b.type;return c===e.UPDATE_LAYOUT_SUPPORT_3_PANE});if(d){this.onLayoutUpdate()}},onLayoutUpdate:function(){var a;var b=this.get("layout");if(b){var c="default"in b&&"isLessThen"in b.default&&"isMoreThen"in b.default?b.default:b;var e=c.columnRight;var f=e>=40;var h=(c===null||c===void 0?void 0:c.isMoreThen("xs"))&&(c===null||c===void 0?void 0:c.isLessThen("l"))&&e<=40;var i=!!(((a=d.default.headline)===null||a===void 0?void 0:a.headlinePromoHeight)!==0&&document.querySelector(".vk-slides-iframe_show"));this.set({fullscreen:(c===null||c===void 0?void 0:c.isLessThen("s"))||g.TOUCH_MODE,adaptive:!i&&(c===null||c===void 0?void 0:c.isVertical("l")),mobile:(c===null||c===void 0?void 0:c.isLessThen("s"))||g.TOUCH_MODE,"mobile-xxs":c===null||c===void 0?void 0:c.isLessThen("xs"),overlap:(c===null||c===void 0?void 0:c.isLessThen("m"))||g.TOUCH_MODE,compact:h,rise:(c===null||c===void 0?void 0:c.isLessThen("xl"))||g.TOUCH_MODE,"3pane":(c===null||c===void 0?void 0:c.getType())==="3pane","has-right-column":f,"right-column-compact":f&&e<=40,"support-extend":(c===null||c===void 0?void 0:c.supportComposeExtend)&&!g.TOUCH_MODE})}},letterSend:function(a){var b=this;var c=a.composeApp,d=a.schedule,e=a.scheduleText;var f=c.get("form");x.default.checkOnRettachToReply(f).then(function(a){return!a.hasNewAttach?x.default.checkOnMissingAttach(f).then(function(b){return __assign(__assign({},a),{missingAttach:b})}):__assign(__assign({},a),{missingAttach:false})}).then(function(a){var g=a.hasNewAttach,h=a.source,i=a.missingAttach;if(!g){if(i){b.checkLostAttaches(c,d,e)}else{b.send(c,d,e)}return}(0,C.default)("reattach-to-reply_reattach-open");c.set("focusoff",true);y.default.open("reattach-to-reply",{mobile:r.default.isLessThen("xs")},{dimmer:true,compact:true,resolvable:true,mobile:r.default.isLessThen("xs")}).then(function(a){if(a==="skip"){return x.default.checkOnMissingAttach(f).then(function(b){return{type:a,missingAttach:b}})}return{type:a,missingAttach:false}}).then(function(a){var g=a.type,i=a.missingAttach;c.set("focusoff",false);if(g==="attach"){(0,C.default)("reattach-to-reply_reattach-attach");f.reattach({sync_space_left:true,sync_attachments:true,reset_attachments:false,source_model:h,force:true}).then(function(){b.send(c,d,e)},function(){(0,C.default)("reattach-to-reply_reattach-fail")})}else if(g==="skip"){(0,C.default)("reattach-to-reply_reattach-skip");if(i){b.checkLostAttaches(c,d,e)}else{b.send(c,d,e)}}else{(0,C.default)("reattach-to-reply_reattach-close");c.set("sending",false)}},function(){(0,C.default)("reattach-to-reply_open-fail");c.set("focusoff",false);b.send(c,d,e)})})},checkLostAttaches:function(a,b,c){var d=this;(0,C.default)("missing_attach_open");a.set("focusoff",true);y.default.open("missing-attach",{mobile:r.default.isLessThen("xs")},{dimmer:true,compact:true,resolvable:true,mobile:r.default.isLessThen("xs")}).then(function(e){a.set("focusoff",false);if(e==="skip"){(0,C.default)("missing_attach_skip");d.send(a,b,c)}else{(0,C.default)("missing_attach_back");a.set("sending",false)}},function(){a.set("focusoff",false);(0,C.default)("missing_attach_open-fail");d.send(a,b,c)})},getBodyCount:function(a){var b;try{var c=document.createElement("div");c.innerHTML=a;var d=c.querySelectorAll((0,D.selector)("blockquote"));var e=d.length;for(var f=0;f<e;f++){if(d[f].parentNode){d[f].parentNode.removeChild(d[f])}}b=c.innerHTML.length}catch(a){this.radar(["body-count","error"])}return b},_getCountPostfix:function(a){return(0,k.getEmailLengthPostfix)(a)},send:function(a,b,c){var d=this;if(b===void 0){b=false}if(c===void 0){c=""}if(g.COMPOSE_INIT_ADDRESSBOOK){t.default.lazyInit().then(function(){d._send(a,b,c)})}else{this._send(a,b,c)}},_send:function(a,c,d){var e=this;if(c===void 0){c=false}if(d===void 0){d=""}if(!a.isMounted()){return}var f=a.get("form");var h=f.get("subject");if(g.COMPOSE_SUBJECT_AUTOCOMPLETE&&h){(0,j.default)("Subject",h)}if(g.COMPOSE_SEND_STAT){this._updateComposeStatsFields(f)}if(g.COMPOSE_SEND_USER_TRACK){this._updateComposeUserTrackFields(f)}f.set({"compose_stat.build":g.BUILD,"compose_stat.serverTime":g.SERVER_TIME},{silent:true});if(b.default.has("body-size-radars")){setTimeout(function(){var a=e.getBodyCount(f.get("body.html"));if(a!==void 0){e.radar(["send","body-count",e._getCountPostfix(a)],a);e.radar(["send","body-count"],a)}else{e.radar(["send","no-body-count"])}},0)}a.set("sending",true);w.default.retryUntilCaptchaSuccess(function(a){var b=a.capcha;var d={delay_for_cancellation:g.DELAY_FOR_CANCELLATION};if(b){d.capcha=b}f.set(d);return f.send(c)}).then(function(){var b=f.attachments.reduce(function(a,b){return a+(b.isCloudStock()?1:0)},0);if(b){e.radar(["send","has-cloud-stock"],b)}if(g.OVERSIZE_CLOUD_ATTACHES){var h=f.attachments.reduce(function(a,b){if(!b.isOverMaxLinkSize()){return a}var c=b.get("size");var d=a.total,e=a.max,f=a.count,g=a.extensions;g.push(b.get("content_type"));return{max:Math.max(c,e),total:d+c,count:f+1,extensions:g}},{total:0,max:0,count:0,extensions:[]}),i=h.total,j=h.max,k=h.count,l=h.extensions;if(k){(0,C.default)({type:"compose_oversize-cloud_send",dwh:{count:k,total:i,max:j,extensions:l.join()}})}}(0,C.default)("compose_send");var m=f.id,n=f.cid,o=f.uid;P.add("send",{id:m,cid:n,uid:o,schedule:c});e._sendEmailTypeRadar(f.get("correspondents.from.0.email"));e._sendTranslationTypeRadar(f.meta("lastSavedTranslation"));a.set("sending",false);e._openSentPage(a,{isLateSent:c,lateSentText:d});if(c){e.onLateSent(f)}else{e.onSent(f)}},function(b){(0,C.default)("compose_send_fail");a.set({sending:false,errors:b.body,capcha:null});e.onFailSent(f,b,a)}).catch(function(){a.set("sending",false)})},unsubscribeCaptchaCallback:function(a){if(this._sendingCaptchaCallbacks[a]){w.default.off("open-captcha-popup",this._sendingCaptchaCallbacks[a]);delete this._sendingCaptchaCallbacks[a]}},isCancelDeliveryTurnOn:function(a){if(!a){return false}var b=a.get("cancellation_token");var c=a.get("cancellation_button_lifetime");return b&&c},_openSentPage:function(b,c){var d=this;var e=this.get("router");var f=b.get("form");var h=this.isCancelDeliveryTurnOn(f);var i=(!a.default.placement("sent")||g.OCTAVIUS_MOBILE)&&g.SENT_PAGE_NOTIFY;var j=f.uid;var k=c.isLateSent,l=c.lateSentText;this._sending[j]=true;this.hide(j);this.layerPromise=y.default.open("sent-page",{model:f,loading:false,link:e.getUrl("#letters",{folder:o.default.SENT}),router:e,"is-delivery-cancel-version":h,"is-notify-version":i,"cancel-lifetime":f.get("cancellation_button_lifetime"),isLateSent:k,lateSentText:l},{dimmer:!i,silent:i,"close-on-esc":!i,resolvable:false});this.layerPromise.then(function(a){a.on("resent",d.onSent.bind(d));a.on("layer:close",function(a){var b=a.details;if((b===null||b===void 0?void 0:b.type)!=="compose-back"){d.close(f.uid)}Q();d.broadcast("window-hide")})})},saveDraft:function(a,b){var c=this;var d=b===void 0?{}:b,e=d.silent,g=e===void 0?false:e,h=d.userAction,i=h===void 0?false:h;var j=a.get("form");if(a.is("closing")){return j.save().then(function(){(0,C.default)("compose_save");return f.default.updateAll()}).then(function(){c.showDraftNotify(false,"default")}).catch(function(a){c.onFailDraft(a,false)})}a.set("saving",true);return j.save().then(function(){(0,C.default)("compose_save");var b=j.id,d=j.cid,e=j.uid;P.add("save",{id:b,cid:d,uid:e});a.set({saving:false,"has-changes":false});a.setAutosaveInterval(false);c.reloadFormData(j);if(!g){c.showDraftNotify()}}).then(function(){return f.default.updateAll()}).catch(function(b){var d=i;c.onFailDraft(b,false);var e=j.id,f=j.cid,g=j.uid;P.add("save failed",{id:e,cid:f,uid:g,error:b});a.set(__assign(__assign({},d&&{errors:b.body}),{saving:false,"has-changes":true}))})},onFailDraft:function(a,b,c){if(c===void 0){c=true}(0,C.default)("compose_save_".concat(b?"template_":"","fail"));try{var d=a.body;var e=d&&Object.keys(d).some(function(a){return/^attaches.list\[.*].id$/.test(a)&&d[a].error==="not_exists"});if(e){(0,C.default)("compose_save_".concat(b?"template_":"","fail_badattach"))}}catch(a){console.error(a);(0,C.default)("compose_save_".concat(b?"template_":"","fail_unknown"))}if(c){this.showDraftFailNotify(b)}},showDraftFailNotify:function(a,b){if(b===void 0){b="compose-notify"}var c=i18n("Не удалось сохранить в Черновики");if(a){c=i18n("Не удалось сохранить в Шаблоны")}A.default.add({type:A.default.types.error,text:c,qa:"message-save-fail"},b)},saveTemplate:function(a){var b=this;var c=a.get("form");return c.save({template:true}).then(function(){(0,C.default)("compose_save_template");return f.default.updateAll().then(function(){a.set({"template-enabled":false});b.showDraftNotify(true);b.reloadFormData(c,true)})}).catch(function(c){a.set({errors:c.body});b.onFailDraft(c,true,false);(0,C.default)("compose_save_template_fail")})},showDraftNotify:function(a,b){var c=this;if(a===void 0){a=false}if(b===void 0){b="compose-notify"}var d=new Date;var e=this.get("router");var f=A.default.add({text:a?i18n("Сохранено в шаблонах в {now}",{now:(0,J.formatDate)(d,[["hour","2-digit"],["minute","2-digit"]])}):i18n("Сохранено в черновиках в {now}",{now:(0,J.formatDate)(d,[["hour","2-digit"],["minute","2-digit"]])}),actions:[{text:i18n("Посмотреть"),event:a?"openTemplate":"openDraft"}]},b);f===null||f===void 0?void 0:f.on("action",function(a){var b=a.details;if(b==="openDraft"){if(c.get("active")){c.hide()}e.go("#letters",{folder:o.default.DRAFTS})}else if(b==="openTemplate"){if(c.get("active")){c.hide()}e.go("#letters",{folder:o.default.TEMPLATES})}})},showExceedNotify:function(a){if(a===void 0){a="compose-notify"}var b={text:i18n("Картинка прикреплена как вложение"),qa:"image-attached-as-file"};A.default.add(b,a)},removeDraft:function(a){var b=this.get("router");b.model.letters.filter(function(b){var c=b.getFolder();return c.isDrafts()&&!c.isTemplates()&&b.get("last")===a}).forEach(function(a){p.default.all.remove(a)})},onLateSent:function(a){this.close(a.uid);var b=a.get("source.draft");this.layerPromise.then(function(b){b.set({loading:false,"sent-id":a.id})}).catch(function(a){A.default.add({text:i18n("Письмо будет отправлено")});console.error(a)});if(b){this.removeDraft(b)}this.reloadFormData(a,false,true)},onSent:function(a){var b=this;var c;var d=a.get("source.reply")||a.get("source.forward");var e=a.get("source.draft");var f=q.default.getListByMessageId(d);var g=this.get("router");this.close(a.uid);var h=q.default.findOne(a.id);this.set("autosend",false);(c=this.layerPromise)===null||c===void 0?void 0:c.then(function(b){var c=g.getUrl("#read-letter",{folder:o.default.SENT,letter:a.id});b.set({link:c,loading:false,"sent-id":a.id});(0,C.default)("compose_sent-page")}).catch(function(a){A.default.add({text:i18n("Письмо отправлено")});(0,C.default)("compose_sent-page");(0,C.default)("compose_sent-page_layer-error");console.error(a)});h.then(function(){f.forEach(function(b){if(b.get("last")===d){a.get("source.reply")&&b.set("flags.reply",true,{silent:true});a.get("source.forward")&&b.set("flags.forward",true,{silent:true})}b.expire()&&b.fetch()});if(e){b.removeDraft(e)}b.reloadFormData(a,false,true)}).catch(function(a){(0,C.default)("compose_sent-page_thread-error");console.error(a)});if(a.get("calls")){this.radar(["send","calls"])}},onFailSent:function(a,b,c){var d=b.body,e=b.status;delete this._sending[a.uid];this.unsubscribeCaptchaCallback(a.uid);if(s.default.codes[e]==="invalid"&&d===O){A.default.add({type:A.default.types.error,text:i18n("Превышен лимит на размер письма")},"compose-notify");return}this.showSendFailNotify();if(this.get("close-on-error")){this.onClose({details:c})}},showSendFailNotify:function(a){if(a===void 0){a="compose-notify"}A.default.add({type:A.default.types.error,text:i18n("Не удалось отправить письмо"),qa:"message-send-fail"},a)},reloadFormData:function(a,b,c){if(!b){this.updateAffectedMessage(a,c)}z.default.invalidateCache();z.default.emit("any:reload")},updateAffectedMessage:function(a,b){var c=["reply","forward"];var d=c.find(function(b){return a.is("source.".concat(b))});if(d){var e=p.default.all.get(a.get("source.".concat(d)));if(e){if(b){e.set("drafts.".concat(d),"")}else{var f=[];["to","cc"].forEach(function(b){a.get("correspondents.".concat(b)).forEach(function(a){if(~a.email.indexOf("@")&&!f.includes(a.email)){f.push(a.email)}})});if(d==="reply"&&f.length>1){d="replyall"}var g={"drafts.last_type":d};g["drafts.".concat(d)]=a.get("source.draft");e.set(g)}}}},getCollapsed:function(a){var b=this;var c=this.get("active");return a.filter(function(a){var d=a.formData;return d.uid!==c&&!b._sending[d.uid]})},add:function(a,b){var c=this.get("items").find(function(b){var c=b.formData;if(c.uid===a.uid){return true}else{var d=c.get("source");var e=a.get("source");var f=d.draft&&!Object.keys(d).some(function(a){return d[a]!==e[a]});if(f){return true}}return false});if(c){this.animate("expand",M);this.show(c.formData.uid);return}this.animate("open",K);this.get("items").push({formData:a,autosend:b&&b.autosend,isDragAndDrop:b&&b.isDragAndDrop,dragAndDropItem:b&&b.dragAndDropItem,additionalOptions:b});this.show(a.uid);this.render()},show:function(a){this.set("active",a);if(g.COMPOSE_SEND_USER_TRACK){m.default.startComposeTrack(a)}u.default.sleep.apply(u.default,u.SLOTS_EXCEPT_SENT);this.broadcast("window-show")},hide:function(a){var b=this.get("active");if(!a&&b!==null){a=this.get("items").find(function(a){var c=a.formData;return c.uid==b}).formData.uid}if(a===b){this.set("active",null)}if(g.COMPOSE_SEND_USER_TRACK){m.default.pauseComposeTrack(a)}},close:function(a){var b=this.get("active");a===b&&this.set("active",null);this.remove(a)},remove:function(a){delete this._sending[a];this.unsubscribeCaptchaCallback(a);var b=this.get("items").filter(function(b){var c=b.formData;return c.uid!==a});this.set({items:b});if(g.COMPOSE_SEND_USER_TRACK){m.default.removeCompose(a)}},_updateComposeStatsFields:function(a){var b=t.default.getCachedAll();if(b){var d=a.get("correspondents");var e=[];["to","cc","bcc"].forEach(function(a){d[a].forEach(function(a){var c=a.email;if((0,t.isInAddressbook)(b,c)){e.push(1)}else{e.push(0)}})});var f={is_in_ab:e.join(""),ab_size:String(b.length)};a.set("compose_stat",f,{silent:true});c.default.send("compose_stat&i=ab_size:"+f.ab_size,null)}},_updateComposeUserTrackFields:function(a){var b=m.default.serialize(a.uid);a.set("compose_stat.user_track",b,{silent:true});c.default.send("compose-user-track",{i:{size:b.length}})},_getCollectors:function(){return this.get("router").model.collectors},_getAliases:function(){return this.get("router").model.aliases},_sendEmailTypeRadar:function(a){var b="unknown-email";if(a===v.default.user.getEmail()){b="main-email"}if(this._getCollectors().some(function(b){return b.getEmail()===a})){b="collector"}if(this._getAliases().some(function(b){return b.getEmail()===a})){b="alias"}(0,C.default)(["send","email",b])},_sendTranslationTypeRadar:function(a){if(!a){return}(0,C.default)({type:"send_translated_languages",intervals:[["from",a.fromlang],["to",a.tolang]]});(0,C.default)("send_translated")},insertHtml:function(a){var b=this.ids["compose-"+this.get("active")];if(b){b.insertHtml(a)}},useNewToolbar:function(){return g.NEW_TOOLBAR},onCreateNoteFromLetter:function(a){var b=this;var c=a.details;this.saveDraft(c,{userAction:true,silent:true}).then(function(){var a=c.get("form");var d=a.get("source.draft");b.openNote(d)})},openNote:function(a){(0,l.default)("".concat(g.NOTES_URL,"/create-note-from-letter/?letter-id=").concat(a))}}))});define("feast-tpl!app/feast-tpl!ui-block/gallery/gallery.html",["feast"],function(a){return a.smartParse('<div>\n\t<fn:var name="hasPreviousControl" value="{this.hasPreviousControl()}"/>\n\t<fn:var name="hasNextControl" value="{this.hasNextControl()}"/>\n\t<fn:var name="blockCount"/>\n\n\t<bem:mod name="arrows-bottom" test="~attrs.controls.indexOf(\'arrows_bottom\')"/>\n\n\t\x3c!-- Элементы списка --\x3e\n\t<div\n\t\t\tbem:elem="content-outer"\n\t\t\tref="contentOuter"\n\t>\n\t\t<div\n\t\t\t\tbem:elem="content-inner"\n\t\t\t\tref="content"\n\t\t>\n\t\t\t<bem:mod name="animated" test="attrs._animated"/>\n\n\t\t\t<fn:apply-match name="default" count="blockCount"/>\n\t\t</div>\n\t</div>\n\n\t<div bem:elem="controls">\n\t\t\x3c!-- Кнопка "Назад" --\x3e\n\t\t<div\n\t\t\t\tbem:elem="nav-button"\n\t\t\t\ttitle="{i18n(\'Назад\')}"\n\t\t\t\tremit:click="click:previous"\n\t\t\t\ttabindex="-1"\n\t\t>\n\t\t\t<bem:mod name="hidden" test="!hasPreviousControl"/>\n\n\t\t\t<b:ico name="navigation:arrow_list_previous" size="s"/>\n\t\t</div>\n\n\t\t\x3c!-- Текущая страница --\x3e\n\t\t<div bem:elem="pages" fn:if="~attrs.controls.indexOf(\'pages\')">\n\t\t\t{_this._findCurrentStartIndex() | formatPages:blockCount}\n\t\t</div>\n\n\t\t\x3c!-- Кнопка "Вперёд" --\x3e\n\t\t<div\n\t\t\t\tbem:elem="nav-button"\n\t\t\t\ttitle="{i18n(\'Вперёд\')}"\n\t\t\t\tremit:click="click:next"\n\t\t\t\ttabindex="-1"\n\t\t>\n\t\t\t<bem:mod name="hidden" test="!hasNextControl"/>\n\n\t\t\t<b:ico name="navigation:arrow_list_next"/>\n\t\t</div>\n\t</div>\n</div>\n',"app/feast-tpl!ui-block/gallery/gallery.html")});define("feast-tpl!ui-block/gallery/gallery.html",["feast-tpl!app/feast-tpl!ui-block/gallery/gallery.html"],function(a){return a});define("helpers/animation-transition",["require","exports"],function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.animationTransition=void 0;function a(){var a;var b={transitionOnce:function(c,d){c();if(a){clearTimeout(a)}a=setTimeout(function(){if(b.onEnd){b.onEnd()}a=undefined},d)},stopAll:function(){if(a){clearTimeout(a);if(b.onEnd){b.onEnd()}}}};return b}exports.animationTransition=a});var __assign=this&&this.__assign||function(){__assign=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++){b=arguments[c];for(var e in b)if(Object.prototype.hasOwnProperty.call(b,e))a[e]=b[e]}return a};return __assign.apply(this,arguments)};define("helpers/touch-tracker",["require","exports"],function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.touchTracker=void 0;var a={mouse:false,touch:true,mouseDragThreshold:10};function b(b,c){if(c===void 0){c={}}var d=__assign(__assign({},a),c);var e=null;var f;var g;var h;var i;var j=false;var k=false;var l=function(a,b){f=a;g=b;h=f;i=g;k=false};var m=function(a,b){if(f===undefined||g===undefined){f=a;g=b}if(h===undefined||i===undefined){h=f;i=g}var c=f-a;var j=g-b;f=a;g=b;if(Math.abs(h-f)>=d.mouseDragThreshold||Math.abs(i-g)>=d.mouseDragThreshold){k=true}if(e.onMove){e.onMove(c,j)}};var n=function(){f=undefined;g=undefined;if(e.onMoveEnd){e.onMoveEnd()}};var o=function(a){var b=a.changedTouches[0];if(b){l(b.clientX,b.clientY)}};var p=function(a){j=true;l(a.clientX,a.clientY)};var q=function(a){var b=a.changedTouches[0];if(!b){return}m(b.clientX,b.clientY)};var r=function(a){if(j){m(a.clientX,a.clientY)}};var s=function(){n()};var t=function(){j=false;n()};var u=function(a){a.preventDefault()};var v=function(a){if(k){a.preventDefault()}};if(d.touch){b.addEventListener("touchstart",o,{passive:true});b.addEventListener("touchmove",q,{passive:true});b.addEventListener("touchend",s,{passive:true});b.addEventListener("touchcancel",s,{passive:true})}if(d.mouse){b.addEventListener("mousedown",p);b.addEventListener("mousemove",r);b.addEventListener("mouseup",t);b.addEventListener("mouseleave",t);b.addEventListener("dragstart",u);b.addEventListener("click",v)}e={stop:function(){if(d.touch){b.removeEventListener("touchstart",o);b.removeEventListener("touchmove",q);b.removeEventListener("touchend",s);b.removeEventListener("touchcancel",s)}if(d.mouse){b.removeEventListener("mousedown",p);b.removeEventListener("mousemove",r);b.removeEventListener("mouseup",t);b.removeEventListener("mouseleave",t);b.removeEventListener("dragstart",u);b.removeEventListener("click",v)}}};return e}exports.touchTracker=b});var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("ui-block/gallery/gallery",["require","exports","feast","feast-tpl!./gallery.html","helpers/animation-transition","helpers/resizer","helpers/touch-tracker","ui-block/ico/ico"],function(require,exports,a,b,c,d,e,f){"use strict";Object.defineProperty(exports,"__esModule",{value:true});a=__importDefault(a);b=__importDefault(b);d=__importDefault(d);f=__importDefault(f);var g=a.default.Block.extend({name:"gallery",template:b.default,blocks:{ico:f.default},mods:{formatPages:function(a,b){return i18n("{current} из {total}",{current:String(a+1),total:String(b)})}},defaults:{controls:"touch, arrows_middle",_offset:0,_width:window.innerWidth},attrChanged:{_width:function(a){var b=this;this.checkScrollEnd();if(!a){return}if(this.allBlocksVisibleTimeout){clearTimeout(this.allBlocksVisibleTimeout)}this.allBlocksVisibleTimeout=setTimeout(function(){if(b.isMounted()&&b._fitsInWidth(a)){b.broadcast("all-blocks-visible")}b.allBlocksVisibleTimeout=null});if(this.allBlocksRenderedTimeout){clearTimeout(this.allBlocksRenderedTimeout)}this.allBlocksRenderedTimeout=setTimeout(function(){if(b.isMounted()){b.handleAllBlocksRendered()}b.allBlocksRenderedTimeout=null},500)},_offset:function(){this.checkScrollEnd()}},events:{"click:previous":"onClickPrevious","click:next":"onClickNext","touchstart:content-inner":"onTouchStart","touchmove:content-inner":"onTouchMove"},constructor:function(){var b=this;a.default.Block.apply(this,arguments);this.onResize=this.onResize.bind(this);this._itemOffsets=[];this._itemsWidth=0;this._transition=(0,c.animationTransition)();this._transition.onEnd=function(){if(b.isMounted()){b.set("_animated",false)}}},didMount:function(){this._resizer=(0,d.default)();this._resizer.set(this.onResize);this._resizer.observe(this.refs.content,"content");this._resizer.observe(this.refs.contentOuter,"contentOuter");this._measureItemOffsets({});this.onResize();this.setupTouchTracker()},didUpdate:function(){this._measureItemOffsets({})},shouldUpdate:function(a){if(a._offset!==undefined){this.refs.content.style.marginLeft="".concat(-a._offset,"px");return Object.keys(a).length>1}if(a.controls!==undefined&&this._touchTracker){this._touchTracker.stop();this.setupTouchTracker()}return true},didUnmount:function(){this._resizer.unbind();this._touchTracker.stop();this._transition.stopAll()},setupTouchTracker:function(){var a=this;this._touchTracker=(0,e.touchTracker)(this.el,{touch:this.get("controls").includes("touch"),mouse:this.get("controls").includes("mouse")});this._touchTracker.onMove=function(b){a.set("_offset",Math.max(Math.min(a.get("_offset")+b,a._itemsWidth-a.get("_width")),0))};this._touchTracker.onMoveEnd=function(){a._transition.transitionOnce(function(){a.set({_offset:a._getItemOffset(a._findNearestStartIndex()),_animated:true})},200)}},onClickPrevious:function(){var a=this;if(this.hasPreviousControl()){var b=this._findCurrentStartIndex();this._transition.transitionOnce(function(){a.set({_offset:a._getItemOffset(b-1),_animated:true})},200)}},onClickNext:function(){var a=this;if(this.hasNextControl()){var b=this._findCurrentStartIndex();this._transition.transitionOnce(function(){a.set({_offset:a._getItemOffset(b+1),_animated:true})},200)}},onResize:function(a){var b=this._getOuterRectWidth(a!==null&&a!==void 0?a:{});this._measureItemOffsets(a!==null&&a!==void 0?a:{},false);this.set({_width:b,_offset:this._getItemOffset(this._findCurrentStartIndex(),b)})},hasPreviousControl:function(a){if(a===void 0){a=this.get("_offset")}return!this._fitsInWidth()&&a>0},hasNextControl:function(a){if(a===void 0){a=this.get("_offset")}return!this._fitsInWidth()&&this._itemsWidth-a>this.get("_width")&&this._findCurrentStartIndex()<this._itemOffsets.length-1},_getItemOffset:function(a,b){var c;if(b===void 0){b=this.get("_width")}var d=((c=this._itemOffsets[a])!==null&&c!==void 0?c:{offset:0}).offset;var e=this._fitsInWidth(b)?d:Math.max(b-(this._itemsWidth-d),0);return d-e},_findCurrentStartIndex:function(){var a=this.get("_offset");for(var b=0;b<this._itemOffsets.length;b++){var c=this._itemOffsets[b];if(Math.round(c.offset)>=Math.round(a)){return b}}return 0},_findNearestStartIndex:function(){var a=this.get("_offset");var b=0;var c=-1;for(var d=0;d<this._itemOffsets.length;d++){var e=this._itemOffsets[d];var f=Math.abs(a-e.offset);if(f<c||c===-1){b=d;c=f}}return b},_fitsInWidth:function(a){if(a===void 0){a=this.get("_width")}return this._itemsWidth<=a},_getOuterRectWidth:function(a){if(a.contentOuter){return a.contentOuter.width}var b=this.refs.contentOuter.getBoundingClientRect();return b?b.width:window.innerWidth},_measureItemOffsets:function(a,b){var c,d,e;if(b===void 0){b=true}if(!a.content){if(!this.refs.content){return}if(b){a.content=(c=this.refs.content.getBoundingClientRect())!==null&&c!==void 0?c:{width:window.innerWidth}}}this._itemsWidth=(e=(d=a.content)===null||d===void 0?void 0:d.width)!==null&&e!==void 0?e:this._itemsWidth;this._itemOffsets=[];var f;var g=0;var h=0;for(var i=0;i<this.refs.content.children.length;i++){var j=this.refs.content.children[i];var k=a[i];var l=this._itemOffsets[i];var m=this._getItemAbsoluteOffset(j,k,l),n=m[0],o=m[1];if(f===undefined){f=n}var p=n-f;var q=n-g-h;this._itemOffsets.push({offset:p,width:o,margin:q});g=n;h=0}},_getItemAbsoluteOffset:function(a){var b;var c=[];for(var d=1;d<arguments.length;d++){c[d-1]=arguments[d]}c=c.filter(function(a){return!!a});if(!c.length){c.push(a.getBoundingClientRect())}var e=c[0];return e?[(b=e.left)!==null&&b!==void 0?b:e.offset,e.width]:[0,0]},checkScrollEnd:function(){var a=this.hasNextControl();if(this._lastHasNextControl&&!a&&!this._fitsInWidth()){this.broadcast("scroll-end")}this._lastHasNextControl=a},getVisibleItemsCount:function(){var a=this.get("_width");var b=0;this._itemOffsets.forEach(function(c){if(c.offset+c.width<a){b++}});return b},handleAllBlocksRendered:function(){var a=this.getVisibleItemsCount();this.broadcast("all-blocks-rendered",{visibleItemsCount:a})}});exports.default=g});define("feast-tpl!app/feast-tpl!ui-block/unsubscribe/unsubscribe.html",["feast"],function(a){return a.smartParse('<div>\n\t<b:dropdown\n\t\t\tid="unsubscribe-dropdown"\n\t\t\tradar-id="unsubscribe"\n\t\t\ttext="{attrs[\'dropdown-button-text\']}"\n\t\t\tico="status_block"\n\t\t\tbase\n\t\t\tpure\n\t\t\ttouch="{attrs.touch}"\n\t\t\tshort="{attrs.touch || attrs.withoutText}"\n\t\t\tremit:dropdown-change-state="expanded"\n\t\t\texpand-left="{attrs[\'position-right\']}"\n\t\t\tauto-close="{false}"\n\t\t\tponymode="{attrs.ponymode}"\n\t\t\tpromoId="{attrs.promoId}"\n\t>\n\t\t<fn:match name="items" args="data">\n\t\t\t<fn:if test="data.attrs.expanded">\n\t\t\t\t<b:react-async\n\t\t\t\t\t\tcomponent="UnsubscribeDropdown"\n\t\t\t\t\t\tonButtonClick="{_this.onUnsubscribeButtonClick.bind(_this)}"\n\t\t\t\t\t\tonClose="{data.hide}"\n\t\t\t\t\t\tsenderName="{attrs.senderFrom}"\n\t\t\t\t\t\tlettersCount="{attrs[\'sender-letters\']}"\n\t\t\t\t\t\tinProgress="{attrs[\'in-progress\']}"\n\t\t\t\t\t\tuse:mediator="themes-manager"\n\t\t\t\t/>\n\t\t\t</fn:if>\n\t\t</fn:match>\n\t</b:dropdown>\n</div>\n',"app/feast-tpl!ui-block/unsubscribe/unsubscribe.html")});define("feast-tpl!ui-block/unsubscribe/unsubscribe.html",["feast-tpl!app/feast-tpl!ui-block/unsubscribe/unsubscribe.html"],function(a){return a});define("helpers/unsubscribe-actions",["exports"],function(exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var a=exports.EUnsubscribeAction={UNSUBSCRIBE:"unsubscribe_action",UNSUBSCRIBE_READ:"unsubscribe_read_action",UNSUBSCRIBE_REMOVE:"unsubscribe_remove_action"}});define("ui-block/unsubscribe/unsubscribe",["exports","default-values","feast","feast-mod/correspondents","feast-tpl!./unsubscribe.html","helpers/radar-utils","helpers/unsubscribe-actions","RPC","service/radars/decorator","service/radars/index","ui-block/dropdown/dropdown","ui-block/react-async/react-async"],function(exports,a,b,c,d,e,f,g,h,i,j,k){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var l=s(b);var m=s(d);var n=s(g);var o=s(h);var p=s(i);var q=s(j);var r=s(k);function s(a){return a&&a.__esModule?a:{default:a}}exports.default=l.default.Block.extend((0,o.default)({events:[{name:"unsubscribe",data:e.getModelData}]})({name:"unsubscribe",template:m.default,isolateEvents:false,mods:{correspondent:c.correspondent},blocks:{dropdown:q.default,"react-async":r.default},defaults:{"sender-letters":0,"dropdown-button-text":i18n("Отписаться от рассылки"),"is-component-visible":false,"actions-finished":false,"in-progress":false},events:{expanded:"handleExpandEvent"},attrChanged:{"actions-finished":function a(b){if(b){this.ids["unsubscribe-dropdown"].hide();this.set("in-progress",false)}},model:function b(){var c=this;(0,p.default)({type:"unsubscribe_button_show",intervals:[["button_position",this._getPositionString()]]});if(this.is("short")){this.set("dropdown-button-text",i18n("Отписаться"))}if(!a.UNSUBSCRIBE_COUNT_ALL){return}n.default.call("messages/count/all",{from:[this.get("senderFrom")],only_newsletters:true}).then(function(a){var b=a.body.count;if(!b){return}if(!c.is("is-component-visible")){c.set("sender-letters",b);(0,p.default)("unsubscribe_count_all-success")}}).catch(function(a){return(0,p.default)("unsubscribe_count_all-error",a)})}},onUnsubscribeButtonClick:function a(b){var c=this.get("letterId");var d=this.get("senderFrom");var e=this.get("insteadSpamButton");this.set("in-progress",true);(0,p.default)({type:"unsubscribe_button_click",intervals:[["action_type",b],["button_position",this._getPositionString()]],dwh:{position:e?"portal-menu":"default",action_type:b}});this.broadcast("unsubscribe",{ids:Array.isArray(c)?c:[c],position:e?"portal-menu":"default"});switch(b){case f.EUnsubscribeAction.UNSUBSCRIBE:return;case f.EUnsubscribeAction.UNSUBSCRIBE_REMOVE:this.broadcast("moveallfrom",{from:d});break;case f.EUnsubscribeAction.UNSUBSCRIBE_READ:this.broadcast("markallfrom",{from:d});break}},handleExpandEvent:function a(b){if(!b.details){return}var c=b.details.state;if(c){(0,p.default)({type:"unsubscribe_open_click",intervals:[["button_position",this._getPositionString()]]})}this.set("is-component-visible",c)},_getPositionString:function a(){return this.is("position-right")?"right":"left"}}))});define("feast-tpl!app/feast-tpl!ui-block/layer-cleanmaster-modal/layer-cleanmaster-modal.html",["feast"],function(a){return a.smartParse('<div\n  ref="layer-cleanmaster-modal"\n>\n</div>\n',"app/feast-tpl!ui-block/layer-cleanmaster-modal/layer-cleanmaster-modal.html")});define("feast-tpl!ui-block/layer-cleanmaster-modal/layer-cleanmaster-modal.html",["feast-tpl!app/feast-tpl!ui-block/layer-cleanmaster-modal/layer-cleanmaster-modal.html"],function(a){return a});var __assign=this&&this.__assign||function(){__assign=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++){b=arguments[c];for(var e in b)if(Object.prototype.hasOwnProperty.call(b,e))a[e]=b[e]}return a};return __assign.apply(this,arguments)};var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("ui-block/layer-cleanmaster-modal/layer-cleanmaster-modal",["require","exports","@mail/features","@mail/xray","default-values","feast","feast-tpl!./layer-cleanmaster-modal.html","mediator/unsubscribe-actions","service/notify"],function(require,exports,a,b,c,d,e,f,g){"use strict";Object.defineProperty(exports,"__esModule",{value:true});a=__importDefault(a);b=__importDefault(b);d=__importDefault(d);e=__importDefault(e);f=__importDefault(f);g=__importDefault(g);var h=function(a){var b=a.text,d=a.qa;g.default.add({text:b,qa:d,duration:c.SETTINGS_DOCK_CLEANMASTER_NOTIFY_DURATION,inline:false})};var i=function(a){var b=a.text,d=a.qa;g.default.error({text:b,qa:d,duration:c.SETTINGS_DOCK_CLEANMASTER_NOTIFY_DURATION,inline:false})};var j={remove:"@modal/senders/remove",unsubscribe:"@modal/senders/unsubscribe"};exports.default=d.default.Block.extend({name:"layer-cleanmaster-modal",template:e.default,blocks:{},_modalPage:null,defaults:{compact:false,isAvailable:false},events:{},_isValidAction:function(a){return a in j},didMount:function(){var c=this;var d=this.refs["layer-cleanmaster-modal"];var e=this.get("ponymode");var g=this.get("action");var k=this.get("from");var l=this.onClose.bind(this);if(!this._isValidAction(g)){this.set("isAvailable",false);return}window.require(["cleanmaster"],function(m){c._modalPage=m.createCleanmasterModal(d,{features:a.default,septima:false,app:false,touch:false,octavius:true,headerMode:"hidden",isDockSettings:false,compact:e});var n={"@stat/radar":function(a){var c=a.name,d=a.params,e=a.dwh,f=e===void 0?{}:e;b.default.send(c,{i:d,v:1,dwh:__assign(__assign({},f),{query:true})})},"@clean/clean/success":function(a){var b=a.senders,c=b===void 0?[]:b;f.default.deleteSenderFromUnsubscribeList(c.map(function(a){var b=a.emails;return b}))},"@notify/success":h,"@notify/info":h,"@notify/error":i,"@redux-popup/popup/CLOSE_ALL":l};Object.keys(n).forEach(function(a){c._modalPage.on(a,n[a])});c._modalPage.create();c._modalPage.store.dispatch({type:j[g],payload:{sendersEmailList:k}})});this.set("isAvailable",true)},onClose:function(){var a;var b=this.get("isAvailable");if(!b){return}(a=this._modalPage)===null||a===void 0?void 0:a.destroy();this.set("isAvailable",false);this.broadcast("layer:close")}})});define("feast-tpl!app/feast-tpl!ui-block/layer-edit-settings-filter/layer-edit-settings-filter.html",["feast"],function(a){return a.smartParse('<div>\n\t<fn:match name="spinner">\n\t\t<div bem:elem="spinner-container">\n\t\t\t<b:spinner/>\n\t\t</div>\n\t</fn:match>\n\n\t<b:layer name="edit-settings-filter"\n\t\t\t remit:close="layer:close"\n\t\t\t center\n\t\t\t hiddenfooter\n\t\t\t standard>\n\n\t\t<fn:match name="content">\n\t\t\t<div class="layer-edit-settings-filter_content" ref="content">\n\t\t\t\t<fn:apply-match name="spinner"/>\n\t\t\t</div>\n\t\t</fn:match>\n\t</b:layer>\n</div>\n',"app/feast-tpl!ui-block/layer-edit-settings-filter/layer-edit-settings-filter.html")});define("feast-tpl!ui-block/layer-edit-settings-filter/layer-edit-settings-filter.html",["feast-tpl!app/feast-tpl!ui-block/layer-edit-settings-filter/layer-edit-settings-filter.html"],function(a){return a});var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("filters/actions/Edit",["require","exports","RPC","Action","filters/Filter"],function(require,exports,a,b,c){"use strict";a=__importDefault(a);b=__importDefault(b);c=__importDefault(c);var d=b.default.extend({url:c.default.url("edit"),prepare:function(a){return this._removeEmptyParams(a)},_removeEmptyParams:function(a){a.filters.forEach(function(a){if(a.actions.notify&&!a.actions.notify.length){delete a.actions.notify}if(a.actions.replace_category===null){delete a.actions.replace_category}});return a},operation:function(b){var c={};b.filters.forEach(function(a,b){if(!a.id){c["filters."+b+".id"]="required"}});if(Object.keys(c).length){return Promise.reject(c)}return a.default.call(this.url,b).then(function(a){return d.processResult(b,a)})}});d.processResult=function(a,b){return c.default.map(a.filters.map(function(a,c){a.id=b.get("body."+c);a.apply_folders=b.get("data.apply_folders");if(!a.conditions){a.conditions=[]}return a}))};b.default.register("filters.Edit",d);d.version="0.1.0";exports.default=d;return d});var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("ui-block/layer-edit-settings-filter/layer-edit-settings-filter",["require","exports","data-source/index","default-values","feast","feast-tpl!./layer-edit-settings-filter.html","filters/actions/Edit","filters/actions/SaveSeveral","filters/Filter","helpers/define-utils","mail/Folder","service/getModule","service/notify","service/radars/decorator","service/radars/index","service/secure-folder","ui-block/layer/layer","ui-block/spinner/spinner"],function(require,exports,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){"use strict";Object.defineProperty(exports,"__esModule",{value:true});a=__importDefault(a);c=__importDefault(c);d=__importDefault(d);e=__importDefault(e);f=__importDefault(f);g=__importDefault(g);i=__importDefault(i);j=__importDefault(j);k=__importDefault(k);l=__importDefault(l);m=__importDefault(m);n=__importDefault(n);o=__importDefault(o);p=__importDefault(p);exports.default=c.default.Block.extend((0,l.default)()({name:"layer-edit-settings-filter",template:d.default,blocks:{layer:o.default,spinner:p.default},events:{close:"onClose",cancel:"onCancel"},defaults:{filterModel:{},applyFolders:[],expandExtendOptions:false},onLoad:function(){},onClose:function(){this.broadcast("layer:close")},onCancel:function(){},didUnmount:function(){this.editor.unmount()},load:function(){var a=this;return new Promise(function(b){Promise.all([(0,j.default)("blitz")]).then(function(){(0,h.defineExternalForSyncUse)("filters/actions/Edit",e.default);(0,h.defineExternalForSyncUse)("filters/Filter",g.default);(0,h.defineExternalForSyncUse)("filters/actions/SaveSeveral",f.default);(0,j.default)("filters.mail.ru").then(function(c){a.ui=c;require(["mediator/themes-manager"],function(c){var d=c.default;d.register(a);b()})})})})},didMount:function(){var c=this;this.load().then(function(){if(!c.isMounted()){return}var d=c.refs.content;c.editor=new c.ui(d);c.editor.mount({model:c.get("filterModel"),templateValues:c.get("templateValues"),expandExtendOptions:c.get("expandExtendOptions"),useBlackTheme:c.is("dark-mode"),useOctaviusTheme:true,autoreplyLink:b.SETTINGS_AUTOREPLY_LINK,config:{radar:{p:b.RADAR_PROJECT},popup:true},onClose:function(){c.onClose()},onCancel:function(){c.onClose()},successSave:function(){c.onClose();setTimeout(function(){a.default.updateAll()},b.FILTER_SAVE_UPDATE_TIMEOUT);k.default.add({text:i18n("Фильтр успешно создан")})},successApply:function(){setTimeout(function(){a.default.updateAll()},b.FILTER_SAVE_UPDATE_TIMEOUT)},onSendRadar:m.default,onFolderNeedOpen:function(a){return i.default.findOne({id:a}).then(function(a){return(0,n.default)(a)}).then(function(a){return!a&&Promise.reject()})}})})}}))});define("feast-tpl!app/feast-tpl!ui-block/layer-create-folder/layer-create-folder.html",["feast"],function(a){return a.smartParse("<div/>\n","app/feast-tpl!ui-block/layer-create-folder/layer-create-folder.html")});define("feast-tpl!ui-block/layer-create-folder/layer-create-folder.html",["feast-tpl!app/feast-tpl!ui-block/layer-create-folder/layer-create-folder.html"],function(a){return a});var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("ui-block/layer-create-folder/layer-create-folder",["require","exports","@mail/features","data-source/index","feast","feast-tpl!./layer-create-folder.html","mail/Folder","service/getModule","service/mailbox/loader","service/notify","service/secure-folder","service/themes.setup"],function(require,exports,a,b,c,d,e,f,g,h,i,j){"use strict";Object.defineProperty(exports,"__esModule",{value:true});a=__importDefault(a);b=__importDefault(b);c=__importDefault(c);d=__importDefault(d);e=__importDefault(e);f=__importDefault(f);g=__importDefault(g);h=__importDefault(h);i=__importDefault(i);j=__importDefault(j);function k(a){return(a===null||a===void 0?void 0:a.moveLetters)===true}exports.default=c.default.Block.extend({name:"layer-create-folder",template:d.default,defaults:{mode:"new",model:null,selectMode:false},registerInMediators:function(){var a=this;return new Promise(function(b){require(["mediator/letters-selection"],function(c){var d=c.default;d.register(a);b()})})},didMount:function(){var c=this;var d=this.attrs,h=d.model,l=d.mode;this.registerInMediators().then(function(){if(!c.isMounted()){return}var d=false;var m=null;if(k(h)){d=h.moveLetters;m=h.letterCurrentFolder}var n=l==="edit"||d?null:h;var o=c.get("selectMode");var p=d?function(a){g.default.invalidateCache();c.broadcast("move",{id:a.id,selection:o})}:function(){g.default.invalidateCache();b.default.updateAll()};Promise.all([(0,f.default)("react"),(0,f.default)("blitz")]).then(function(b){var f;var g=b[0],k=b[1],o=k.CreateFolder,q=k.LayerManager;if(!c.isMounted()){return}var r=c.layerManager||new q;r.setup(c.el,{popup:false,radarPrefix:"folders-lr"});var s={mode:l,folder:l==="edit"?h:new e.default({name:""}),parentFolder:n,folders:e.default.all,FEATURES:a.default,onClose:c.onClose.bind(c),onError:c.onError.bind(c),handleFinal:p,isMoveLetters:d,letterCurrentFolder:m,openSecureFolder:i.default,layerManager:r,isDarkMode:!!((f=j.default.getSelectedModel())===null||f===void 0?void 0:f.isDarkMode())};var t=r.openLayer(g.createElement(o,s),{noPanelWrap:true,responsive:"auto"}).id;c.layerManager=r;c.id=t})})},onError:function(a){h.default.add({type:h.default.types.error,text:i18n("Что-то пошло не так!"),unique:true})},onClose:function(){this.broadcast("layer:close");if(this.layerManager){this.layerManager.destroyLayer(this.id)}}})});define("feast-tpl!app/feast-tpl!ui-block/layer-confirm-delete-folder/layer-confirm-delete-folder.html",["feast"],function(a){return a.smartParse('<div qa:id="layer-confirm-delete-folder">\n\t<fn:var name="messages" value="{_this.getMessages()}"/>\n\n\t<bem:mod name="touch" test="attrs.mobile"/>\n\t<bem:mod name="full" test="!attrs.mobile"/>\n\t<bem:mod name="hidden" test="attrs.hidden"/>\n\n\t<b:layer\n\t\t\tremit:close="layer:close"\n\t\t\tmodel="{attrs.model}"\n\t\t\terror="{attrs.error}"\n\t\t\tmobile="{attrs.mobile}"\n\t\t\tprocessing="{attrs.processing}"\n\t\t\tname="confirm-clear-folder"\n\t\t\tclose\n\t\t\theader\n\t\t\tfooter\n\t\t\tcenter\n\t\t\tstandard\n\t\t\tresolvable\n\t>\n\n\t\t<fn:match name="header" args="attrs">\n\t\t\t{messages.confirm}\n\t\t</fn:match>\n\n\t\t<fn:match name="content" args="attrs">\n\t\t\t<fn:if test="attrs.error">\n\t\t\t\t<div bem:elem="error" qa:id="{attrs.error}">\n\t\t\t\t\t{messages[attrs.error]}\n\t\t\t\t</div>\n\t\t\t</fn:if>\n\t\t\t{i18n(\'Все письма будут перенесены в папку «Корзина».\')}\n\t\t</fn:match>\n\n\t\t<fn:match name="footer" args="attrs">\n\t\t\t<div bem:elem="submit-button">\n\t\t\t\t<b:button2\n\t\t\t\t\t\tremit:click="layer:resolve"\n\t\t\t\t\t\tdisabled="{attrs.processing}"\n\t\t\t\t\t\ttext="{i18n(\'Удалить\')}"\n\t\t\t\t\t\tprimary\n\t\t\t\t\t\tfluid\n\t\t\t\t\t\ttouch="{attrs.mobile}"\n\t\t\t\t\t\tqa:id="submit"\n\t\t\t\t/>\n\t\t\t</div>\n\n\t\t\t<div bem:elem="cancel-button">\n\t\t\t\t<b:button2\n\t\t\t\t\t\tremit:click="layer:close"\n\t\t\t\t\t\tdisabled="{attrs.processing}"\n\t\t\t\t\t\ttext="{i18n(\'Отменить\')}"\n\t\t\t\t\t\tfluid\n\t\t\t\t\t\ttouch="{attrs.mobile}"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</fn:match>\n\n\t</b:layer>\n</div>\n',"app/feast-tpl!ui-block/layer-confirm-delete-folder/layer-confirm-delete-folder.html")});define("feast-tpl!ui-block/layer-confirm-delete-folder/layer-confirm-delete-folder.html",["feast-tpl!app/feast-tpl!ui-block/layer-confirm-delete-folder/layer-confirm-delete-folder.html"],function(a){return a});var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("ui-block/layer-confirm-delete-folder/layer-confirm-delete-folder",["require","exports","feast","feast-tpl!./layer-confirm-delete-folder.html","ui-block/button2/button2","ui-block/layer/layer"],function(require,exports,a,b,c,d){"use strict";Object.defineProperty(exports,"__esModule",{value:true});a=__importDefault(a);b=__importDefault(b);c=__importDefault(c);d=__importDefault(d);exports.default=a.default.Block.extend({name:"layer-confirm-delete-folder",template:b.default,blocks:{layer:d.default,button2:c.default},events:{"layer:resolve":"onConfirm"},defaults:{processing:false,error:null},getMessages:function(){return{confirm:i18n("Удалить папку «{folderName}»?",{folderName:this.attrs.model.get("name")}),isCollectorRoot:i18n("Нельзя удалить папку, так как в неё собирается почта из другого ящика"),systemFolder:i18n("Невозможно удалить системную папку"),folderNotExists:i18n("Папка больше не существует"),invalidFolder:i18n("Невозможно удалить папку"),unknownError:i18n("Произошла неизвестная ошибка")}},onConfirm:function(){if(this.is("processing")||this.is("error")){return}this.set("processing",true)}})});define("feast-tpl!app/feast-tpl!ui-block/layer-metathreads-settings/layer-metathreads-settings.html",["feast"],function(a){return a.smartParse('<div qa:id="layer-metathreads-settings" promo:id="layer-metathreads-settings">\n\t<b:react-async\n\t\tkey="{attrs.metathreadsData.length}"\n\t\tcomponent="MetathreadsSettingsContainer"\n\t\tlayer\n\t\tdarkMode="{attrs[\'dark-mode\']}"\n\t\tmetathreadsData="{attrs.metathreadsData}"\n\t\tonHelpClick="{_this.onHelpClick}"\n\t\tonSettingsEdit="{_this.onSettingsEdit}"\n\t\tonCreateFilter="{_this.onCreateFilter}"\n\t\tfiltersCount="{attrs.metathreadsFiltersCount}"\n\t\tfiltersCountLoading="{attrs.metathreadsFiltersCountLoading}"\n\t\tonClose="{_this.onClose}"\n\t\tuse:mediator="settings-manager themes-manager folders-actions"\n\t/>\n</div>\n',"app/feast-tpl!ui-block/layer-metathreads-settings/layer-metathreads-settings.html")});define("feast-tpl!ui-block/layer-metathreads-settings/layer-metathreads-settings.html",["feast-tpl!app/feast-tpl!ui-block/layer-metathreads-settings/layer-metathreads-settings.html"],function(a){return a});var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("ui-block/layer-metathreads-settings/layer-metathreads-settings",["require","exports","data-source/actions","feast","feast-tpl!./layer-metathreads-settings.html","helpers/data-source-dispatch","service/radars/decorator","ui-block/layer/layer","ui-block/react-async/react-async"],function(require,exports,a,b,c,d,e,f,g){"use strict";Object.defineProperty(exports,"__esModule",{value:true});b=__importDefault(b);c=__importDefault(c);d=__importDefault(d);e=__importDefault(e);f=__importDefault(f);g=__importDefault(g);exports.default=b.default.Block.extend((0,e.default)({events:[{name:"help:open",rename:"help_open"}]})({name:"layer-metathreads-settings",template:c.default,defaults:{helpLink:"metathreads",metathreadsData:[],metathreadsFiltersCount:0,metathreadsFiltersCountLoading:false},blocks:{layer:f.default,"react-async":g.default},constructor:function(){b.default.Block.apply(this,arguments);this.onClose=this.onClose.bind(this);this.onSettingsEdit=this.onSettingsEdit.bind(this);this.onHelpClick=this.onHelpClick.bind(this)},onClose:function(){this.broadcast("layer:close")},uid:0,onSettingsEdit:function(b){var c=this;return(0,d.default)({type:a.EDIT_METATHREADS_SETTINGS,uid:this.uid++,settings:b}).then(function(a){c.broadcast("metathreads:settings:updated");return a})},onHelpClick:function(){this.broadcast("help:open",this.attrs.helpLink)},onCreateFilter:function(){this.broadcast("metathreads:filters:create")}}))});!function(a,b){if("object"==typeof exports&&"object"==typeof module)module.exports=b(require("@mail/xray"),require("RPC/statuses/sdc"),require("cfgUser"),require("default-values"),require("logger"),require("request"),require("service/notify"),require("service/storage"));else if("function"==typeof define&&define.amd)define("vk-messenger",["@mail/xray","RPC/statuses/sdc","cfgUser","default-values","logger","request","service/notify","service/storage"],b);else{var c="object"==typeof exports?b(require("@mail/xray"),require("RPC/statuses/sdc"),require("cfgUser"),require("default-values"),require("logger"),require("request"),require("service/notify"),require("service/storage")):b(a["@mail/xray"],a["RPC/statuses/sdc"],a.cfgUser,a["default-values"],a.logger,a.request,a["service/notify"],a["service/storage"]);for(var d in c)("object"==typeof exports?exports:a)[d]=c[d]}}(self,function(a,b,c,d,e,f,g,h){return function(){"use strict";var i={8556:function(a,b){Object.defineProperty(b,"__esModule",{value:!0}),b.Tag=void 0,function(a){a.Core="core",a.Global="gl",a.Self="self",a.Async="async",a.Ignore="ign",a.Known="known",a.API="api",a.Shared="shr",a.Ext="ext",a.ThirdParty="3rd",a.RB="rb",a.Unknown="unk"}(b.Tag||(b.Tag={}))},2204:function(a,b,c){Object.defineProperty(b,"__esModule",{value:!0}),b.coreLoggerHMR=b.coreLoggerDispatchKnownError=b.coreLoggerDispatchAPIError=b.coreLoggerDispatchIgnoredError=b.coreLoggerDispatchSelfError=b.coreLoggerDispatchReactError=b.coreLoggerDispatchError=b.getCoreLogger=b.Tag=void 0;var d=c(8556);Object.defineProperty(b,"Tag",{enumerable:!0,get:function(){return d.Tag}});b.getCoreLogger=function(){return"undefined"!=typeof coreLogger?coreLogger:void 0};b.coreLoggerDispatchError=function(a,c,d){var e;null===(e=(0,b.getCoreLogger)())||void 0===e||e.dispatchError(a,c,d)};b.coreLoggerDispatchReactError=function(a,c,d){var e;null===(e=(0,b.getCoreLogger)())||void 0===e||e.dispatchReactError(a,c,d)};b.coreLoggerDispatchSelfError=function(a,c,e,f){(0,b.coreLoggerDispatchError)(c,e,{category:a,tag:d.Tag.Self,log:f})};b.coreLoggerDispatchIgnoredError=function(a,c,e,f){(0,b.coreLoggerDispatchError)(c,e,{category:a,tag:d.Tag.Ignore,log:f})};b.coreLoggerDispatchAPIError=function(a,c,e,f){(0,b.coreLoggerDispatchError)(c,e,{category:a,tag:d.Tag.API,log:f})};b.coreLoggerDispatchKnownError=function(a,c,e,f){(0,b.coreLoggerDispatchError)(c,e,{category:a,tag:d.Tag.Known,log:f})};b.coreLoggerHMR=function(a,c){var d=(0,b.getCoreLogger)();if(d){var e=d.errors.rules,f=d.errors.opts.errors,g=a.priority||[];if(e.set("clear"),f&&f.rules)e.set(f.rules),g.push.apply(g,[].concat(f.priority||Object.keys(f.rules)));if(c)e.set(c.rules),g.push.apply(g,c.priority||[]);e.set(a.rules),e.priority(g);try{d.pkg.v=process.env.PACKAGE_VERSION,localStorage.setItem(process.env.LOGGER_LS_PRESET_VER_KEY,process.env.PACKAGE_VERSION)}catch(a){}}}},5881:function(a,b,c){var d=this&&this.__createBinding||(Object.create?function(a,b,c,d){if(void 0===d)d=c;var e=Object.getOwnPropertyDescriptor(b,c);if(!e||("get"in e?!b.__esModule:e.writable||e.configurable))e={enumerable:!0,get:function(){return b[c]}};Object.defineProperty(a,d,e)}:function(a,b,c,d){if(void 0===d)d=c;a[d]=b[c]}),e=this&&this.__exportStar||function(a,b){for(var c in a)if("default"!==c&&!Object.prototype.hasOwnProperty.call(b,c))d(b,a,c)};Object.defineProperty(b,"__esModule",{value:!0}),b.createScopeEntry=b.createLogEntry=b.createLogger=b.octoLogger=b.logger=void 0,e(c(2204),b);var f=c(1862);Object.defineProperty(b,"logger",{enumerable:!0,get:function(){return f.logger}}),Object.defineProperty(b,"octoLogger",{enumerable:!0,get:function(){return f.octoLogger}}),Object.defineProperty(b,"createLogger",{enumerable:!0,get:function(){return f.createLogger}}),Object.defineProperty(b,"createLogEntry",{enumerable:!0,get:function(){return f.createLogEntry}}),Object.defineProperty(b,"createScopeEntry",{enumerable:!0,get:function(){return f.createScopeEntry}})},6947:function(a,b,c){Object.defineProperty(b,"__esModule",{value:!0}),b.browserFormat=b.resetFormatStyle=b.nodeFromat=b.createFormat=void 0;var d=c(6117),e=/:([^;]+)/g;function f(a,b){return function(c){return b(c,{base:a.level[c.level]||"",label:a.label[c.level]||""})}}b.createFormat=f,b.nodeFromat=f({level:{log:"[0m",info:"[34m",done:"[34m",warn:"[33m",error:"[31m",verbose:"[35m"},label:{log:"[4m",info:"[4m",done:"[4m",error:"[4m",warn:"[4m",verbose:"[4m"}},function(a,b){var c=[];if(null!=a.badge)c.push(a.badge);if(null!=a.label)c.push("".concat(b.base).concat(b.label).concat(a.label,"[0m"));if(null!=a.args)c.push.apply(c,a.args);if(null!==a.meta)c.push("".concat(a.meta.file,":").concat(a.meta.line,":").concat(a.meta.col));return c.push("[0m"),c});var g="text-decoration: underline; font-weight: bold;";function h(a){return a.replace(e,": inherit")}b.resetFormatStyle=h,b.browserFormat=f({level:{log:"color: #333;",info:"color: dodgerblue;",done:"color: #1aaa55;",warn:"color: orange;",error:"color: red;",verbose:"color: magenta;"},label:{log:g,info:g,done:g,warn:g,error:g,verbose:g}},function(a,b){var c=[],e=[],f=a.args;if(a.ts>0)e.push("%c[%s] "),c.push(b.base,(0,d.timeFormat)(a.ts));if(null!=a.badge)e.push("%s"),c.push(a.badge);if(null!=a.label)e.push("%c%s%c "),c.push(b.label+b.base,a.label,h(b.label));if(null!=f){var g=f.length;if(g>0){e.push("%c"),c.push(b.base);for(var i=0;i<g;i++){var j=f[i];e.push("".concat("string"==typeof j?"%s":"%o"," ")),c.push(j)}}}if(null!=a.meta)e.push("%s"),c.push("".concat(a.meta.file,":").concat(a.meta.line,":").concat(a.meta.col));return c.unshift(e.join("")),c})},1862:function(a,b,c){var d=this&&this.__assign||function(){return(d=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])if(Object.prototype.hasOwnProperty.call(b,e))a[e]=b[e];return a}).apply(this,arguments)};Object.defineProperty(b,"__esModule",{value:!0}),b.octoLogger=b.logger=b.createLogger=b.revertLoggerContext=b.switchLoggerContext=b.getLoggerContext=b.createScopeEntry=b.createLogEntry=b.isLogEntry=void 0;var e=c(7111),f=c(6117),g=c(5302),h=new Date,i=0;function j(a){return a&&3===a.length&&a[0]&&a[1]>0&&a[2]>0}function k(a){return{file:a[0],line:a[1],col:a[2]}}function l(a){return a&&void 0!==a.type&&void 0!==a.level}function m(a,b,c,d,e){return Object.defineProperty({cid:++i,ts:0,type:a,level:b,badge:c,label:d,args:e,meta:null,entries:[]},"parent",{writable:!0,enumerable:!1,value:null})}function n(a,b,c,d){return m(g.ENTRY,a,b,c,d)}function o(a,b,c,d){return m(g.SCOPE,a,b,c,d)}b.isLogEntry=l,b.createLogEntry=n,b.createScopeEntry=o;var p=null;function q(a,b){var c=function(b){return{add:function(){for(var c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];var e,g=j(c[0])?k(c.shift()):null;if(l(c[0]))e=c[0];else e=n("log",null,null,c);if(null!==g)e.meta=g;if(a.time)e.ts=(0,f.now)();var h=b.parent;if(h){var i=(e.parent=h).entries.push(e);if(i>a.storeLast)h.entries.splice(0,1)}if(!0!==a.silent&&a.output)a.output(e);return e}}},e=o("info","🚧","#root",[{time:h,created:new Date}]),i={logger:null,parent:e},m=c(i),q=b({createEntry:n,logger:m});if(null==a.silent&&"undefined"!=typeof location)a.silent=!/^(about:|file:|https?:\/\/localhost\/)/.test("".concat(location));if(null==a.time)a.time=!0;if(null==a.storeLast)a.storeLast=1e3;return i.logger=m,["add","clear","scope","setup","entries","last","priny","m"].forEach(function(a){if(q.hasOwnProperty(a))throw new Error('[octoLogger] "'.concat(a,'" is a reserved identifier'))}),q.print=function(){if(function b(c){c.printed=!1,c.entries.forEach(function(c){if(c.printed=!1,a.output)a.output(c);if(c.type===g.SCOPE)b(c)})}(e),a.output)a.output(null)},q.add=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return m.add.apply(m,a)},q.clear=function(){return e.entries.splice(0,e.entries.length)},q.setup=function(b){a=d(d({},a),b)},q.entries=function(){return e.entries},q.last=function(){return e.entries[e.entries.length-1]||null},q.scope=function d(e,f,g){var h=arguments,m=null;if(0===h.length)return this._scopeEntry;if(j(h[0]))m=k(h[0]),e=h[1],f=h[2],g=h[3];var q=h.length>2;if(null==g&&"function"==typeof f)g=f,q=!1;var r=[e];if(q)r.push(f);var s=l(e)?e:o("info",null,null,r);s.meta=m,i.logger.add(s);var t=c({parent:s,logger:null}),u=b({createEntry:n,logger:t});if(u.add=function(){return t.add.apply(t,arguments)},u.scope=d,u._scopeEntry=s,"function"==typeof g){var v=p,w=i.parent,x=i.logger;p={entry:s,scope:u,logger:t,options:a,scopeContext:i},i.parent=s,g(u),p=v,i.parent=w,i.logger=x}return u},q}b.getLoggerContext=function(){return p},b.switchLoggerContext=function(a,b){if(null===a)return p=null,null;var c=p,d=a.scope,e=a.scopeContext,f=null;if(p=a,a.scope=b,a.scopeContext)f=a.scopeContext.parent,a.scopeContext.parent=b.scope();return{activeContext:c,ctx:a,scope:d,scopeContext:e,scopeContextParent:f}},b.revertLoggerContext=function(a){var b=a.ctx,c=a.scopeContext;if(b.scope=a.scope,b.scopeContext=c,c)c.parent=a.scopeContextParent;p=a.activeContext},b.createLogger=q;var r={log:null,info:"❕ ",done:"✅ ",warn:"⚠️ ",error:"🛑 ",verbose:"🔎 "};b.logger=q({output:(0,e.universalOutput)()},function(a){var b=a.logger;return Object.keys(r).reduce(function(a,c){return a[c]=function(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];b.add(n(c,r[c]||null,null,a))},a},{})}),b.octoLogger=b.logger},5302:function(a,b){Object.defineProperty(b,"__esModule",{value:!0}),b.SCOPE=b.ENTRY=void 0,b.ENTRY=1,b.SCOPE=2},7111:function(a,b,c){Object.defineProperty(b,"__esModule",{value:!0}),b.universalOutput=b.browserOutput=b.nodeOutput=b.createOutput=void 0;var d=c(6947),e=c(5302);b.createOutput=function(a){var b=a.out,c=a.format,d=b.log,f={},g=[];return function a(h,i){if(null===h)return g.forEach(function(){b.groupEnd()}),void(g.length=0);var j=h.parent,k=g.length;if(!i||!h.printed){if(k>0){for(var l=k;l--&&g[l]!==j;)g[l].printed=!0,b.groupEnd();g.length=l+1}if(h.type===e.SCOPE)g.push(h),b.group.apply(b,c(h));else{if(!i&&j&&j.printed&&"#root"!==j.label)return void(f[j.cid]||(f[j.cid]=setTimeout(function(){g.forEach(function(){b.groupEnd()}),g.length=0;var d=[],e=j;do{d.unshift(e),e=e.parent}while(e&&"#root"!==e.label);d.forEach(function(a){b.group.apply(b,c(a))}),j.entries.forEach(function(b){a(b,!0)}),d.forEach(function(){b.groupEnd()})},0)));h.printed=!0,d.apply(b,c(h))}}}};b.nodeOutput=function(a){if(void 0===a)a={};return(0,b.createOutput)({out:a.out||console,format:a.format||d.nodeFromat})};b.browserOutput=function(a){if(void 0===a)a={};return(0,b.createOutput)({out:a.out||console,format:a.format||d.browserFormat})},b.universalOutput="undefined"==typeof self?b.nodeOutput:b.browserOutput},6117:function(a,b){function c(a,b){var c=a<10?"0".concat(a):a;if(b>1&&a<100)c="0".concat(c);return c}Object.defineProperty(b,"__esModule",{value:!0}),b.timeFormat=b.zeroPad=b.now=void 0,b.now="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:Date.now,b.zeroPad=c,b.timeFormat=function(a){var b=a/1e3;return"".concat(c(b/60%24|0),":").concat(c(b%60|0),".").concat(c(a%1e3|0,2))}},1373:function(b){b.exports=a},3169:function(a){a.exports=b},5261:function(a){a.exports=c},1791:function(a){a.exports=d},7920:function(a){a.exports=e},3440:function(a){a.exports=f},8624:function(a){a.exports=g},7050:function(a){a.exports=h}},j={};function k(a){var b=j[a];if(void 0!==b)return b.exports;var c=j[a]={exports:{}};return i[a].call(c.exports,c,c.exports,k),c.exports}k.n=function(a){var b=a&&a.__esModule?function(){return a.default}:function(){return a};return k.d(b,{a:b}),b},k.d=function(a,b){for(var c in b)if(k.o(b,c)&&!k.o(a,c))Object.defineProperty(a,c,{enumerable:!0,get:b[c]})},k.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},k.r=function(a){if("undefined"!=typeof Symbol&&Symbol.toStringTag)Object.defineProperty(a,Symbol.toStringTag,{value:"Module"});Object.defineProperty(a,"__esModule",{value:!0})};var l={};return function(){k.r(l),k.d(l,{vkMessenger:function(){return Pb}});var a=k(1373),b=k.n(a);function c(a){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function d(a){return(d="function"==typeof Symbol&&"symbol"==c(Symbol.iterator)?function(a){return c(a)}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":c(a)})(a)}var e=["vk.com","vk.ru"],f=["agreements","promo","vkc_behavior","vkc_auth_action","vkc_brand","vkc_display_mode","service_groups","external_device_id"],g=!("undefined"==typeof window||!window.document||!window.document.createElement),h=g&&!!window.addEventListener;function i(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}function j(a,b){return a(b={exports:{}},b.exports),b.exports}var m=i(j(function(a){function b(d){return"function"==typeof Symbol&&"symbol"==c(Symbol.iterator)?(a.exports=b=function(a){return c(a)},a.exports.default=a.exports,a.exports.__esModule=!0):(a.exports=b=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":c(a)},a.exports.default=a.exports,a.exports.__esModule=!0),b(d)}a.exports=b,a.exports.default=a.exports,a.exports.__esModule=!0})),n=function(){};if(h)try{var o=Object.defineProperty({},"passive",{get:function(){}});window.addEventListener("test",n,o),window.removeEventListener("test",n,o)}catch(d){}!function(){if(!g)return!1;try{document.createElement("div").scrollTo({top:0,get behavior(){return!0,"smooth"}})}catch(a){}}();var p=j(function(a){a.exports=function(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=new Array(b);c<b;c++)d[c]=a[c];return d},a.exports.default=a.exports,a.exports.__esModule=!0});i(p);var q=j(function(a){a.exports=function(a){if(Array.isArray(a))return p(a)},a.exports.default=a.exports,a.exports.__esModule=!0});i(q);var r=j(function(a){a.exports=function(a){if("undefined"!=typeof Symbol&&null!=a[Symbol.iterator]||null!=a["@@iterator"])return Array.from(a)},a.exports.default=a.exports,a.exports.__esModule=!0});i(r);var s=j(function(a){a.exports=function(a,b){if(a){if("string"==typeof a)return p(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(a):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?p(a,b):void 0}},a.exports.default=a.exports,a.exports.__esModule=!0});i(s);var t=j(function(a){a.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},a.exports.default=a.exports,a.exports.__esModule=!0});i(t),i(j(function(a){a.exports=function(a){return q(a)||r(a)||s(a)||t()},a.exports.default=a.exports,a.exports.__esModule=!0}));var u=i(j(function(a){a.exports=function(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a},a.exports.default=a.exports,a.exports.__esModule=!0}));function v(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function w(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{};b%2?v(Object(c),!0).forEach(function(b){u(a,b,c[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):v(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}return a}var x=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"!==m(a)||null===a)return"";b=w({encode:!0},b);var c=function(a){return b.encode?encodeURIComponent(a):String(a)};return Object.keys(a).reduce(function(d,e){var f=a[e];return void 0===f?d:null===f?(b.skipNull||d.push([c(e),""].join("=")),d):Array.isArray(f)?(f.map(function(a){d.push("".concat(c(e),"[]=").concat(c(a)))}).join(),d):(d.push([c(e),c(f)].join("=")),d)},[]).join("&")};function y(a){return x(a,{skipNull:!0})}function z(a){return Object.keys(a).filter(function(a){return f.includes(a)})}function A(a){var b;return Boolean(null===(b=z(a))||void 0===b?void 0:b.length)}function B(a){var b=function(a){return z(a).reduce(function(b,c){return b[c]=a[c],b},{})}(a);return btoa(JSON.stringify(b))}function C(a,b){var c,d,e=document.createElement("iframe");for(var f in a&&(e.src=a),e.style.cssText=null!==(c=null==b?void 0:b.cssText)&&void 0!==c?c:"",e.width="100%",e.height="100%",e.style.border="none",null==b?void 0:b.properties)b&&b.properties.hasOwnProperty(f)&&(e[f]=null!==(d=b.properties[f])&&void 0!==d?d:"");return e}function D(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];var c=function(a){return a&&"object"===d(a)};return a.reduce(function(a,b){return Object.keys(b).forEach(function(d){var e=a[d],f=b[d];Array.isArray(e)&&Array.isArray(f)?a[d]=e.concat.apply(e,f):c(e)&&c(f)?a[d]=D(e,f):a[d]=f}),a},{})}function E(a,b){return void 0===a?b:"number"!=typeof a?a?1:0:a}function F(a,b){return a&&"object"===d(a)?Object.keys(a).reduce(function(c,d){return b.includes(d)?(c[d]=a[d],c):c},{}):a}i(j(function(a){a.exports=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")},a.exports.default=a.exports,a.exports.__esModule=!0})),i(j(function(a){function b(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}a.exports=function(a,c,d){return c&&b(a.prototype,c),d&&b(a,d),a},a.exports.default=a.exports,a.exports.__esModule=!0}));var G,H,I,J=new(function(){function a(){this.savedStyles=[],this.bodyScrollYValue=0,this.isFreezed=!1}return a.prototype.freezeBodyOverflow=function(){if(!this.isFreezed){this.isFreezed=!0;var a=(c=window.document.documentElement.clientWidth,Math.abs(window.innerWidth-c)),b=parseInt(window.getComputedStyle(window.document.body).paddingRight,10)||0;this.bodyScrollYValue=window.pageYOffset||window.scrollY,this.savedStyles=[],this.savedStyles.push({value:window.document.body.style.paddingRight,property:"padding-right"},{value:window.document.body.style.overflow,property:"overflow"},{value:window.document.body.style.overflowX,property:"overflow-x"},{value:window.document.body.style.overflowY,property:"overflow-y"}),window.document.body.style.setProperty("overflow","hidden"),window.document.body.style.setProperty("padding-right",a+b+"px")}var c},a.prototype.restoreBodyOverflow=function(){this.isFreezed&&(this.savedStyles.forEach(function(a){var b=a.value,c=a.property;b?window.document.body.style.setProperty(c,b):window.document.body.style.removeProperty(c)}),window.scrollTo(0,this.bodyScrollYValue),this.isFreezed=!1)},a}());!function(a){a.OPEN="VKSDKOpen",a.CLOSE="VKSDKClose",a.LOGOUT="VKSDKLogout",a.GET_CAPTCHA="VKSDKGetCaptcha",a.CAPTCHA_SUCCESS="VKSDKGetCaptchaSuccess",a.CAPTCHA_FAILED="VKSDKGetCaptchaFail",a.AUTH_NEEDED="VKSDKAuthNeeded",a.UPDATE_PARAMS="VKSDKUpdateParams",a.REQUEST_SUPERAPP_TOKEN="VKSDKRequestSuperAppToken",a.ERROR="VKSDKError"}(G||(G={})),function(a){a.INIT="VKSDKInit"}(H||(H={})),function(a){a[a.UNKNOWN=1]="UNKNOWN",a[a.MISSING_PARAM=2]="MISSING_PARAM",a[a.CONNECTION_LOST=3]="CONNECTION_LOST",a[a.USER_DENIED=4]="USER_DENIED",a[a.INVALID_PARAMS=5]="INVALID_PARAMS",a[a.CUSTOM=6]="CUSTOM",a[a.LOADING_ERROR=7]="LOADING_ERROR",a[a.CONNECT_WINDOW_CLOSED=7]="CONNECT_WINDOW_CLOSED",a[a.CONNECT_WINDOW_NOT_OPENED=8]="CONNECT_WINDOW_NOT_OPENED",a[a.CONNECT_DOMAIN_NOT_ALLOWED=9]="CONNECT_DOMAIN_NOT_ALLOWED",a[a.CONNECT_UNKNOWN_SDK_MESSAGE=10]="CONNECT_UNKNOWN_SDK_MESSAGE",a[a.CONNECT_CLIENT_SDK_ERROR=11]="CONNECT_CLIENT_SDK_ERROR",a[a.VALIDATE_ERROR=12]="VALIDATE_ERROR",a[a.CAPTCHA_ERROR=14]="CAPTCHA_ERROR",a[a.OLD_MISSING_PARAM=100]="OLD_MISSING_PARAM"}(I||(I={}));var K=function(a,b){return'Wrong "'+a+'" param. '+(b||"")},L=function(a){return"The "+a+" parameter must be a string"},M=function(a){return"The "+a+" is required parameter"},N=function(a){return"The "+a+" parameter must be а function"},O=function(a,b){return(O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c])})(a,b)};function P(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function c(){this.constructor=a}O(a,b),a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}var Q,R,S,T,U=function(){return(U=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)};function V(a){return a=a||Object.create(null),{on:function(b,c){(a[b]||(a[b]=[])).push(c)},off:function(b,c){a[b]&&a[b].splice(a[b].indexOf(c)>>>0,1)},emit:function(b,c){(a[b]||[]).slice().map(function(a){a(c)}),(a["*"]||[]).slice().map(function(a){a(b,c)})}}}function W(a){return"number"==typeof a}function X(a){return"string"==typeof a}function Y(a){return void 0!==a&&""!==a&&null!==a}function Z(a){return"function"==typeof a}function _(a,b,c,d){return{type:a,code:b,message:c,params:d}}function $(a,b){return{type:I[I.VALIDATE_ERROR],code:I.VALIDATE_ERROR,message:a,params:b}}function aa(a){return a.message?{code:a.code,reason:a.message,data:a.params}:{code:a.code,data:a.params}}!function(a){a.GET_CAPTCHA="VKSDKGetCaptcha",a.APP_CLOSE="VKWebAppClose",a.APP_READY="VKSDKMiniAppReady",a.RESIZE="VKSDKMiniAppResize",a.APP_INIT_CONFIG="VKSDKMiniAppInitConfig",a.OPEN_APP="VKWebAppOpenApp",a.OPEN_PAY_FORM="VKWebAppOpenPayForm",a.ACTION_DONE="VKWebAppActionDone",a.SET_TITLE="VKWebAppSetTitle",a.AUTH_BY_EXCHANGE_TOKEN="VKWebAppAuthByExchangeToken",a.FORCE_LOGOUT="VKWebAppForceLogout"}(Q||(Q={})),function(a){a.OPEN="open",a.HIDE="hide",a.CLOSE="close",a.SHOW="show",a.MESSAGE="message",a.CREATE_APP="createapp"}(R||(R={})),function(a){a.SUPERAPP_TOKEN="VKSDKGeneralSuperAppToken",a.AUTH_NEEDED="VKSDKGeneralAuthNeeded",a.OPEN_APP="VKSDKGeneralOpenApp"}(S||(S={})),function(a){a.SUPERAPP_TOKEN_CHANGE_V2="superAppTokenV2",a.SUPERAPP_TOKEN_CHANGE="superAppToken"}(T||(T={}));var ba,ca=function(){function a(a,b,c){void 0===a&&(a="Parameter validation error"),this.errorText=a,this.params=b,this.valid=c}return a.prototype.isValid=function(){return Boolean(this.valid)},a.prototype.error=function(a){return this.isValid()?null:a?aa($(this.errorText,this.params)):$(this.errorText,this.params)},a}(),da=function(){function a(a){this.rules=a}return a.prototype.validate=function(a){for(var b in this.rules)if(this.rules.hasOwnProperty(b))for(var c=0;c<this.rules[b].length;c++){var d=this.rules[b][c];if(!d.rule(a[b]))return new ca(d.errorText,a,!1)}return new ca("",a,!0)},a}(),ea=(new da({params:[{rule:Y,errorText:M("params")}]}),new da({token:[{rule:X,errorText:L("token")}]})),fa=new da({event:[{rule:X,errorText:L("event")},{rule:Y,errorText:M("event")}],handler:[{rule:Y,errorText:M("handler")}]}),ga=new da({app:[{rule:function(a){return W(a)||X(a)},errorText:function(a){return"The "+a+" parameter must be a number or a string"}("app")},{rule:Y,errorText:M("app")}]}),ha=new da({message:[{rule:Y,errorText:M("message")}]}),ia=new da({handler:[{rule:Y,errorText:M("handler")},{rule:Z,errorText:N("handler")}]}),ja=new da({handler:[{rule:Y,errorText:M("handler")},{rule:Z,errorText:N("handler")}]}),ka=new da({handler:[{rule:Y,errorText:M("handler")},{rule:Z,errorText:N("handler")}]}),la=new da({appId:[{rule:W,errorText:function(a){return"The "+a+" parameter must be a number"}("appId")}]}),ma={appId:0,superAppToken:"",superAppTokenV2:"",loginDomain:"login.vk.com",oauthDomain:"oauth.vk.com",connectDomain:"id.vk.com",_debug:!1,_localhost:!1},na={},oa=function(){function a(){}return a.init=function(a){if(!a.appId)throw new Error("appId required");var b=la.validate({appId:a.appId});!b.isValid()&&console.error(b.error()),ma.appId=a.appId,ma.superAppToken=a.superAppToken||"",ma.superAppTokenV2=a.superAppTokenV2||"",ma.loginDomain=a.loginDomain||"login.vk.com",ma.oauthDomain=a.oauthDomain||"oauth.vk.com",ma.connectDomain=a.connectDomain||"id.vk.com",ma.appSettings=a.appSettings,ma._debug=!!a._debug,ma._localhost=!!a._localhost},a.get=function(){return ma},a.setSuperAppToken=function(b,c){void 0===c&&(c={});var d=ea.validate({token:b});!d.isValid()&&console.error(d.error()),2===c.version?(ma.superAppTokenV2=b,a.events.emit(T.SUPERAPP_TOKEN_CHANGE_V2,b)):(ma.superAppToken=b,a.events.emit(T.SUPERAPP_TOKEN_CHANGE,b))},a.onRequestSuperAppToken=function(a){var b=ia.validate({handler:a});!b.isValid()&&console.error(b.error()),na.requestSuperAppToken=a},a._requestSuperAppToken=function(b,c){var d;void 0===c&&(c={}),na.requestSuperAppToken&&(d=na.requestSuperAppToken(b,c)),d&&d.then(function(b){return a.setSuperAppToken(b,c)}).catch(console.error)},a.onAuth=function(a){var b=ja.validate({handler:a});!b.isValid()&&console.error(b.error()),na.auth=a},a._auth=function(b){var c;void 0===b&&(b={}),na.auth&&(c=na.auth()),c&&c.then(function(c){a.setSuperAppToken(c,b)}).catch(console.error)},a.onOpenApp=function(a){na.openApp=a},a._openApp=function(a){na.openApp&&na.openApp(a.app)},a.onLogout=function(a){var b=ka.validate({handler:a});!b.isValid()&&console.error(b.error()),na.logout=a},a._logout=function(){na.logout&&na.logout()},a.fetchDomain=function(){return Boolean(ba)||(ba=new Promise(function(a){fetch("https://vk.ru/domain.txt").then(function(a){return a.text()}).then(function(a){return a.trim()}).then(function(a){ma.loginDomain=ma.loginDomain.replace("vk.com",a),ma.oauthDomain=ma.oauthDomain.replace("vk.com",a),ma.connectDomain=ma.connectDomain.replace("vk.com",a)}).then(a).catch(function(b){a(),console.warn(b)})})),ba},a.events=V(),a}(),pa=new da({iframe:[{rule:Y,errorText:M("iframe")}],origin:[{rule:X,errorText:L("origin")},{rule:Y,errorText:M("origin")}]}),qa=new da({event:[{rule:Y,errorText:M("event")}]}),ra=new da({handler:[{rule:Y,errorText:M("handler")},{rule:Z,errorText:N("handler")}]}),sa=new da({handler:[{rule:Y,errorText:M("handler")}],params:[{rule:Y,errorText:M("params")}]}),ta=function(a){var b=this;this.handler=function(){return{}},this.destroy=function(){delete b.config,window.removeEventListener("message",b.handleMessage)},this.onMessage=function(a){var c=ra.validate({handler:a});!c.isValid()&&console.error(c.error()),b.handler=a},this.sendMessage=function(a){var c,d=sa.validate(a);!d.isValid()&&console.error(d.error()),null===(c=b.config.iframe.contentWindow)||void 0===c||c.postMessage(U({type:"vk-sak-sdk"},a),b.config.origin)},this.handleMessage=function(a){var c=qa.validate({event:a});!c.isValid()&&console.error(c.error()),b.config.origin&&a.origin===b.config.origin&&a.source===b.config.iframe.contentWindow&&a.data&&"vk-sak-sdk"===a.data.type&&b.handler(a.data)};var c=pa.validate(a);!c.isValid()&&console.error(c.error()),this.config=a,window.addEventListener("message",this.handleMessage)},ua=function(){function a(){var a=this;this.resolve=function(b){if(Boolean(a.promise))return a.finished=!0,a.active=!1,a.resolveHandler(b)},this.reject=function(b){if(Boolean(a.promise))return a.finished=!0,a.active=!1,a.rejectHandler(b)}}return a.prototype.start=function(){var a=this;this.active=!0,this.finished=!1,this.promise=new Promise(function(b,c){a.resolveHandler=b,a.rejectHandler=c})},a.prototype.get=function(){return this.promise},a}(),va=["extend_token","login_with_user","login_silent_user","__sferum_invite_link","registration_with_phone","registration_with_email","validate_phone","bind_ok_account","no_password_flow","confirm_service_action","login_with_eljour","login_with_multi_user","auth_validation_phone","qr_auth","multi_account_flow"];function wa(a){return a&&va.includes(a.name)?btoa(JSON.stringify(a)):""}function xa(a){return a?btoa(JSON.stringify(a)):""}function ya(a,b){return void 0===b&&(b="auth"),oa.fetchDomain().then(function(){var c=oa.get(),d=c.appId,e=c.connectDomain,f=c.appSettings,g=c._debug,h=c._localhost,i=U({app_id:d,response_type:"silent_token",v:"1.58.6",debug:g?1:null,localhost:h?1:null},a);f&&A(f)&&(i.app_settings=B(f));var j=y(i);return Promise.resolve("https://"+e+"/"+b+"?"+j)})}var za,Aa=[0,1,3,4,6,15,16,82];!function(a){a.Default="default",a.NamePhone="name_phone",a.PhoneName="phone_name"}(za||(za={}));var Ba,Ca=[za.Default,za.NamePhone,za.PhoneName];!function(a){a.Primary="primary",a.Flat="flat"}(Ba||(Ba={}));var Da,Ea=[Ba.Primary,Ba.Flat];!function(a){a.CAPTCHA_SUCCESS="VKSDKAuthCaptchaSuccess",a.CAPTCHA_FAIL="VKSDKAuthCaptchaFail"}(Da||(Da={}));var Fa,Ga=function(a,b,c){var d=this;this.events=V(),this.showReadyPromiseTask=new ua,this.init=function(){oa.fetchDomain().then(function(){ya(U(U({origin:location.protocol+"//"+location.host,uuid:d.uuid},d.captchaData),{scheme:d.scheme}),"auth_captcha").then(d.handleCaptcha)})},this.createFrame=function(){return d.iframe=C("",{cssText:"\n      display: none;\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100vh;\n      min-height: 100vh;\n      border: none;\n      z-index: 99999;\n     "}),d},this.handleError=function(a){var b=aa(_(I[I.CUSTOM],I.CUSTOM,"",a));d.events.emit(G.ERROR,b)},this.onMessage=function(a){switch(a.handler){case G.ERROR:d.handleError(a.params);break;case Da.CAPTCHA_SUCCESS:d.showReadyPromiseTask.resolve(a.params),d.destroy();break;default:d.showReadyPromiseTask.reject(),d.destroy()}},this.handleCaptcha=function(a){d.iframe.src=a,document.body.appendChild(d.iframe),d.bridge=new ta({iframe:d.iframe,origin:"https://"+oa.get().connectDomain}),d.bridge.onMessage(d.onMessage)},this.destroy=function(){d.iframe&&document.body.removeChild(d.iframe),d.bridge&&d.bridge.destroy()},this.show=function(){return d.iframe.style.display="block",new Promise(function(a){d.showReadyPromiseTask.start(),d.showReadyPromiseTask.get().then(a)})},this.uuid=a,this.captchaData=b,this.scheme=c||"bright_light",this.createFrame().init()},Ha=function(){function a(b){var c=this;this.readyPromiseResolve=null,this.readyPromise=null,this.child=null,this.initialTitle=window.document.title,this.open=function(a,b){return oa.fetchDomain().then(function(){return c.loading?(c.getMiniAppUrl(a,b).then(function(a){c.iframe.src=a}),c.loading=new Promise(function(a){c.iframe.onload=function(){c.iframe.onload=null,a()}}),c.readyPromise=new Promise(function(a){return c.readyPromiseResolve=a}),c.eventOpenSettings(),c.readyPromise):c.preload(a,b).catch(console.error)})},this.eventOpenSettings=function(){c.iframe.style.display="block",c.params.stackMode||J.freezeBodyOverflow(),c.loading.then(c.handleResize).catch(console.error),c.events.emit(R.OPEN)},this.hide=function(){c.iframe.style.display="none",c.params.stackMode||J.restoreBodyOverflow(),c.events.emit(R.HIDE)},this.close=function(a){window.document.title!==c.initialTitle&&(window.document.title=c.initialTitle),c.params.stackMode||J.restoreBodyOverflow(),c.iframe&&c.iframe.remove(),c.bridge&&c.bridge.destroy(),delete c.iframe,delete c.bridge,oa.events.off(T.SUPERAPP_TOKEN_CHANGE,c.onSuperAppToken),window.removeEventListener("resize",c.handleResize),c.events.emit(R.CLOSE,a)},this.show=function(){if(!c.loading)throw new Error('App is not loaded, use "open" or "preload" methods');c.iframe.style.display="block",c.params.stackMode||J.freezeBodyOverflow(),c.events.emit(R.SHOW)},this.preload=function(a,b){return oa.fetchDomain().then(function(){var d=document.createElement("iframe"),e=window.innerHeight,f=isFinite(c.params.zIndex)?c.params.zIndex:999999;return c.getMiniAppUrl(a,b).then(function(a){d.src=a}),d.setAttribute("allow","geolocation"),d.style.cssText="\n      display: none;\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: "+e+"px;\n      min-height: "+e+"px;\n      border: none;\n      z-index: "+f+";\n    ",c.iframe=d,document.body.appendChild(c.iframe),c.bridge=new ta({iframe:c.iframe,origin:"https://"+oa.get().connectDomain}),c.loading=new Promise(function(a){d.onload=function(){d.onload=null,a()}}),c.readyPromise=new Promise(function(a){return c.readyPromiseResolve=a}),c.bridge.onMessage(c.handleMessage),oa.events.on(T.SUPERAPP_TOKEN_CHANGE,c.onSuperAppToken),window.addEventListener("resize",c.handleResize),c.eventOpenSettings(),c.loading})},this.sendMessage=function(a){var b=ha.validate({message:a});!b.isValid()&&console.error(b.error()),c.bridge.sendMessage(a)},this.onSuperAppToken=function(a){c.bridge.sendMessage({handler:S.SUPERAPP_TOKEN,params:{result:a}})},this.handleError=function(a){var b=aa(_(I[I.CUSTOM],I.CUSTOM,"",a));c.events.emit(G.ERROR,b)},this.handleMessage=function(a){switch(a.handler){case G.GET_CAPTCHA:var b=a.params.uuid,d=new Ga(b,{captcha_sid:a.params.captcha_sid,captcha_img:a.params.captcha_img});d.show().then(function(a){c.bridge.sendMessage({handler:G.CAPTCHA_SUCCESS,params:U({uuid:b},a)})}).catch(function(){c.bridge.sendMessage({handler:G.CAPTCHA_FAILED,params:{uuid:b}}),d.destroy()});break;case Q.APP_CLOSE:c.hide();break;case G.ERROR:c.handleError(a.params);break;case Q.APP_READY:c.resolveReadyPromise(),c.handleUpdateConfig();break;case Q.OPEN_APP:c.openMiniapp(a.params);break;case Q.OPEN_PAY_FORM:c.openPayForm(a.params);break;case Q.SET_TITLE:c.setTitle(a.params);break;case Q.AUTH_BY_EXCHANGE_TOKEN:c.onAuthByExchangeToken();break;case Q.FORCE_LOGOUT:c.onForceLogout();break;case S.SUPERAPP_TOKEN:oa._requestSuperAppToken(a.params);break;case S.AUTH_NEEDED:oa._auth();break;default:c.events.emit(R.MESSAGE,a)}},this.handleResize=function(){if(c.iframe){var a=innerWidth,b=innerHeight;c.iframe.style.height=b+"px",c.iframe.style.minHeight=b+"px",c.bridge.sendMessage({handler:Q.RESIZE,params:{viewport_width:a,viewport_height:b}})}},this.handleUpdateConfig=function(){c.bridge.sendMessage({handler:Q.APP_INIT_CONFIG,params:{fullMode:c.params.fullMode,hideMenu:c.params.hideMenu,scheme:c.params.scheme}})},this.update=function(a){a&&(c.params=D(c.params,a||{}),c.sendUpdateParamsMessage())},this.getMiniAppUrl=function(a,b){return oa.fetchDomain().then(function(){var d=oa.get(),e=d.connectDomain,f=d.appId,g=d.superAppToken,h=d._debug,i=d._localhost;return"https://"+e+"/mini_app?"+y({app:c.params.app,host_app_id:f,superapp_token:g,app_query:a?JSON.stringify(a):"",app_hash:b||"",debug:h?1:null,localhost:i?1:null})})},this.resolveReadyPromise=function(){c.readyPromise&&c.readyPromiseResolve&&(c.readyPromiseResolve(),c.readyPromise=null,c.readyPromiseResolve=null)},this.openMiniapp=function(b){c.child=new a({app:b.app_id,stackMode:c.params.stackMode}),c.events.emit(R.CREATE_APP,{app:c.child,location:b.location})},this.openPayForm=function(b){var d=U({},b.params);d.data&&(d.data=JSON.stringify(d.data));var e=U(U({},d),{app_id:b.app_id,action:b.action}),f=new a({app:6217559,stackMode:c.params.stackMode});f.open(e).then(function(){return c.hide()}).catch(console.error),f.events.on(R.MESSAGE,function(a){c.handleVKPayFormMessage(a),f.close(),c.show()}),f.events.on(R.HIDE,function(){f.close(),c.close()})},this.setTitle=function(a){window.document.title=a.title},this.onAuthByExchangeToken=function(){c.close({closedByExchangeToken:!0})},this.onForceLogout=function(){c.close({closedByForceLogout:!0})},this.handleVKPayFormMessage=function(a){a.handler===Q.ACTION_DONE&&c.sendMessage(a),a.handler===G.ERROR&&c.handleError(a.params)};var d=ga.validate(b);!d.isValid()&&console.error(d.error()),this.params=U(U({},b),{app:"number"==typeof b.app?"app"+b.app:b.app,scheme:"string"==typeof b.scheme?b.scheme:"bright_light"}),this.events=V()}return a.prototype.on=function(a,b){var c=fa.validate({event:a,handler:b});!c.isValid()&&console.error(c.error()),this.events.on(a,b)},a.prototype.off=function(a,b){var c=fa.validate({event:a,handler:b});!c.isValid()&&console.error(c.error()),this.events.off(a,b)},a.prototype.sendUpdateParamsMessage=function(){this.bridge&&this.bridge.sendMessage({params:this.params,handler:G.UPDATE_PARAMS})},a}(),Ia=(function(){function a(){this.stack=[]}a.prototype.removeMiniApp=function(a){var b=a.app,c=this.stack.lastIndexOf(b);if(c>-1&&c===this.stack.length-1)if(this.stack.splice(c,1),this.stack.length){this.stack[this.stack.length-1].show();var d=this.stack[this.stack.length-2];setTimeout(function(){return null==d?void 0:d.hide()},0)}else J.restoreBodyOverflow()},a.prototype.makeHandleMiniAppClose=function(a){var b=this,c=a.app;return function(){b.removeMiniApp({app:c})}},a.prototype.makeHandleMiniAppHide=function(a){var b=this,c=a.app;return function(){var a=b.stack.lastIndexOf(c);a>-1&&a===b.stack.length-1&&setTimeout(function(){return c.close()},0)}},a.prototype.handleMiniAppCreate=function(a){var b=a.app,c=a.query,d=a.hash;this.stack.push(b),b.open(c,d).catch(console.error),b.events.on(R.CREATE_APP,this.handleMiniAppCreate.bind(this)),b.events.on(R.HIDE,this.makeHandleMiniAppHide({app:b})),b.events.on(R.CLOSE,this.makeHandleMiniAppClose({app:b})),J.freezeBodyOverflow();var e=this.stack[this.stack.length-2];return setTimeout(function(){null==e||e.hide()},0),b},Object.defineProperty(a.prototype,"length",{get:function(){return this.stack.length},enumerable:!1,configurable:!0}),a.prototype.open=function(a){var b=ga.validate(a);!b.isValid()&&console.error(b.error());var c=a.app,d=a.query,e=a.hash,f=new Ha({app:c,stackMode:!0});return this.handleMiniAppCreate({app:f,query:d,hash:e}),f},a.prototype.close=function(){var a=this.stack;this.stack.splice(0),a.reverse().forEach(function(a){return a.close()}),J.restoreBodyOverflow()}}(),"ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"),Ja=function(){for(var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21,b="",c=a;c--;)b+=Ia[64*Math.random()|0];return b};!function(a){a.STATIC_MAP="VKSDKRequestToGeoservice:staticmap/png/",a.SEARCH="VKSDKRequestToGeoservice:search",a.OVERALL="VKSDKRequestToGeoservice:overall",a.DIRECTIONS="VKSDKRequestToGeoservice:directions",a.ISO="VKSDKRequestToGeoservice:iso"}(Fa||(Fa={}));var Ka,La,Ma,Na,Oa,Pa;!function(){function a(a){var b=this;this.apiKey=a.apiKey,this.requestMap={};var c=document.createElement("iframe");this.iframe=c,oa.fetchDomain().then(function(){var a=oa.get().appId;b.getGeoserviceProxyUrl({app_id:a}).then(function(a){c.src=a}),c.style.cssText="\n      display: none;\n    ",document.body.appendChild(b.iframe),b.bridge=new ta({iframe:b.iframe,origin:"https://"+oa.get().connectDomain}),b.bridge.onMessage(function(a){var c=a.params,d=c.requestID,e=c.response;b.requestMap[d].resolve(e),delete b.requestMap[d]})})}a.prototype.setApiKey=function(a){this.apiKey=a},a.prototype.getGeoserviceProxyUrl=function(a){return oa.fetchDomain().then(function(){var b=oa.get(),c=b.connectDomain,d=b._debug,e=b._localhost;return"https://"+c+"/geoservice?"+y(U(U({},a||{}),{origin:location.protocol+"//"+location.host,debug:d?1:null,localhost:e?1:null}))})},a.prototype.prepareAnswer=function(a,b,c){var d=this,e=Ja();return this.bridge.sendMessage({handler:"VKSDKRequestToGeoservice:"+a,params:U(U({},b),{api_key:this.apiKey,wrapRequestInJSON:c,requestID:e})}),new Promise(function(a,b){d.requestMap[e]={resolve:a,reject:b}})},a.prototype.getStaticMap=function(a){return this.prepareAnswer("staticmap/png/",a)},a.prototype.encodeCoords=function(a){return this.prepareAnswer("search",a)},a.prototype.decodeCoords=function(a){return this.prepareAnswer("overall",a)},a.prototype.getDirections=function(a){return this.prepareAnswer("directions",a,!0)},a.prototype.getISO=function(a){return this.prepareAnswer("iso",a,!0)}}();!function(a){a.SHOW_DATA_POLICY="VKSDKOneTapAuthConnectDataPolicy",a.HIDE_DATA_POLICY="VKSDKOneTapAuthDataPolicyClose",a.DATA_POLICY_RESULT="VKSDKOneTapAuthDataPolicyResult",a.SHOW_CAPTCHA="VKSDKOneTapAuthDataPolicyShowCaptcha"}(Ka||(Ka={})),function(a){a.SHOW_POLICY_AGREEMENTS="VKSDKOneTapAuthPolicyAgreementsShow",a.HIDE_POLICY_AGREEMENTS="VKSDKOneTapAuthPolicyAgreementsHide",a.ACCEPT_POLICY_AGREEMENTS="VKSDKOneTapAuthPolicyAgreementsAccept",a.DECLINE_POLICY_AGREEMENTS="VKSDKOneTapAuthPolicyAgreementsDecline",a.POLICY_AGREEMENTS_ERROR="VKSDKOneTapAuthPolicyAgreementsError",a.SHOW_DATA_POLICY="VKSDKOneTapAuthPolicyAgreementsShowDataPolicy",a.GET_CAPTCHA="VKSDKGetCaptcha",a.CAPTCHA_SUCCESS="VKSDKGetCaptchaSuccess",a.CAPTCHA_FAIL="VKSDKGetCaptchaFail"}(La||(La={})),function(a){a.PHONE_VALIDATION_NEEDED="VKSDKOneTapAuthPhoneValidationNeeded",a.FULL_AUTH_NEEDED="VKSDKOneTapAuthFullAuthNeeded",a.AUTH_DATA_LOADED="VKSDKOneTapAuthDataLoaded",a.NOT_AUTHORIZED="VKSDKOneTapAuthNotAuthorized",a.LOGIN_SUCCESS="VKSDKOneTapAuthLoginSuccess",a.RESIZE_FRAME="VKSDKOneTapResizeFrame",a.SHOW_CAPTCHA="VKSDKOneTapShowCaptcha",a.VALIDATE_CAPTCHA="VKSDKOneTapValidateCaptcha",a.UPDATE_PARAMS="VKSDKUpdateParams"}(Ma||(Ma={})),function(a){a.CLOSE_AUTH="VKSDKOneTapAuthClose",a.ADAPTIVITY_CHANGE="VKSDKFloatingOneTapAdaptivityChange",a.ADAPTIVITY_CHANGED="VKSDKFloatingOneTapAdaptivityChanged",a.UPDATE_PARAMS="VKSDKUpdateParams"}(Na||(Na={})),function(a){a.SHOW_LOGIN="VKSDKButtonOneTapAuthShowLogin",a.SHOW_LOGIN_OPTIONS="VKSDKButtonOneTapAuthShowLoginOptions",a.SHOW_AGREEMENTS_DIALOG="VKSDKButtonOneTapAuthShowAgreementsDialog",a.START_AUTHORIZE="VKSDKButtonOneTapAuthStartAuthorize",a.UPDATE_PARAMS="VKSDKUpdateParams"}(Oa||(Oa={})),function(a){a.WRONG_TOKEN="VKSDKBindAccountErrorWrongToken",a.ALREADY_BIND="VKSDKBindAccountErrorAlreadyBind"}(Pa||(Pa={}));var Qa,Ra,Sa=new da({url:[{rule:X,errorText:L("url")},{rule:Y,errorText:M("url")}]}),Ta=new da({uuid:[{rule:X,errorText:L("uuid")},{rule:Y,errorText:M("uuid")}]}),Ua=(new da({params:[{rule:Y,errorText:M("params")}]}),new da({callback:[{rule:Y,errorText:M("callback")}]})),Va=function(){function a(){}var b;return a.on=function(a,b){var c=fa.validate({event:a,handler:b});!c.isValid()&&console.error(c.error()),this.events.on(a,b)},a.off=function(a,b){var c=fa.validate({event:a,handler:b});!c.isValid()&&console.error(c.error()),this.events.off(a,b)},b=a,a.flags=null,a.events=V(),a.handleError=function(a){var c=aa(_(I[I.CUSTOM],I.CUSTOM,"",a));b.events.emit(G.ERROR,c)},a.silentAuth=function(){return oa.fetchDomain().then(function(){var a=oa.get(),b=a.loginDomain,c=a.appId,d=new ua,e=Ja(),f="https://"+b+"/?act=connect&app_id="+c+"&response_type=silent_token&uuid="+e+"&v=1.58.6",g=new XMLHttpRequest;return g.open("GET",f,!0),g.responseType="json",g.withCredentials=!0,d.start(),g.onload=function(){var a,b=g.response,c=g.status>=200&&g.status<300;if(b&&(null===(a=b.error)||void 0===a?void 0:a.error_code)===I.CAPTCHA_ERROR){var h=b.error,i=h.captcha_sid,j=h.captcha_img;new Ga(e,{captcha_sid:i,captcha_img:j}).show().then(function(a){var b=f+"&captcha_key="+a.captcha_key+"&captcha_sid="+a.captcha_sid;g.open("GET",b,!0),g.send()})}else b&&c?d.resolve({provider:"vk",payload:g.response}):d.reject()},g.onerror=function(){d.reject()},g.send(),d.get()})},a.oneTapAuth=function(b,c){if(console.warn("Connect.oneTapAuth method is deprecated. Use Connect.floatingOneTapAuth and Connect.buttonOneTapAuth methods."),!["floating","button"].includes(b))return null;switch(b){case"button":return a.buttonOneTapAuth(c);case"floating":return a.floatingOneTapAuth(c);default:return null}},a.floatingOneTapAuth=function(c){var d=Ua.validate({callback:c.callback});!d.isValid()&&console.error(d.error());var e=function(){var a,b=window.innerWidth,c=b<=768;return{destroy:function(){return window.removeEventListener("resize",a)},isAdaptive:function(){return c},observe:function(d){a=function(){var a=window.innerWidth;b>768&&a<=768?d(c=!0):b<=768&&a>768&&d(c=!1),b=a},window.addEventListener("resize",a)}}}(),f=function(a,b){var c,d,e,f={},g=a?"314px":"334px",h=a?"\n      display: none;\n      position: fixed;\n      bottom: 0;\n      right: 50%;\n      transform: translate(50%, 0);\n      max-width: 468px;\n      width: 100%;\n      height: "+g+";\n    ":"\n        display: none;\n        position: fixed;\n        top: 0;\n        right: 0;\n        max-width: 400px;\n        width: 100%;\n        height: "+g+";\n      ";return(null===(c=null==b?void 0:b.styles)||void 0===c?void 0:c.zIndex)&&isFinite(null===(d=null==b?void 0:b.styles)||void 0===d?void 0:d.zIndex)&&(h+="z-index: "+(null===(e=null==b?void 0:b.styles)||void 0===e?void 0:e.zIndex)+";"),b&&(f.skip_success=E(b.skipSuccess,0),void 0!==b.scheme&&["bright_light","space_gray"].includes(b.scheme)&&(f.scheme=b.scheme)),{pageUrl:"floating_one_tap_auth",pageUrlParams:U({adaptive:a?1:0},f),frameStyles:h,scheme:(null==b?void 0:b.scheme)||"bright_light"}}(e.isAdaptive(),c.options);if(!f)throw new Error("options were not set");var g,h,i,j=Ja(),k=U({origin:location.protocol+"//"+location.host,uuid:j},f.pageUrlParams),l=f.pageUrl,m=new ua,n=function(){h&&h.sendMessage({handler:Ma.RESIZE_FRAME,params:{uuid:j}})},o=function(){g&&(g.remove(),g=null),window.removeEventListener("resize",n),e&&e.destroy(),h&&h.destroy()};i=new Promise(function(a){m.start(),m.get().then(function(b){a(b)})});var p=function(d){if(d.params.uuid===j)switch(d.handler){case G.ERROR:b.handleError(d.params);break;case Ma.NOT_AUTHORIZED:c.callback({type:d.handler,payload:{uuid:j,error:"not_authorized"}}),o(),m.resolve(d.handler);break;case Ma.RESIZE_FRAME:g.style.height=d.params.height+"px";break;case Na.CLOSE_AUTH:c.callback({type:d.handler,payload:{uuid:j}}),o();break;case Na.ADAPTIVITY_CHANGED:g.style.display="block";break;case Ma.AUTH_DATA_LOADED:g.style.display="block",m.resolve(d.handler);default:a.handleOneTapEvents(d,h,c)}};return g=C("",{cssText:null==f?void 0:f.frameStyles}),document.body.appendChild(g),oa.fetchDomain().then(function(){return ya(k,l).then(function(a){g.src=a,(h=new ta({iframe:g,origin:"https://"+oa.get().connectDomain})).onMessage(p),e.observe(function(a){h.sendMessage({handler:Na.ADAPTIVITY_CHANGE,params:{uuid:j,is_adaptive:a}}),a?(g.style.maxWidth="468px",g.style.top="auto",g.style.bottom="0",g.style.right="50%",g.style.transform="translate(50%, 0)"):(g.style.maxWidth="400px",g.style.top="0",g.style.bottom="auto",g.style.right="0",g.style.transform="none"),g.style.display="none"}),window.addEventListener("resize",n)})}),{getFrame:function(){return g},destroy:o,authReadyPromise:i,update:function(a){f=D(f||{},a),h&&f&&h.sendMessage({handler:Na.UPDATE_PARAMS,params:f})}}},a.buttonOneTapAuth=function(b){var c=Ua.validate({callback:b.callback});!c.isValid()&&console.error(c.error());var d=function(a){var b,c,d,e,f,g,h={},i=44,j=56;return a&&(h.display=a.displayMode&&Ca.includes(a.displayMode)?a.displayMode:za.Default,h.button_skin=a.buttonSkin&&Ea.includes(a.buttonSkin)?a.buttonSkin:Ba.Primary,h.show_agreements=E(a.showAgreements,0),h.show_alternative_login=E(a.showAlternativeLogin,0),void 0!==a.scheme&&["bright_light","space_gray"].includes(a.scheme)&&(h.scheme=a.scheme),void 0!==(null===(b=a.buttonStyles)||void 0===b?void 0:b.height)&&(i=Number(null===(c=a.buttonStyles)||void 0===c?void 0:c.height),j=Number(null===(d=a.buttonStyles)||void 0===d?void 0:d.height)+12,h.style_height=null===(e=a.buttonStyles)||void 0===e?void 0:e.height),void 0!==(null===(f=a.buttonStyles)||void 0===f?void 0:f.borderRadius)&&(h.style_border_radius=null===(g=a.buttonStyles)||void 0===g?void 0:g.borderRadius),void 0!==a.langId&&(h.lang_id=Aa.includes(a.langId)?a.langId:0),i+=h.show_alternative_login?j:0,i+=h.show_agreements?80:0),{pageUrl:"button_one_tap_auth",pageUrlParams:h,frameStyles:"\n        height: "+i+"px;\n      ",scheme:(null==a?void 0:a.scheme)||"bright_light"}}(b.options);if(!d)throw new Error("options were not set");var e,f,g,h=Ja(),i=U({origin:location.protocol+"//"+location.host,uuid:h},d.pageUrlParams),j=d.pageUrl,k=new ua;g=new Promise(function(a){k.start(),k.get().then(function(b){a(b)})});var l=function(){f&&f.sendMessage({handler:Ma.RESIZE_FRAME,params:{uuid:h}})},m=function(c){if(c.params.uuid===h)switch(c.handler){case Ma.RESIZE_FRAME:e.style.height=c.params.height+"px";break;case Ma.NOT_AUTHORIZED:k.resolve(c.handler);break;case Oa.SHOW_LOGIN:case Oa.SHOW_LOGIN_OPTIONS:b.callback({type:c.handler,payload:{uuid:h}});break;case Oa.SHOW_AGREEMENTS_DIALOG:a.userPolicyAgreements(h,null==d?void 0:d.scheme).show().then(function(a){a&&a.accepted&&f.sendMessage({handler:Oa.START_AUTHORIZE,params:{uuid:h}})}).catch(function(){f.sendMessage({handler:La.DECLINE_POLICY_AGREEMENTS,params:{uuid:h}})});break;case Ma.AUTH_DATA_LOADED:k.resolve(c.handler);default:a.handleOneTapEvents(c,f,b)}};e=C("",{cssText:null==d?void 0:d.frameStyles});var n=b.container;return n&&n.appendChild(e),oa.fetchDomain().then(function(){return ya(i,j).then(function(a){e.src=a,(f=new ta({iframe:e,origin:"https://"+oa.get().connectDomain})).onMessage(m),window.addEventListener("resize",l)})}),{getFrame:function(){return e},destroy:function(){e&&(e.remove(),e=null),window.removeEventListener("resize",l),f&&f.destroy()},authReadyPromise:g,update:function(a){d=D(d||{},a),f&&d&&f.sendMessage({handler:Oa.UPDATE_PARAMS,params:d})}}},a.handleOneTapEvents=function(c,d,e){var f,g,h=c.params.uuid;switch(c.handler){case G.ERROR:b.handleError(c.params);break;case Ma.AUTH_DATA_LOADED:d.sendMessage({handler:Ma.RESIZE_FRAME,params:{uuid:h}});break;case Ma.LOGIN_SUCCESS:e.callback({type:c.handler,provider:"vk",payload:c.params});break;case Ma.SHOW_CAPTCHA:var i=new Ga(h,{captcha_sid:c.params.captcha_sid,captcha_img:c.params.captcha_img},null===(f=e.options)||void 0===f?void 0:f.scheme);i.show().then(function(a){d.sendMessage({handler:Da.CAPTCHA_SUCCESS,params:U({uuid:h},a)})}).catch(function(){d.sendMessage({handler:Da.CAPTCHA_FAIL,params:{uuid:h}}),i.destroy()});break;case Ka.SHOW_DATA_POLICY:a.userDataPolicy(h,null===(g=e.options)||void 0===g?void 0:g.scheme).show().then(function(){e.callback({type:Ka.DATA_POLICY_RESULT,payload:{uuid:h,policyAccepted:!0}})}).catch(function(){e.callback({type:Ka.DATA_POLICY_RESULT,payload:{uuid:h,policyAccepted:!1}})});break;case Ma.FULL_AUTH_NEEDED:case Ma.PHONE_VALIDATION_NEEDED:e.callback({type:c.handler,payload:{uuid:h}})}},a.userDataPolicy=function(a,c){var d,e=Ta.validate({uuid:a});!e.isValid()&&console.error(e.error());var f,g=window.innerHeight,h=function(){d&&(d.style.display="none")},i=new ua,j=function(){d&&d.remove(),f&&f.destroy()};d=C("",{properties:{height:g+"px"},cssText:"\n      display: none;\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100vh;\n      min-height: 100vh;\n      border: none;\n      z-index: 99999;\n    "}),document.body.appendChild(d);var k=function(e){switch(e.handler){case G.ERROR:b.handleError(e.params);break;case Ka.HIDE_DATA_POLICY:h(),i.resolve(void 0),j();break;case Ka.SHOW_CAPTCHA:var g=new Ga(a,{captcha_sid:e.params.captcha_sid,captcha_img:e.params.captcha_img},c);g.show().then(function(b){f.sendMessage({handler:Da.CAPTCHA_SUCCESS,params:U({uuid:a},b)}),d.style.display="block"}).catch(function(){f.sendMessage({handler:Da.CAPTCHA_FAIL,params:{uuid:a}}),g.destroy()}),h();break;default:h(),i.reject(),j()}};return oa.fetchDomain().then(function(){ya({origin:location.protocol+"//"+location.host,uuid:a,scheme:c||"bright_light"},"user_data_policy").then(function(a){d.src=a}),(f=new ta({iframe:d,origin:"https://"+oa.get().connectDomain})).onMessage(k)}),{show:function(){return d.style.display="block",new Promise(function(a){i.start(),i.get().then(function(b){a(b)})})},hide:h,destroy:j}},a.userPolicyAgreements=function(c,d){var e,f,g,h=new ua;g=window.innerHeight,e=C("",{properties:{height:g+"px"},cssText:"\n      display: none;\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: "+g+"px;\n      min-height: "+g+"px;\n      border: none;\n      z-index: 99999;\n    "}),document.body.appendChild(e);var i=function(){e&&(e.remove(),e=null),f&&f.destroy()},j=function(){e&&(e.style.display="none")},k=function(g){switch(g.handler){case G.ERROR:b.handleError(g.params);break;case La.ACCEPT_POLICY_AGREEMENTS:j(),h.resolve({accepted:!0}),i();break;case La.DECLINE_POLICY_AGREEMENTS:j(),h.resolve({accepted:!1}),i();break;case La.GET_CAPTCHA:var k=new Ga(c,{captcha_sid:g.params.captcha_sid,captcha_img:g.params.captcha_img},d);k.show().then(function(a){f.sendMessage({handler:La.CAPTCHA_SUCCESS,params:U({uuid:c},a)}),e.style.display="block"}).catch(function(){f.sendMessage({handler:La.CAPTCHA_FAIL,params:{uuid:c}}),k.destroy()}),j();break;case La.SHOW_DATA_POLICY:j();var l=function(){e.style.display="block"};a.userDataPolicy(c,d).show().then(l).catch(l);break;case La.POLICY_AGREEMENTS_ERROR:case La.HIDE_POLICY_AGREEMENTS:default:h.reject(),i()}};return oa.fetchDomain().then(function(){ya({origin:location.protocol+"//"+location.host,uuid:c,scheme:d||"bright_light"},"user_policy_agreements").then(function(a){e.src=a,(f=new ta({iframe:e,origin:"https://"+oa.get().connectDomain})).onMessage(k)})}),{show:function(){return e.style.display="block",new Promise(function(a){h.start(),h.get().then(function(b){a(b)})})},hide:j,destroy:i}},a.userVisibleAuth=function(b){return oa.fetchDomain().then(function(){var c=Ja(),d=oa.get(),f=U(U({origin:location.protocol+"//"+location.host,uuid:c,debug:d._debug?1:null,localhost:d._localhost?1:null},F(b,["screen","source"])),{scheme:null==b?void 0:b.scheme}),g=wa(null==b?void 0:b.action);g&&(f.action=g);var h=xa(null==b?void 0:b.entry);return h&&(f.initial_stats_info=h),ya(f).then(function(b){a.flags&&(b=b+"#"+y(a.flags));var d=screen.height/2-280,f=screen.width/2-410,g=window.open(b,"_blank","top="+d+",left="+f+",width=820,height=560,location");if(!g){var h=aa(_(I[I.CONNECT_WINDOW_NOT_OPENED],I.CONNECT_WINDOW_NOT_OPENED,"Connect window was not opened."));return Promise.reject(h)}return new Promise(function(a,b){var d=setInterval(function(){if(!g||g.closed){window.removeEventListener("message",f),clearInterval(d);var a=aa(_(I[I.CONNECT_WINDOW_CLOSED],I.CONNECT_WINDOW_CLOSED,"Connect window was closed."));b(a)}},1e3);function f(h){if(h.source===g&&g)if(window.removeEventListener("message",f),clearInterval(d),function(a){for(var b=0;b<e.length;b++){var c=e[b];if(a.slice(a.length-c.length)===c)return!0}return!1}(h.origin))if(h.data.action==="vk_connect_response"+c){var i=h.data.payload;if(g.close(),i.error)k=aa(_(I[I.CONNECT_CLIENT_SDK_ERROR],I.CONNECT_CLIENT_SDK_ERROR,function(a){return a.error+";"+a.errorCode}(i.error))),b(k);else a({provider:"vk",payload:i})}else if(h.data.action==="oauth_callback"+c)a({provider:h.data.payload.name}),g.close();else if(h.data.action==="skip_callback"+c){var j=h.data.payload.redirectURL;j&&(window.location.href=j),g.close()}else if(h.data.action==="bind_ok_account"+c)a(h.data.payload),g.close();else g.close(),k=aa(_(I[I.CONNECT_UNKNOWN_SDK_MESSAGE],I.CONNECT_UNKNOWN_SDK_MESSAGE,function(a){return"This SDK message is unknown: "+a}(JSON.stringify(h.data)))),b(k);else{g.close();var k=aa(_(I[I.CONNECT_DOMAIN_NOT_ALLOWED],I.CONNECT_DOMAIN_NOT_ALLOWED,function(a){return'URL domain "'+a+'" is not allowed.'}(h.origin)));b(k)}}window.addEventListener("message",f)})})})},a.redirectAuth=function(a){var b=Sa.validate(a);!b.isValid()&&console.error(b.error());var c=Ja(),d=U(U({redirect_uri:a.url,uuid:c},F(a,["screen","source"])),{scheme:null==a?void 0:a.scheme}),e=wa(null==a?void 0:a.action);e&&(d.action=e);var f=xa(null==a?void 0:a.entry);f&&(d.initial_stats_info=f),(null==a?void 0:a.state)&&(d.redirect_state=a.state),ya(d).then(function(a){location.assign(a)})},a.logout=function(){return oa.fetchDomain().then(function(){var a=oa.get(),b=a.connectDomain,c=a.appId,d=a.superAppTokenV2;if(!d)return Promise.reject(K("superappToken","SuperappToken is undefined"));var e=y({origin:location.protocol+"//"+location.host,host_app_id:c,superapp_token:d}),f=fetch("https://"+b+"/logout?"+e,{credentials:"include"});return oa.events.emit(G.LOGOUT),oa.setSuperAppToken(""),oa.setSuperAppToken("",{version:2}),f})},a}(),Wa=["open_account"];!function(){function a(){}a.open=function(a){var b=ea.validate({token:a.action.token});return!b.isValid()&&console.error(b.error()),oa.fetchDomain().then(function(){var b,c=Ja(),d=oa.get(),e=U({origin:location.protocol+"//"+location.host,uuid:c,debug:E(d._debug,0),localhost:E(d._localhost,0)},F(a,["screen","source"])),f=(b=null==a?void 0:a.action)&&Wa.includes(b.name)?btoa(JSON.stringify(b)):"";return f&&(e.action=f),function(a){return oa.fetchDomain().then(function(){var b=oa.get(),c=b.appId,d=b.connectDomain,e=b.appSettings,f=b._debug,g=b._localhost,h=U({app_id:c,response_type:"silent_token",v:"1.58.6",debug:f?1:null,localhost:g?1:null},a);e&&A(e)&&(h.app_settings=B(e));var i=y(h);return Promise.resolve("https://"+d+"/open_account?"+i)})}(e).then(function(a){if(!window.open(a,"_blank")){var b=aa(_(I[I.CONNECT_WINDOW_NOT_OPENED],I.CONNECT_WINDOW_NOT_OPENED,"Connect window was not opened."));return Promise.reject(b)}return Promise.resolve()})})}}();!function(a){a.INTERNAL_RESIZE="VKSDKMessengerInternalResize",a.INTERNAL_LOGOUT="VKSDKMessengerInternalLogout"}(Qa||(Qa={})),function(a){a.CLOSE_CHAT="VKSDKMessengerCloseChat"}(Ra||(Ra={}));var Xa,Ya=function(){function a(){}return a.log=function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b]},a}(),Za=new da({params:[{rule:Y,errorText:M("params")}]}),$a=function(){function a(){var a=this;this.config={},this.params={},this.loadingTask=new ua,this.initTask=new ua,this.cssText="",this.handleError=function(b){var c=aa(_(I[I.CUSTOM],I.CUSTOM,"",b));a.events.emit(G.ERROR,c)},this.events=V(),this.handleBridgeMessage=this.handleBridgeMessage.bind(this),this.handleChangeSuperAppToken=this.handleChangeSuperAppToken.bind(this),this.close=this.close.bind(this),this.handleLogout=this.handleLogout.bind(this)}return a.prototype.preload=function(a){var b=this;return oa.fetchDomain().then(function(){return b.validateParams(a).then(function(){return b.updateParams(a),b.createIframe().then(function(){return b.initTask.start(),b.loadingTask.start(),b.timeoutTimer=setTimeout(function(){if(!b.initTask.finished){var a=aa(_(I[I.LOADING_ERROR],I.LOADING_ERROR,"Loading timeout"));b.initTask.reject(a)}},5e3),b.iframe.onload=function(){b.iframe.onload=null,b.loadingTask.resolve()},b.bridge=new ta({iframe:b.iframe,origin:"https://"+oa.get().connectDomain}),b.bridge.onMessage(b.handleBridgeMessage),oa.events.on(T.SUPERAPP_TOKEN_CHANGE_V2,b.handleChangeSuperAppToken),oa.events.on(G.LOGOUT,b.close),b.getIframeContainer().appendChild(b.iframe),b.loadingTask.get()})})})},a.prototype.open=function(a){var b=this;return this.validateParams(a).then(function(){return b.initTask.finished?(b.updateParams(a),Promise.resolve()):b.initTask.active||b.initTask.finished?(b.updateParams(a),b.initTask.get()):b.preload(a).then(function(){return b.initTask.get()})})},a.prototype.update=function(a,b){a&&this.updateParams(a),b&&this.updateConfig(b)},a.prototype.close=function(){this.iframe&&(this.iframe.onload=null,this.iframe.remove()),this.bridge&&this.bridge.destroy(),oa.events.off(T.SUPERAPP_TOKEN_CHANGE_V2,this.handleChangeSuperAppToken),oa.events.off(G.LOGOUT,this.close),delete this.iframe,delete this.bridge,this.loadingTask=new ua,this.initTask=new ua,this.events.emit(G.CLOSE)},a.prototype.sendMessage=function(a){var b=ha.validate({message:a});!b.isValid()&&console.error(b.error()),this.bridge.sendMessage(a)},a.prototype.on=function(a,b){var c=fa.validate({event:a,handler:b});!c.isValid()&&console.error(c.error()),this.events.on(a,b)},a.prototype.off=function(a,b){var c=fa.validate({event:a,handler:b});!c.isValid()&&console.error(c.error()),this.events.off(a,b)},a.prototype.handleInit=function(){this.initTask.finished||(clearTimeout(this.timeoutTimer),this.initTask.resolve()),this.sendUpdateParamsMessage(),this.iframe.style.display="block"},a.prototype.handleRequestAuth=function(){oa._auth({version:2})},a.prototype.handleRequestSuperAppToken=function(a){oa._requestSuperAppToken(a,{version:2})},a.prototype.handleChangeSuperAppToken=function(a){this.bridge.sendMessage({handler:G.REQUEST_SUPERAPP_TOKEN+"Success",params:{result:a}})},a.prototype.handleBridgeMessage=function(a){switch(Ya.log(a),a.handler){case H.INIT:this.handleInit();break;case G.REQUEST_SUPERAPP_TOKEN:this.handleRequestSuperAppToken(a.params);break;case G.AUTH_NEEDED:this.handleRequestAuth();break;case G.CLOSE:this.close();break;case G.ERROR:this.handleError(a.params);break;default:return}},a.prototype.handleLogout=function(){oa._logout()},a.prototype.handleAfterUpdateParams=function(){this.sendUpdateParamsMessage()},a.prototype.handleAfterUpdateConfig=function(){},a.prototype.handleAfterCreateIframe=function(){},a.prototype.validateParams=function(a){var b=Za.validate({params:a});return!b.isValid()&&console.error(b.error()),Promise.resolve(a)},a.prototype.createIframe=function(){var a=this;return this.getIframeUrl().then(function(b){return a.iframe=C(b,{cssText:a.cssText}),a.handleAfterCreateIframe(),Promise.resolve()})},a.prototype.getIframeUrl=function(){return new Promise(function(a){return a("")})},a.prototype.getIframeContainer=function(){return window.document.body},a.prototype.getIframeUrlParams=function(){var a=this;return oa.fetchDomain().then(function(){var b=oa.get(),c=b.superAppTokenV2,d=b.appId,e=b._debug,f=b._localhost;return Promise.resolve(y(U(U({},a.params),{host_app_id:d,superapp_token:c,origin:location.protocol+"//"+location.host,debug:e?1:null,localhost:f?1:null})))})},a.prototype.updateConfig=function(a){this.config=D(this.config,a),this.handleAfterUpdateConfig()},a.prototype.updateParams=function(a){this.params=D(this.params,a||{}),this.handleAfterUpdateParams()},a.prototype.sendUpdateParamsMessage=function(){this.bridge&&this.initTask.finished&&this.bridge.sendMessage({params:this.params,handler:G.UPDATE_PARAMS})},a}(),_a=new da({config:[{rule:Y,errorText:M("config")}]}),ab={styles:{bottom:"0",right:"0",zIndex:99999}},bb=function(a){function b(b){var c=a.call(this)||this;c.config=ab,c.cssText="\n    border: none;\n    display: none;\n    position: fixed;\n    color-scheme: auto;\n  ",c.updateStyles=function(){if(c.iframe){var a=c.config.styles,b=isFinite(a.zIndex)?a.zIndex:999999;c.iframe.style.zIndex=""+b,c.iframe.style.bottom=a.bottom,c.iframe.style.right=a.right}};var d=_a.validate({config:b});return!d.isValid()&&console.error(d.error()),c.updateConfig(b),c}return P(b,a),b.prototype.handleBridgeMessage=function(b){var c=this;switch(a.prototype.handleBridgeMessage.call(this,b),b.handler){case G.GET_CAPTCHA:var d=b.params.uuid,e=new Ga(d,{captcha_sid:b.params.captcha_sid,captcha_img:b.params.captcha_img});e.show().then(function(a){c.bridge.sendMessage({handler:G.GET_CAPTCHA+"Success",params:U({uuid:d},a)})}).catch(function(){c.bridge.sendMessage({handler:G.GET_CAPTCHA+"Fail",params:{uuid:d}}),e.destroy()});break;case Qa.INTERNAL_RESIZE:this.handleInternalIframeResize(b);break;case Qa.INTERNAL_LOGOUT:this.handleLogout();break;case Ra.CLOSE_CHAT:this.events.emit(Ra.CLOSE_CHAT,b.params);break;default:return}},b.prototype.handleInternalIframeResize=function(a){var b=a.params;this.iframe.width=b.width+"px",this.iframe.height=b.height+"px"},b.prototype.handleAfterUpdateConfig=function(){this.updateStyles()},b.prototype.handleAfterCreateIframe=function(){this.updateStyles()},b.prototype.validateParams=function(a){return a.peer_id>=0?Promise.reject(K("peer_id","Peer id can`t be positive")):Promise.resolve(a)},b.prototype.getIframeUrl=function(){var a=this;return oa.fetchDomain().then(function(){return a.getIframeUrlParams().then(function(a){var b=oa.get().connectDomain;return Promise.resolve("https://"+b+"/messenger?"+a)})})},b}($a);!function(a){a.SCANNED="VKSDKQRScaned",a.CLICKED="VKSDKQRClicked"}(Xa||(Xa={}));var cb,db=new da({container:[{rule:Y,errorText:M("container")}]});!function(a){function b(b){var c=a.call(this)||this;c.getIframeContainer=function(){return c.config.container?c.config.container:window.document.body};var d=db.validate(b);return!d.isValid()&&console.error(d.error()),(null==b?void 0:b.langId)&&!Aa.includes(null==b?void 0:b.langId)&&console.error(K("lang_id","This lang id is not allowed")),c.updateConfig(b),c}P(b,a),b.prototype.getIframeUrl=function(){return this.getIframeUrlParams().then(function(a){var b=oa.get().connectDomain;return Promise.resolve("https://"+b+"/qr_auth?"+a)})},b.prototype.getIframeUrlParams=function(){var a=this;return oa.fetchDomain().then(function(){var b,c=oa.get(),d=c.appId,e=c._debug,f=c._localhost;return Promise.resolve(y({scheme:(null===(b=a.params)||void 0===b?void 0:b.scheme)||"bright_light",app_id:d,origin:location.protocol+"//"+location.host,lang_id:a.config.langId||null,initial_stats_info:xa(a.config.entry)||null,debug:e?1:null,localhost:f?1:null}))})},b.prototype.handleBridgeMessage=function(b){var c=this;switch(a.prototype.handleBridgeMessage.call(this,b),b.handler){case Xa.CLICKED:this.events.emit(Xa.CLICKED);break;case Xa.SCANNED:this.events.emit(Xa.SCANNED,b.params.token);break;case G.GET_CAPTCHA:var d=b.params.uuid,e=new Ga(d,{captcha_sid:b.params.captcha_sid,captcha_img:b.params.captcha_img});e.show().then(function(a){c.bridge.sendMessage({handler:G.GET_CAPTCHA+"Success",params:U({uuid:d},a)})}).catch(function(){c.bridge.sendMessage({handler:G.GET_CAPTCHA+"Fail",params:{uuid:d}}),e.destroy()});break;default:return}}}($a);!function(a){a.CONTENT_IN_HEIGHT="VKSDKUserContentInHeight",a.VALIDATION_PHONE_CLOSE="VKSDKUserValidationPhoneClose"}(cb||(cb={}));var eb,fb=new da({container:[{rule:Y,errorText:M("container")}]}),gb=new da({canSkip:[{rule:Y,errorText:M("canSkip")}],origin:[{rule:Y,errorText:M("origin")}]});!function(a){function b(b){var c=a.call(this)||this;c.getIframeContainer=function(){return c.config.container?c.config.container:window.document.body};var d=fb.validate(b);return!d.isValid()&&console.error(d.error()),c.updateConfig(b),c}P(b,a),b.prototype.getIframeUrl=function(){var a=U(U({redirect_uri:this.params.url,uuid:Ja()},F(this.params,["screen","source"])),{scheme:this.params.scheme}),b=wa(this.params.action);b&&(a.action=b);var c=xa(this.params.entry);return c&&(a.initial_stats_info=c),this.params.state&&(a.redirect_state=this.params.state),ya(a)},b.prototype.handleBridgeMessage=function(b){switch(a.prototype.handleBridgeMessage.call(this,b),b.handler){case cb.CONTENT_IN_HEIGHT:this.events.emit(cb.CONTENT_IN_HEIGHT,b.params);break;case cb.VALIDATION_PHONE_CLOSE:this.events.emit(cb.VALIDATION_PHONE_CLOSE,b.params);break;default:return}},b.prototype.validatePhone=function(a){var b=gb.validate(a);!b.isValid()&&console.error(b.error());var c={name:"auth_validation_phone",params:{status:a.canSkip?"1":"0"}};a.sid&&(c.params.sid=a.sid),this.open({url:a.origin,scheme:a.scheme,action:c})}}($a);!function(a){a.SUCCESS="VKSDKVerificationProfileSuccess",a.CLOSE="VKSDKVerificationProfileClose"}(eb||(eb={}));var hb,ib,jb,kb,lb=new da({config:[{rule:Y,errorText:M("config")}],provider:[{rule:X,errorText:L("provider")},{rule:Y,errorText:M("provider")}]}),mb=(function(a){function b(b){var c=a.call(this)||this;c.cssText="\n    position: fixed;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    z-index: 9999;\n    border: none;\n    display: none;\n  ";var d=lb.validate({config:b,provider:b.provider});return!d.isValid()&&console.error(d.error()),c.updateConfig(b),c}P(b,a),b.prototype.handleBridgeMessage=function(b){switch(a.prototype.handleBridgeMessage.call(this,b),b.handler){case eb.SUCCESS:this.events.emit(eb.SUCCESS);break;case eb.CLOSE:this.close();break;default:return}},b.prototype.handleAfterUpdateConfig=function(){this.updateZIndex()},b.prototype.handleAfterCreateIframe=function(){this.updateZIndex()},b.prototype.getIframeUrlParams=function(){var a=this;return oa.fetchDomain().then(function(){var b=oa.get(),c=b.superAppTokenV2,d=b.appId,e=b._debug,f=b._localhost;return Promise.resolve(y(U(U({},a.params),{app:d,superapp_token:c,origin:location.protocol+"//"+location.host,debug:e?1:null,localhost:f?1:null,provider:a.config.provider})))})},b.prototype.getIframeUrl=function(){var a=this;return oa.fetchDomain().then(function(){return a.getIframeUrlParams().then(function(a){var b=oa.get().connectDomain;return Promise.resolve("https://"+b+"/verification_profile?"+a)})})},b.prototype.updateZIndex=function(){if(this.iframe){var a=this.config.zIndex;this.iframe.style.zIndex=""+a}}}($a),k(1791)),nb=k(8624),ob=k.n(nb),pb=k(5881),qb=k(5261),rb=k.n(qb),sb=k(3440),tb=k.n(sb),ub=k(3169),vb=k.n(ub),wb=k(7920),xb=k.n(wb)().getScope("vk-messenger"),yb=function(a,b){return new Promise(function(c,d){xb.add("callSwaJsApi: "+a),function(a,b){return tb().post(a,b,{retries:1,xhrFields:{withCredentials:!0}}).then(function(a){var b=a.body;if("ok"===b.status)return b.body;if("fail"===b.status&&"sdc"===b.code){xb.add("callSwaJsApi: no sdc",a);var c=vb().process(a);return a.retry(c,!0).then(function(a){var b=a.body;if("ok"===b.status)return xb.add("callSwaJsApi: retry ok",a),b.body;throw xb.add("callSwaJsApi: retry error",a),b})}throw b})}(a,b).then(function(a){xb.add("callSwaJsApi: ok"),c(a)}).catch(function(a){var b,c,e,f,g,h=null!==(g=null!==(e=null===(c=null===(b=null==a?void 0:a.body)||void 0===b?void 0:b.error)||void 0===c?void 0:c.code)&&void 0!==e?e:null===(f=null==a?void 0:a.error)||void 0===f?void 0:f.code)&&void 0!==g?g:null==a?void 0:a.code;xb.add("callSwaJsApi: error: "+h,a),d(h)})})},zb=k(7050),Ab=k.n(zb),Bb=function(){return Ab().get("vk-messenger",{email:!1})},Cb=function(){Ab().set("vk-messenger",null,{email:!1}),xb.add("store.clearStore")},Db=function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d.throw(a))}catch(a){f(a)}}function i(a){var b;a.done?e(a.value):(b=a.value,b instanceof c?b:new c(function(a){a(b)})).then(g,h)}i((d=d.apply(a,b||[])).next())})},Eb=function(a,b){var c,d,e,f,g={label:0,sent:function(){if(1&e[0])throw e[1];return e[1]},trys:[],ops:[]};return f={next:h(0),throw:h(1),return:h(2)},"function"==typeof Symbol&&(f[Symbol.iterator]=function(){return this}),f;function h(f){return function(h){return function(f){if(c)throw new TypeError("Generator is already executing.");for(;g;)try{if(c=1,d&&(e=2&f[0]?d.return:f[0]?d.throw||((e=d.return)&&e.call(d),0):d.next)&&!(e=e.call(d,f[1])).done)return e;if(d=0,e)f=[2&f[0],e.value];switch(f[0]){case 0:case 1:e=f;break;case 4:return g.label++,{value:f[1],done:!1};case 5:g.label++,d=f[1],f=[0];continue;case 7:f=g.ops.pop(),g.trys.pop();continue;default:if(!(e=g.trys,(e=e.length>0&&e[e.length-1])||6!==f[0]&&2!==f[0])){g=0;continue}if(3===f[0]&&(!e||f[1]>e[0]&&f[1]<e[3])){g.label=f[1];break}if(6===f[0]&&g.label<e[1]){g.label=e[1],e=f;break}if(e&&g.label<e[2]){g.label=e[2],g.ops.push(f);break}if(e[2])g.ops.pop();g.trys.pop();continue}f=b.call(a,g)}catch(a){f=[6,a],d=0}finally{c=e=0}if(5&f[0])throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}([f,h])}}},Fb=function(a){return Db(void 0,void 0,Promise,function(){var c,d,e;return Eb(this,function(f){switch(f.label){case 0:return f.trys.push([0,2,,3]),xb.add("getSuperappToken: Connect.userVisibleAuth ".concat(a?"forced":"")),b().send("vk-messenger_vkc-visible"),[4,Va.userVisibleAuth(a?{action:{name:"login_silent_user"}}:null)];case 1:return c=f.sent(),xb.add("getSuperappToken: Connect.userVisibleAuth result: ".concat((null===(e=null==c?void 0:c.payload)||void 0===e?void 0:e.auth)?"auth ok":"no auth")),[2,null==c?void 0:c.payload];case 2:return d=f.sent(),b().send("vk-messenger_vkc-closed"),xb.add("getSuperappToken: Connect.userVisibleAuth error",d),[3,3];case 3:return[2]}})})},Gb=function(a,c){return Db(void 0,void 0,Promise,function(){var d,e,f,g,h,i,j,k;return Eb(this,function(l){switch(l.label){case 0:if(xb.add("getSuperappToken start: ".concat(a?"forced":""," ").concat(c?"onlySilent":"")),a)!function(){var a=Bb().email;if(a)Ab().set("vk-messenger",{email:a,token:null},{email:!1});else Ab().set("vk-messenger",null,{email:!1});xb.add("store.clearToken")}();if(a)return[3,2];else return[4,Db(void 0,void 0,Promise,function(){return Eb(this,function(a){if(xb.add("getCachedToken: start"),!Bb())return xb.add("getCachedToken: no stored token"),[2,""];if(rb().get("initialUser.email")!==Bb().email)return xb.add("getCachedToken error: invalid stored token"),Cb(),[2,""];else return xb.add("getCachedToken: return stored token"),[2,Bb().token]})})];case 1:if(d=l.sent())return xb.add("getSuperappToken return stored token"),[2,d];l.label=2;case 2:if(mb.VK_MESSENGER_DISABLE_SILENT_AUTH)return[3,4];else return xb.add("getSuperappToken try silent auth"),[4,Db(void 0,void 0,Promise,function(){var a,c,d;return Eb(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),xb.add("getSuperappToken: Connect.silentAuth"),b().send("vk-messenger_vkc-silent"),[4,Va.silentAuth()];case 1:return a=e.sent(),xb.add("getSuperappToken: Connect.silentAuth result: ".concat((null===(d=null==a?void 0:a.payload)||void 0===d?void 0:d.auth)?"auth ok":"no auth")),[2,null==a?void 0:a.payload];case 2:return c=e.sent(),b().send("vk-messenger_vkc-silent-error"),xb.add("getSuperappToken: Connect.silentAuth error",c),[3,3];case 3:return[2]}})})];case 3:e=l.sent(),l.label=4;case 4:if((null==e?void 0:e.auth)||c)return[3,6];else return xb.add("getSuperappToken try visible auth"),[4,Fb(a)];case 5:e=l.sent(),l.label=6;case 6:if(!e||!e.auth){if(xb.add("getSuperappToken: invalid payload error, return empty token",e),e&&!c)ob().error({unique:!0});return[2,""]}f=e.token,g=e.uuid,h="",l.label=7;case 7:return l.trys.push([7,9,,10]),xb.add("getSuperappToken: call jsapi "+mb.SWA_SUPERAPP_SILENT_URL),[4,yb(mb.SWA_SUPERAPP_SILENT_URL,{silent_token:f,uuid:g,client_id:mb.VK_MESSENGER_APP_ID,act_token:rb().get("authCSRFToken"),scope:"messenger",subject:"superappkit-web",no_bind:1})];case 8:if(i=l.sent(),h=i.superapp_token_v2||"",xb.add("getSuperappToken: call jsapi result ".concat(h.length?"ok":"empty")),!h.length)(0,pb.coreLoggerDispatchSelfError)("vk-widget",new Error("superapp/silent: empty superapp_token_v2"));return[3,10];case 9:return j=l.sent(),ob().error({unique:!0}),xb.add("getSuperappToken: call jsapi error "+j),(0,pb.coreLoggerDispatchSelfError)("vk-widget",new Error("superapp/silent: api error")),[3,10];case 10:if(h){if(!(null===(k=Bb())||void 0===k?void 0:k.email)&&mb.VK_MESSENGER_SHOW_AUTH_NOTIFY)!function(a){if(null==a?void 0:a.user){var b=a.user,c=b.first_name,d=b.last_name;ob().add({text:i18n("Вы вошли как {vkUserName}",{vkUserName:"".concat(c," ").concat(d)}),qa:"vk-widget-auth-notify"})}}(e);!function(a,b){Ab().set("vk-messenger",{email:b,token:a},{email:!1}),xb.add("store.setStore",a.length?"ok":"empty")}(h,rb().get("initialUser.email"))}return xb.add("getSuperappToken: result ".concat(h.length?"ok":"empty")),[2,h]}})})},Hb=(hb=mb.VK_MESSENGER_AUTH_THROTTLE,ib=!1,jb=null,kb=null,function(a,b){if(jb!==a)ib=!1,clearTimeout(kb);if(jb=a,ib)return ib;else return kb=setTimeout(function(){ib=!1},hb),ib=Gb(a,b)}),Ib=function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d.throw(a))}catch(a){f(a)}}function i(a){var b;a.done?e(a.value):(b=a.value,b instanceof c?b:new c(function(a){a(b)})).then(g,h)}i((d=d.apply(a,b||[])).next())})},Jb=function(a,b){var c,d,e,f,g={label:0,sent:function(){if(1&e[0])throw e[1];return e[1]},trys:[],ops:[]};return f={next:h(0),throw:h(1),return:h(2)},"function"==typeof Symbol&&(f[Symbol.iterator]=function(){return this}),f;function h(f){return function(h){return function(f){if(c)throw new TypeError("Generator is already executing.");for(;g;)try{if(c=1,d&&(e=2&f[0]?d.return:f[0]?d.throw||((e=d.return)&&e.call(d),0):d.next)&&!(e=e.call(d,f[1])).done)return e;if(d=0,e)f=[2&f[0],e.value];switch(f[0]){case 0:case 1:e=f;break;case 4:return g.label++,{value:f[1],done:!1};case 5:g.label++,d=f[1],f=[0];continue;case 7:f=g.ops.pop(),g.trys.pop();continue;default:if(!(e=g.trys,(e=e.length>0&&e[e.length-1])||6!==f[0]&&2!==f[0])){g=0;continue}if(3===f[0]&&(!e||f[1]>e[0]&&f[1]<e[3])){g.label=f[1];break}if(6===f[0]&&g.label<e[1]){g.label=e[1],e=f;break}if(e&&g.label<e[2]){g.label=e[2],g.ops.push(f);break}if(e[2])g.ops.pop();g.trys.pop();continue}f=b.call(a,g)}catch(a){f=[6,a],d=0}finally{c=e=0}if(5&f[0])throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}([f,h])}}},Kb=null,Lb=null,Mb=function(a){return(a||0)+15},Nb={open:function(a){var c=a.chatId,d=a.onShow,e=a.darkMode,f=a.offset,g=a.onClose;return Ib(void 0,void 0,void 0,function(){var a,h,i;return Jb(this,function(j){if(!Kb)Kb=new bb({styles:{right:"".concat(Mb(f),"px"),bottom:"0px",zIndex:500}}),a=function(a){Kb.close(),ob().error({unique:!0}),b().send("vk-messenger_internal-error"),xb.add("messenger internal error",a)},h=function(){b().send("in_mail_close_vk_messenger-chat")},i=function(){if(b().send("in_mail_close_vk_messenger"),xb.add("store.clearActiveChat"),Ab().set(mb.VK_MESSENGER_ACTIVE_CHAT_STORAGE_KEY,null),Kb.off(G.ERROR,a),Kb.off(Ra.CLOSE_CHAT,h),Kb.off(G.CLOSE,g),Kb=null,g)g()},Kb.on(G.ERROR,a),Kb.on(Ra.CLOSE_CHAT,h),Kb.on(G.CLOSE,i);return Lb=d,Kb.open({peer_id:-c,scheme:e?"space_gray":"bright_light"}).catch(function(a){b().send("vk-messenger_open-error"),xb.add("messenger open error",a)}),function(a){xb.add("store.setActiveChat",a),Ab().set(mb.VK_MESSENGER_ACTIVE_CHAT_STORAGE_KEY,a)}(c),[2]})})},setThemeMode:function(a){if(Kb)Kb.update({scheme:a?"space_gray":"bright_light"})},setOffset:function(a){if(Kb)Kb.update(null,{styles:{right:"".concat(Mb(a),"px")}})},setSuperappToken:function(a){if(oa.setSuperAppToken(a,{version:2}),a&&Lb)Lb(),Lb=null},isOpen:function(){return!!Kb},_onRequestSuperAppToken:function(a){return Ib(void 0,void 0,void 0,function(){var b,c;return Jb(this,function(d){switch(d.label){case 0:return b=a.refresh,xb.add("Config.onRequestSuperAppToken ".concat(b?"forced (drop saved token)":"")),[4,Ob(b,!b)];case 1:return c=d.sent(),xb.add("Config.onRequestSuperAppToken ".concat(b?"forced ":"","result: ").concat(c.length?"ok":"empty")),[2,c]}})})}};oa.init({appId:mb.VK_MESSENGER_APP_ID,loginDomain:mb.VK_LOGIN_DOMAIN,oauthDomain:mb.VK_OAUTH_DOMAIN,connectDomain:mb.VK_CONNECT_DOMAIN}),xb.add("Config.init",oa.get());var Ob=function(a,b){return Ib(void 0,void 0,Promise,function(){var c;return Jb(this,function(d){switch(d.label){case 0:return[4,Hb(a,b)];case 1:if(void 0===(c=d.sent()))return[2,""];else return xb.add("tryGetSuperappToken: set ".concat((null==c?void 0:c.length)?"ok":"empty"," token to widget")),Nb.setSuperappToken(c),[2,c]}})})};oa.onAuth(function(){return Ib(void 0,void 0,void 0,function(){var a;return Jb(this,function(b){switch(b.label){case 0:return xb.add("Config.onAuth"),[4,Ob()];case 1:return a=b.sent(),xb.add("Config.onAuth result: token ".concat(a.length?"ok":"empty")),[2,a]}})})}),oa.onRequestSuperAppToken(Nb._onRequestSuperAppToken),oa.onLogout(function(){if(mb.VK_MESSENGER_LOGOUT)xb.add("Config.onLogout"),Va.logout().then(function(){xb.add("Config.onLogout success"),Cb()})});var Pb=Nb}(),l}()});define("ui-react/containers/SettingsDock/SettingsDock",["require","exports"],function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=null});define("ui-react/components/LetterHeaderActions/LetterHeaderActions",["require","exports"],function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=null});define("ui-react/components/ListLetterHeaderActions/ListLetterHeaderActions",["require","exports"],function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=null});define("ui-react/components/VkMessengerProvider/VkMessengerProvider",["require","exports"],function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=null});define("ui-react/components/WidgetColumn/WidgetColumn",["require","exports"],function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=null});define("ui-react/containers/SearchPanel/SearchPanel",["require","exports"],function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=null});"use strict";var __window=Function("return this")();__window.fest=__window.fest||{};__window.fest["mailru-toolkit.lego"]=__window["mailru-toolkit.lego"]=function(a){"use strict";var b=this,c="",d=[],e,f=[],g,h,i,j,k,l="",m={},n,o,p="",q="",r="",s=/[&<>"]/g,t=/[&<>"]/,u={area:true,base:true,br:true,col:true,command:true,embed:true,hr:true,img:true,input:true,keygen:true,link:true,meta:true,param:true,source:true,wbr:true},v=[],w={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"},x=/[\\'"\/\n\r\t\b\f<>]/g,y=/[\\'"\/\n\r\t\b\f<>]/,z={'"':'\\"',"\\":"\\\\","/":"\\/","\n":"\\n","\r":"\\r","\t":"\\t","\b":"\\b","\f":"\\f","'":"\\'","<":"\\u003C",">":"\\u003E"},i18n=b&&typeof b.i18n==="function"?b.i18n:function(a){return a},A;if(typeof __fest_error==="undefined"){A=typeof console!=="undefined"&&console.error?function(){return Function.prototype.apply.call(console.error,console,arguments)}:function(){}}else{A=__fest_error}function B(a){A(a+'\nin block "'+r+'" at line: '+q+"\nfile: "+p)}function C(a){return w[a]}function D(a){return z[a]}function E(a,b){for(var c in b)if(b.hasOwnProperty(c))a[c]=b[c]}function F(a){a.param=true;return a}function G(a,c,d){if(d)for(var e in c)if(typeof c[e]=="function"&&c[e].param)c[e]=c[e]();return a.call(b,c)}function H(a){if(typeof a==="string"){if(y.test(a))return a.replace(x,D)}else if(typeof a==="undefined")return"";return a}function I(a){if(typeof a==="string"){if(t.test(a))return a.replace(s,C)}else if(typeof a==="undefined")return"";return a}var J=a;(function(a){var b=a;(function(a){m["class-attribute"]=function(a){var b="";b+=' class="';try{b+=I(a.baseClass)}catch(a){B(a.message+"5")}try{b+=I(a.mods&&a.mods.length?" "+a.baseClass+"_"+a.mods.join(" "+a.baseClass+"_"):"")}catch(a){B(a.message+"6")}try{b+=I(a.classes&&a.classes.length?" "+a.classes.join(" "):"")}catch(a){B(a.message+"7")}b+='"';return b}})(a);(function(a){var b=a;try{var exports=Function("return this")();exports.__dataModelGID=exports.__dataModelGID||0;var c=exports.__dataModelStore||(exports.__dataModelStore={});var d=exports.window===window;exports.__isToolkitDataModel=function(a){return c.hasOwnProperty(a)};exports.__toolkitDataModelSerialize=function(a){if(d){var b=++exports.__dataModelGID;c[b]=a;return b}else{return JSON.stringify(a)}};exports.__toolkitDataModelDeserialize=function(a){var b=c[a];delete c[a];return b}}catch(a){B(a.message)}})(a);(function(a){m.ico=function(a){var b="";b+='<i data-bem="ico" class="ico';try{h=a.mods}catch(a){h=false;B(a.message)}if(h){b+=" ";try{b+=I("ico_"+a.mods.join(" ico_"))}catch(a){B(a.message+"11")}}try{h=a.classes}catch(a){h=false;B(a.message)}if(h){b+=" ";try{b+=I(a.classes.join(" "))}catch(a){B(a.message+"16")}}b+='"';try{h=a.attrs}catch(a){h=false;B(a.message)}if(h){g="attributes";n={};try{n=a.attrs}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}b+="></i>";return b}})(a);(function(a){m["b-list__item__content"]=function(a){var b="";b+='<div class="b-list__item__content"';try{h=a.dataIndex!==void 0}catch(a){h=false;B(a.message)}if(h){b+=' data-index="';try{g=a.dataIndex}catch(a){g="";B(a.message)}b+=g;b+='"'}b+=">";try{h=a.block}catch(a){h=false;B(a.message)}if(h){try{g=a.block}catch(a){g="";B(a.message)}n={};try{n=a}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}try{h=a.html}catch(a){h=false;B(a.message)}if(h){try{b+=a.html}catch(a){B(a.message+"14")}}b+="</div>";return b};m["b-list__item"]=function(a){var b="";try{f[0]=I(a.mods?" b-list__item_"+a.mods.join(" b-list__item_"):"")}catch(a){f[0]="";B(a.message)}b+='<div class="b-list__item b-list__list__item '+f[0]+'">';try{h=a.href}catch(a){h=false;B(a.message)}if(h){try{f[0]=I(a.href)}catch(a){f[0]="";B(a.message)}b+='<a class="b-list__item__link" href="'+f[0]+'"';g="props-attribute";n={};try{n=a.props}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+=">";g="b-list__item__content";n={};try{n=a}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+="</a>"}try{h=!a.href}catch(a){h=false;B(a.message)}if(h){g="b-list__item__content";n={};try{n=a}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}try{h=a.removeHref}catch(a){h=false;B(a.message)}if(h){try{f[0]=I(a.removeHref)}catch(a){f[0]="";B(a.message)}b+='<a class="b-list__item__remove" href="'+f[0]+'">';g="ico";n={};try{n={mods:["settings","system_close"]}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+="</a>"}b+="</div>";return b}})(a);(function(a){var b=a;m["b-list"]=function(a){var b="";try{f[0]=I((a.mods&&a.mods.length?" b-list_"+a.mods.join(" b-list_"):"")+(a.shortcut?"js-"+a.shortcut:""))}catch(a){f[0]="";B(a.message)}try{f[1]=I(a.items.length?"":"b-list_noborder")}catch(a){f[1]="";B(a.message)}b+='<div class="b-list '+f[0]+""+f[1]+'" data-bem="';try{b+=I("b-list")}catch(a){B(a.message+"5")}b+='" data-model="';try{b+=I(__toolkitDataModelSerialize(a))}catch(a){B(a.message+"9")}b+='"';var c,d,e;try{e=a.props||{}}catch(a){i={};B(a.message)}for(c in e){d=e[c];try{g=c}catch(a){g="";B(a.message)}if(g!==""){b+=" "+g+'="';try{b+=I(d)}catch(a){B(a.message+"16")}b+='"'}}b+='><div class="b-list__list">';try{h=a.mods&&a.mods.indexOf("easy")!==-1}catch(a){h=false;B(a.message)}if(h){var j,l,o,p;try{p=a.items||[];o=p.length}catch(a){p=[];o=0;B(a.message)}for(j=0;j<o;j++){l=p[j];try{g=l.block}catch(a){g="";B(a.message)}n={};try{n=l}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}}else{var j,l,q,r;try{r=a.items||[];q=r.length}catch(a){r=[];q=0;B(a.message)}for(j=0;j<q;j++){l=r[j];g="b-list__item";n={};try{n=l}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}}b+="</div></div>";return b}})(a);(function(a){var b=a;m["b-spinner"]=function(a){var b="";try{a.classes=a.classes||[];if(a.shortcut){a.classes.push("js-"+a.shortcut)}}catch(a){B(a.message)}b+="<div";g="class-attribute";n={};try{n={baseClass:"b-spinner",mods:a.mods,classes:a.classes}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+=' data-bem="';try{b+=I("b-spinner")}catch(a){B(a.message+"18")}b+='" data-blockid="';try{b+=I("b-spinner")}catch(a){B(a.message+"21")}b+='" data-model="';try{b+=I(__toolkitDataModelSerialize(a))}catch(a){B(a.message+"24")}b+='"><div class="b-spinner__icon">';g="b-spinner__icon";n={};k=m[g];if(k)b+=G(k,n,false);b+="</div>";try{h=a.text}catch(a){h=false;B(a.message)}if(h){b+='<div class="b-spinner__text">';try{b+=I(a.text)}catch(a){B(a.message+"34")}b+="</div>"}b+="</div>";return b}})(a);(function(a){var b=a;m["b-spinner__icon"]=function(a){var b="";b+='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 64 64"><defs><path id="a" d="M0 0h32v32H0z"></path><mask id="b"><path fill="#fff" d="M0 0h64v64H0z"></path><use fill="#020202" xlink:href="#a" transform="rotate(-146 32 32)"></use><use fill="#040404" xlink:href="#a" transform="rotate(-144 32 32)"></use><use fill="#060606" xlink:href="#a" transform="rotate(-142 32 32)"></use><use fill="#080808" xlink:href="#a" transform="rotate(-140 32 32)"></use><use fill="#0A0A0A" xlink:href="#a" transform="rotate(-138 32 32)"></use><use fill="#0C0C0C" xlink:href="#a" transform="rotate(-136 32 32)"></use><use fill="#0E0E0E" xlink:href="#a" transform="rotate(-134 32 32)"></use><use fill="#101010" xlink:href="#a" transform="rotate(-132 32 32)"></use><use fill="#131313" xlink:href="#a" transform="rotate(-130 32 32)"></use><use fill="#151515" xlink:href="#a" transform="rotate(-128 32 32)"></use><use fill="#171717" xlink:href="#a" transform="rotate(-126 32 32)"></use><use fill="#191919" xlink:href="#a" transform="rotate(-124 32 32)"></use><use fill="#1B1B1B" xlink:href="#a" transform="rotate(-122 32 32)"></use><use fill="#1D1D1D" xlink:href="#a" transform="rotate(-120 32 32)"></use><use fill="#1F1F1F" xlink:href="#a" transform="rotate(-118 32 32)"></use><use fill="#212121" xlink:href="#a" transform="rotate(-116 32 32)"></use><use fill="#242424" xlink:href="#a" transform="rotate(-114 32 32)"></use><use fill="#262626" xlink:href="#a" transform="rotate(-112 32 32)"></use><use fill="#282828" xlink:href="#a" transform="rotate(-110 32 32)"></use><use fill="#2A2A2A" xlink:href="#a" transform="rotate(-108 32 32)"></use><use fill="#2C2C2C" xlink:href="#a" transform="rotate(-106 32 32)"></use><use fill="#2E2E2E" xlink:href="#a" transform="rotate(-104 32 32)"></use><use fill="#303030" xlink:href="#a" transform="rotate(-102 32 32)"></use><use fill="#323232" xlink:href="#a" transform="rotate(-100 32 32)"></use><use fill="#353535" xlink:href="#a" transform="rotate(-98 32 32)"></use><use fill="#373737" xlink:href="#a" transform="rotate(-96 32 32)"></use><use fill="#393939" xlink:href="#a" transform="rotate(-94 32 32)"></use><use fill="#3B3B3B" xlink:href="#a" transform="rotate(-92 32 32)"></use><use fill="#3D3D3D" xlink:href="#a" transform="rotate(-90 32 32)"></use><use fill="#3F3F3F" xlink:href="#a" transform="rotate(-88 32 32)"></use><use fill="#414141" xlink:href="#a" transform="rotate(-86 32 32)"></use><use fill="#434343" xlink:href="#a" transform="rotate(-84 32 32)"></use><use fill="#464646" xlink:href="#a" transform="rotate(-82 32 32)"></use><use fill="#484848" xlink:href="#a" transform="rotate(-80 32 32)"></use><use fill="#4A4A4A" xlink:href="#a" transform="rotate(-78 32 32)"></use><use fill="#4C4C4C" xlink:href="#a" transform="rotate(-76 32 32)"></use><use fill="#4E4E4E" xlink:href="#a" transform="rotate(-74 32 32)"></use><use fill="#505050" xlink:href="#a" transform="rotate(-72 32 32)"></use><use fill="#525252" xlink:href="#a" transform="rotate(-70 32 32)"></use><use fill="#545454" xlink:href="#a" transform="rotate(-68 32 32)"></use><use fill="#575757" xlink:href="#a" transform="rotate(-66 32 32)"></use><use fill="#595959" xlink:href="#a" transform="rotate(-64 32 32)"></use><use fill="#5B5B5B" xlink:href="#a" transform="rotate(-62 32 32)"></use><use fill="#5D5D5D" xlink:href="#a" transform="rotate(-60 32 32)"></use><use fill="#5F5F5F" xlink:href="#a" transform="rotate(-58 32 32)"></use><use fill="#616161" xlink:href="#a" transform="rotate(-56 32 32)"></use><use fill="#636363" xlink:href="#a" transform="rotate(-54 32 32)"></use><use fill="#656565" xlink:href="#a" transform="rotate(-52 32 32)"></use><use fill="#686868" xlink:href="#a" transform="rotate(-50 32 32)"></use><use fill="#6A6A6A" xlink:href="#a" transform="rotate(-48 32 32)"></use><use fill="#6C6C6C" xlink:href="#a" transform="rotate(-46 32 32)"></use><use fill="#6E6E6E" xlink:href="#a" transform="rotate(-44 32 32)"></use><use fill="#707070" xlink:href="#a" transform="rotate(-42 32 32)"></use><use fill="#727272" xlink:href="#a" transform="rotate(-40 32 32)"></use><use fill="#747474" xlink:href="#a" transform="rotate(-38 32 32)"></use><use fill="#767676" xlink:href="#a" transform="rotate(-36 32 32)"></use><use fill="#797979" xlink:href="#a" transform="rotate(-34 32 32)"></use><use fill="#7B7B7B" xlink:href="#a" transform="rotate(-32 32 32)"></use><use fill="#7D7D7D" xlink:href="#a" transform="rotate(-30 32 32)"></use><use fill="#7F7F7F" xlink:href="#a" transform="rotate(-28 32 32)"></use><use fill="#818181" xlink:href="#a" transform="rotate(-26 32 32)"></use><use fill="#838383" xlink:href="#a" transform="rotate(-24 32 32)"></use><use fill="#858585" xlink:href="#a" transform="rotate(-22 32 32)"></use><use fill="#878787" xlink:href="#a" transform="rotate(-20 32 32)"></use><use fill="#8A8A8A" xlink:href="#a" transform="rotate(-18 32 32)"></use><use fill="#8C8C8C" xlink:href="#a" transform="rotate(-16 32 32)"></use><use fill="#8E8E8E" xlink:href="#a" transform="rotate(-14 32 32)"></use><use fill="#909090" xlink:href="#a" transform="rotate(-12 32 32)"></use><use fill="#929292" xlink:href="#a" transform="rotate(-10 32 32)"></use><use fill="#949494" xlink:href="#a" transform="rotate(-8 32 32)"></use><use fill="#969696" xlink:href="#a" transform="rotate(-6 32 32)"></use><use fill="#989898" xlink:href="#a" transform="rotate(-4 32 32)"></use><use fill="#9B9B9B" xlink:href="#a" transform="rotate(-2 32 32)"></use><use fill="#9D9D9D" xlink:href="#a"></use><use fill="#9F9F9F" xlink:href="#a" transform="rotate(2 32 32)"></use><use fill="#A1A1A1" xlink:href="#a" transform="rotate(4 32 32)"></use><use fill="#A3A3A3" xlink:href="#a" transform="rotate(6 32 32)"></use><use fill="#A5A5A5" xlink:href="#a" transform="rotate(8 32 32)"></use><use fill="#A7A7A7" xlink:href="#a" transform="rotate(10 32 32)"></use><use fill="#A9A9A9" xlink:href="#a" transform="rotate(12 32 32)"></use><use fill="#ACACAC" xlink:href="#a" transform="rotate(14 32 32)"></use><use fill="#AEAEAE" xlink:href="#a" transform="rotate(16 32 32)"></use><use fill="#B0B0B0" xlink:href="#a" transform="rotate(18 32 32)"></use><use fill="#B2B2B2" xlink:href="#a" transform="rotate(20 32 32)"></use><use fill="#B4B4B4" xlink:href="#a" transform="rotate(22 32 32)"></use><use fill="#B6B6B6" xlink:href="#a" transform="rotate(24 32 32)"></use><use fill="#B8B8B8" xlink:href="#a" transform="rotate(26 32 32)"></use><use fill="#BABABA" xlink:href="#a" transform="rotate(28 32 32)"></use><use fill="#BDBDBD" xlink:href="#a" transform="rotate(30 32 32)"></use><use fill="#BFBFBF" xlink:href="#a" transform="rotate(32 32 32)"></use><use fill="#C1C1C1" xlink:href="#a" transform="rotate(34 32 32)"></use><use fill="#C3C3C3" xlink:href="#a" transform="rotate(36 32 32)"></use><use fill="#C5C5C5" xlink:href="#a" transform="rotate(38 32 32)"></use><use fill="#C7C7C7" xlink:href="#a" transform="rotate(40 32 32)"></use><use fill="#C9C9C9" xlink:href="#a" transform="rotate(42 32 32)"></use><use fill="#CBCBCB" xlink:href="#a" transform="rotate(44 32 32)"></use><use fill="#CECECE" xlink:href="#a" transform="rotate(46 32 32)"></use><use fill="#D0D0D0" xlink:href="#a" transform="rotate(48 32 32)"></use><use fill="#D2D2D2" xlink:href="#a" transform="rotate(50 32 32)"></use><use fill="#D4D4D4" xlink:href="#a" transform="rotate(52 32 32)"></use><use fill="#D6D6D6" xlink:href="#a" transform="rotate(54 32 32)"></use><use fill="#D8D8D8" xlink:href="#a" transform="rotate(56 32 32)"></use><use fill="#DADADA" xlink:href="#a" transform="rotate(58 32 32)"></use><use fill="#DCDCDC" xlink:href="#a" transform="rotate(60 32 32)"></use><use fill="#DFDFDF" xlink:href="#a" transform="rotate(62 32 32)"></use><use fill="#E1E1E1" xlink:href="#a" transform="rotate(64 32 32)"></use><use fill="#E3E3E3" xlink:href="#a" transform="rotate(66 32 32)"></use><use fill="#E5E5E5" xlink:href="#a" transform="rotate(68 32 32)"></use><use fill="#E7E7E7" xlink:href="#a" transform="rotate(70 32 32)"></use><use fill="#E9E9E9" xlink:href="#a" transform="rotate(72 32 32)"></use><use fill="#EBEBEB" xlink:href="#a" transform="rotate(74 32 32)"></use><use fill="#EDEDED" xlink:href="#a" transform="rotate(76 32 32)"></use><use fill="#F0F0F0" xlink:href="#a" transform="rotate(78 32 32)"></use><use fill="#F2F2F2" xlink:href="#a" transform="rotate(80 32 32)"></use><use fill="#F4F4F4" xlink:href="#a" transform="rotate(82 32 32)"></use><use fill="#F6F6F6" xlink:href="#a" transform="rotate(84 32 32)"></use><use fill="#F8F8F8" xlink:href="#a" transform="rotate(86 32 32)"></use><use fill="#FAFAFA" xlink:href="#a" transform="rotate(88 32 32)"></use><use fill="#FCFCFC" xlink:href="#a" transform="rotate(90 32 32)"></use><use fill="#FEFEFE" xlink:href="#a" transform="rotate(92 32 32)"></use></mask></defs><path d="M54.6 47.6c-1.98-1.98-5.09-1.98-7.07 0-8.56 8.56-22.6 8.56-31.1 0-8.56-8.56-8.56-22.6 0-31.1 4.54-5.58-3.25-10.7-7.07-7.07-12.4 12.4-12.4 32.8 0 45.3 12.4 12.4 32.8 12.4 45.3 0 1.98-1.98 1.98-5.09 0-7.07zM32 54c-12.1 0-22-9.9-22-22s9.9-22 22-22c2.8 0 5-2.2 5-5s-2.2-5-5-5C14.4 0 0 14.4 0 32s14.4 32 32 32c7.16-.736 5.26-9.84 0-10z" mask="url(#b)"></path></svg>';return b}})(a);(function(a){m["b-tree"]=function(a){var b="";b+="<div";try{h=a.mnemo}catch(a){h=false;B(a.message)}if(h){b+=' data-mnemo="';try{b+=I(a.mnemo)}catch(a){B(a.message+"8")}b+='"'}try{h=a.id}catch(a){h=false;B(a.message)}if(h){b+=' data-id="';try{b+=I(a.id)}catch(a){B(a.message+"14")}b+='"'}b+=' data-bem="';try{b+=I("b-tree")}catch(a){B(a.message+"19")}b+='"';try{var c="b-tree "+(a.mods?" b-tree_"+a.mods.join(" b-tree_"):"");var d=c.indexOf("right-arrow")>-1}catch(a){B(a.message)}b+=' class="';try{b+=I(c)}catch(a){B(a.message+"27")}b+='">';var e,f,i,j;try{j=a.items||[];i=j.length}catch(a){j=[];i=0;B(a.message)}for(e=0;e<i;e++){f=j[e];try{h=f}catch(a){h=false;B(a.message)}if(h){try{if(f instanceof Object){f.hoverId=a.hoverId;f.activeId=a.activeId;f.arrowRight=d}}catch(a){B(a.message)}try{h=f=="hr"}catch(a){h=false;B(a.message)}if(h){b+='<div class="b-tree__item b-tree__item_hr"></div>'}else{try{h=f.group}catch(a){h=false;B(a.message)}if(h){g="b-tree__group";n={};try{n=f}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}else{try{h=f.type=="option"}catch(a){h=false;B(a.message)}if(h){g="b-tree__item_option";n={};try{n=f}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}else{try{h=f.block}catch(a){h=false;B(a.message)}if(h){try{g=f.block}catch(a){g="";B(a.message)}n={};try{n=f}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}else{g="b-tree__item";n={};try{n=f}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}}}}}}b+="</div>";return b}})(a);(function(a){m["b-tree__group__name"]=function(a){var b="";b+='<div class="b-tree__item';try{h=a.group.active}catch(a){h=false;B(a.message)}if(h){b+=" b-tree__item_active"}try{h=a.group.type=="dropdown"}catch(a){h=false;B(a.message)}if(h){b+=" b-tree__item_group-name"}try{h=a.group.id}catch(a){h=false;B(a.message)}if(h){b+=" js-href"}b+='" href="';try{b+=I(a.group.href)}catch(a){B(a.message+"25")}b+='"';try{h=a.group.id}catch(a){h=false;B(a.message)}if(h){b+=' data-id="';try{b+=I(a.group.id)}catch(a){B(a.message+"28")}b+='"'}b+=">";try{h=a.group.href}catch(a){h=false;B(a.message)}if(h){b+='<a class="b-tree__link b-tree__link_group-name"';try{h=!a.withoutHistory}catch(a){h=false;B(a.message)}if(h){b+=' rel="history"'}b+=' href="';try{b+=a.group.href}catch(a){B(a.message+"47")}b+='">';try{h=a.group.type=="dropdown"&&!a.arrowRight}catch(a){h=false;B(a.message)}if(h){b+='<div class="b-tree__item__arrow b-tree__item__arrow_open"></div>'}b+='<span class="b-tree__item__text">';try{b+=I(a.group.name)}catch(a){B(a.message+"55")}b+="</span>";try{h=a.group.type=="dropdown"&&a.arrowRight}catch(a){h=false;B(a.message)}if(h){b+='<div class="b-tree__item__arrow b-tree__item__arrow_open"></div>'}b+="</a>"}else{b+='<div class="b-tree__link b-tree__link_group-name">';try{h=a.group.type=="dropdown"&&!a.arrowRight}catch(a){h=false;B(a.message)}if(h){b+='<div class="b-tree__item__arrow b-tree__item__arrow_open"></div>'}b+='<span class="b-tree__item__text">';try{b+=I(a.group.name)}catch(a){B(a.message+"75")}b+="</span>";try{h=a.group.type=="dropdown"&&a.arrowRight}catch(a){h=false;B(a.message)}if(h){b+='<div class="b-tree__item__arrow b-tree__item__arrow_open"></div>'}b+="</div>"}b+="</div>";return b};m["b-tree__group"]=function(a){var b="";try{f[0]=I(a.mods?" b-tree__group_"+a.mods.join(" b-tree__group_"):"")}catch(a){f[0]="";B(a.message)}b+='<div data-bem="b-tree__group" class="b-tree__group'+f[0]+'"><div class="b-tree__group__name">';g="b-tree__group__name";n={};try{n=a}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+='</div><div class="b-tree__group__list">';var c,d,e,i;try{i=a.items||[];e=i.length}catch(a){i=[];e=0;B(a.message)}for(c=0;c<e;c++){d=i[c];try{h=d}catch(a){h=false;B(a.message)}if(h){try{d.hoverId=a.hoverId;d.activeId=a.activeId;d.arrowRight=a.arrowRight}catch(a){B(a.message)}try{h=d=="hr"}catch(a){h=false;B(a.message)}if(h){b+='<div class="b-tree__item b-tree__item_hr"></div>'}else{try{h=d.group}catch(a){h=false;B(a.message)}if(h){g="b-tree__group";n={};try{n=d}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}else{g="b-tree__item";n={};try{n=d}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}}}}b+="</div></div>";return b}})(a);(function(a){m["b-tree__item__folding"]=function(a){var b="";b+='<div class="b-tree__item__folding js-folding" data-name="toggle-folding"';try{h=a.title}catch(a){h=false;B(a.message)}if(h){b+=' title="';try{b+=I(a.title)}catch(a){B(a.message+"8")}b+='"'}b+='><div class="b-tree__item__folding__arrow';try{h=a.folding=="open"}catch(a){h=false;B(a.message)}if(h){b+=" b-tree__item__folding__arrow_open"}b+='"></div></div>';return b};m["b-tree__item"]=function(a){var b="";b+='<div class="b-tree__item';try{h=a.href||a.hover}catch(a){h=false;B(a.message)}if(h){b+=" js-href"}try{h=a.type=="important"}catch(a){h=false;B(a.message)}if(h){b+=" b-tree__item_important"}try{h=a.hoverId!=null&&a.id!=null?a.hoverId==a.id:null}catch(a){h=false;B(a.message)}if(h){b+=" b-tree__item_hover"}try{h=a.active||(a.activeId!=null&&a.id!=null?a.activeId==a.id:null)}catch(a){h=false;B(a.message)}if(h){b+=" b-tree__item_active"}try{h=a.unread||a.found}catch(a){h=false;B(a.message)}if(h){b+=" b-tree__item_unread"}try{h=a.pad}catch(a){h=false;B(a.message)}if(h){b+=" b-tree__item_pad b-tree__item_pad";try{b+=I(a.pad)}catch(a){B(a.message+"61")}}try{h=a.type=="option"||a.type=="setting"}catch(a){h=false;B(a.message)}if(h){b+=" b-tree__item_no-bg"}try{h=a.uglyshift}catch(a){h=false;B(a.message)}if(h){b+=" b-tree__item_level-1"}try{h=a.processing}catch(a){h=false;B(a.message)}if(h){b+=" b-tree__item_processing"}try{h=a.sortedType}catch(a){h=false;B(a.message)}if(h){b+=" b-tree__item_right-icon"}b+='"';try{h=a.id!=null}catch(a){h=false;B(a.message)}if(h){b+=' data-id="';try{b+=I(a.id)}catch(a){B(a.message+"87")}b+='"'}try{h=a.name}catch(a){h=false;B(a.message)}if(h){b+=' data-name="';try{b+=I(a.name)}catch(a){B(a.message+"93")}b+='"'}try{h=a.folding}catch(a){h=false;B(a.message)}if(h){b+=' data-folding="';try{b+=I(a.folding)}catch(a){B(a.message+"99")}b+='"'}try{h=a.clean}catch(a){h=false;B(a.message)}if(h){b+=' data-clean="';try{b+=I(true)}catch(a){B(a.message+"105")}b+='"'}b+='><a class="b-tree__link';try{h=a.type=="setting"}catch(a){h=false;B(a.message)}if(h){b+=" b-tree__link_setting"}try{h=a.shortcut}catch(a){h=false;B(a.message)}if(h){b+=" js-shortcut"}b+='"';try{h=a.href}catch(a){h=false;B(a.message)}if(h){try{h=!a.withoutHistory}catch(a){h=false;B(a.message)}if(h){b+=' rel="history"'}b+=' href="';try{b+=a.href}catch(a){B(a.message+"132")}b+='"'}try{h=a.title}catch(a){h=false;B(a.message)}if(h){b+=' title="';try{b+=a.title}catch(a){B(a.message+"137")}b+='"'}try{h=a.shortcut}catch(a){h=false;B(a.message)}if(h){b+=' data-shortcut="';try{b+=I(a.shortcut)}catch(a){B(a.message+"142")}b+='" data-shortcut-title="none"'}try{h=a.mnemo}catch(a){h=false;B(a.message)}if(h){b+=' data-mnemo="';try{b+=I(a.mnemo)}catch(a){B(a.message+"150")}b+='"'}b+=">";try{h=a.folding&&!a.arrowRight}catch(a){h=false;B(a.message)}if(h){g="b-tree__item__folding";n={};try{n={title:a.foldingTitle,folding:a.folding}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}g="ico";n={};try{n={mods:["loader_blocks"],classes:["b-tree__item__spinner"]}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);try{h=a.found}catch(a){h=false;B(a.message)}if(h){b+='<span class="b-tree__item__count">';try{b+=a.found}catch(a){B(a.message+"172")}b+="</span>"}try{h=a._total&&a.clean}catch(a){h=false;B(a.message)}if(h){try{f[0]=I(a.id)}catch(a){f[0]="";B(a.message)}b+='<span data-id="'+f[0]+'" data-name="clear-folder" class="b-tree__link__option"><span class="b-tree__link__text js-clear-text">';try{b+=I(lang["b-tree_folders"]["clear_link"])}catch(a){B(a.message+"178")}b+='</span><i class="icon icon_loader js-clear-icon" style="display: none"></i></span>'}try{h=a.sortedType}catch(a){h=false;B(a.message)}if(h){b+='<div class="b-tree__ico b-tree__ico_setting b-tree__ico_right js-mailbox-sort"><i class="ico ico_folder_setting"></i></div>'}try{h=a.type=="checkbox"}catch(a){h=false;B(a.message)}if(h){b+='<div data-click="bem.checkbox.label.click"><div class="b-tree__ico">';g="b-checkbox";n={};try{n={mods:a.checked?["checked"]:null}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+="</div><span>";try{b+=I(a.text)}catch(a){B(a.message+"197")}b+="</span></div>"}else{try{h=a.icon}catch(a){h=false;B(a.message)}if(h){try{var c="",d=a.icon.split("_"),e=0,i=d.length;for(;e<i;e++){c+=(e?" "+c+"_":"")+d[e]}}catch(a){B(a.message)}b+='<div class="b-tree__ico"><i class="';try{b+=I(c)}catch(a){B(a.message+"215")}b+='"></i></div>'}b+='<span class="b-tree__item__text">';try{b+=I(a.text)}catch(a){B(a.message+"223")}b+="</span>"}try{h=a.folding&&a.arrowRight}catch(a){h=false;B(a.message)}if(h){g="b-tree__item__folding";n={};try{n={title:a.foldingTitle,folding:a.folding}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}b+="</a></div>";try{h=a.items instanceof Array}catch(a){h=false;B(a.message)}if(h){try{f[0]=I(a.folding?"b-tree__subitems_"+a.folding:"")}catch(a){f[0]="";B(a.message)}b+='<div class="b-tree__subitems '+f[0]+'"';try{h=a.id!==void 0}catch(a){h=false;B(a.message)}if(h){b+=' data-parent="';try{b+=I(a.id)}catch(a){B(a.message+"246")}b+='"'}b+=' data-pad="';try{b+=I((a.pad||0)+1)}catch(a){B(a.message+"251")}b+='">';var e,j,l,o;try{o=a.items||[];l=o.length}catch(a){o=[];l=0;B(a.message)}for(e=0;e<l;e++){j=o[e];try{j.hoverId=a.hoverId;j.activeId=a.activeId;j.arrowRight=a.arrowRight;j.pad=(j.pad||0)+(a.pad||0)+1}catch(a){B(a.message)}try{h=j.group}catch(a){h=false;B(a.message)}if(h){g="b-tree__group";n={};try{n=j}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}else{g="b-tree__item";n={};try{n=j}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}}b+="</div>"}return b}})(a);(function(a){m["b-tree__item_button"]=function(a){var b="";try{f[0]=I(a.href)}catch(a){f[0]="";B(a.message)}b+='<a href="'+f[0]+'" data-bem="btn" class="btn"><span class="btn__text">';try{b+=I(a.text)}catch(a){B(a.message+"6")}b+="</span></a>";return b}})(a);(function(a){m["b-tree__item_option"]=function(a){var b="";b+='<div class="b-tree__item"><a';try{h=a.href}catch(a){h=false;B(a.message)}if(h){try{h=!a.withoutHistory}catch(a){h=false;B(a.message)}if(h){b+=' rel="history"'}b+=' href="';try{b+=a.href}catch(a){B(a.message+"20")}b+='"'}try{h=a.id!=null}catch(a){h=false;B(a.message)}if(h){b+=' data-id="';try{b+=I(a.id)}catch(a){B(a.message+"26")}b+='"'}try{h=a.name}catch(a){h=false;B(a.message)}if(h){b+=' data-name="';try{b+=I(a.name)}catch(a){B(a.message+"32")}b+='"'}try{h=a.title}catch(a){h=false;B(a.message)}if(h){b+=' title="';try{b+=a.title}catch(a){B(a.message+"38")}b+='"'}b+=' class="b-tree__link';try{h=a.type=="option"}catch(a){h=false;B(a.message)}if(h){b+=" b-tree__link_option"}try{h=a.mods}catch(a){h=false;B(a.message)}if(h){b+=" ";try{b+=I("b-tree__link_"+a.mods.join("b-tree__link_"))}catch(a){B(a.message+"51")}}b+='"><span class="b-tree__link__text">';try{b+=I(a.text)}catch(a){B(a.message+"58")}b+="</span></a></div>";return b}})(a);(function(a){m.btn=function(a){var b="";try{h=a.items}catch(a){h=false;B(a.message)}if(h){b+="<div";try{h=a.role}catch(a){h=false;B(a.message)}if(h){b+=' role="';try{b+=I(a.role+"")}catch(a){B(a.message+"10")}b+='"'}try{h=a.mods&&a.mods.includes("disabled")}catch(a){h=false;B(a.message)}if(h){b+=' aria-disabled="disabled"'}try{h=a.name}catch(a){h=false;B(a.message)}if(h){b+=' data-name="';try{b+=I(a.name)}catch(a){B(a.message+"19")}b+='"'}try{h=a.group}catch(a){h=false;B(a.message)}if(h){b+=' data-group="';try{b+=I(a.group)}catch(a){B(a.message+"25")}b+='"'}try{h=a.title}catch(a){h=false;B(a.message)}if(h){b+=' title="';try{b+=I(a.title)}catch(a){B(a.message+"31")}b+='"'}try{h=a.id!=null}catch(a){h=false;B(a.message)}if(h){b+=' id="';try{b+=I(a.id)}catch(a){B(a.message+"37")}b+='"'}b+=">";var c,d,e,j;try{j=a.items||[];e=j.length}catch(a){j=[];e=0;B(a.message)}for(c=0;c<e;c++){d=j[c];try{h=d}catch(a){h=false;B(a.message)}if(h){try{d.mods=(d.mods||[]).concat(a.mods||[],"grouped");if(!c){d.mods.push("grouped_first")}else if(a.items.length-c==1){d.mods.push("grouped_last")}}catch(a){B(a.message)}try{g=d.block||"btn"}catch(a){g="";B(a.message)}n={};try{n=d}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}}b+="</div>"}else{try{var l=a.text==null&&typeof lang=="object"?lang.get("btn."+a.name):a.text;var p=a.href?"a":a.container||"button";var q=a.tooltip;var r=a.iconPosition||"left"}catch(a){B(a.message)}try{o=p;if(typeof o!=="string"){B("Element name must be a string");o="div"}}catch(a){o="div";B(a.message)}v.push(o);b+="<"+o;b+=' data-bem="btn" data-blockid="btn" data-model="';try{b+=I(__toolkitDataModelSerialize(a))}catch(a){B(a.message+"76")}b+='"';try{h=a.tabindex}catch(a){h=false;B(a.message)}if(h){b+=' tabindex="';try{b+=I(a.tabindex)}catch(a){B(a.message+"81")}b+='"'}try{h=a.id!=null}catch(a){h=false;B(a.message)}if(h){b+=' data-id="';try{b+=I(a.id)}catch(a){B(a.message+"87")}b+='"'}b+=' class="btn';try{b+=I(a.mods?" btn_"+a.mods.join(" btn_")+" ":" ")}catch(a){B(a.message+"93")}try{b+=I(a.classes)}catch(a){B(a.message+"94")}try{h=a.shortcut}catch(a){h=false;B(a.message)}if(h){b+=" js-shortcut"}b+='"';try{h=a.type}catch(a){h=false;B(a.message)}if(h){b+=' type="';try{b+=I(a.type)}catch(a){B(a.message+"103")}b+='"'}try{h=a.tabindex}catch(a){h=false;B(a.message)}if(h){b+=' tabindex="';try{b+=I(a.tabindex)}catch(a){B(a.message+"109")}b+='"'}try{h=a.href}catch(a){h=false;B(a.message)}if(h){b+=' href="';try{b+=I(a.href)}catch(a){B(a.message+"115")}b+='"';try{h=a.target}catch(a){h=false;B(a.message)}if(h){b+=' target="';try{b+=I(a.target)}catch(a){B(a.message+"120")}b+='"'}}try{h=a.rel}catch(a){h=false;B(a.message)}if(h){b+=' rel="';try{b+=I(a.rel)}catch(a){B(a.message+"127")}b+='"'}try{h=a.name}catch(a){h=false;B(a.message)}if(h){b+=' data-name="';try{b+=I(a.name)}catch(a){B(a.message+"133")}b+='"'}try{h=a.title}catch(a){h=false;B(a.message)}if(h){b+=' title="';try{b+=I(a.title)}catch(a){B(a.message+"139")}b+='"'}try{h=a.shortcut}catch(a){h=false;B(a.message)}if(h){b+=' data-shortcut="';try{b+=I(a.shortcut)}catch(a){B(a.message+"145")}b+='"'}try{h=a.mods&&a.mods.includes("disabled")}catch(a){h=false;B(a.message)}if(h){b+=' aria-disabled="disabled"'}try{h=a.mods&&a.mods.includes("disabled")}catch(a){h=false;B(a.message)}if(h){b+=' disabled="disabled"'}try{h=a.additionalAttrs}catch(a){h=false;B(a.message)}if(h){var s,t,w;try{w=a.additionalAttrs||{}}catch(a){i={};B(a.message)}for(s in w){t=w[s];try{g=s}catch(a){g="";B(a.message)}if(g!==""){b+=" "+g+'="';try{b+=I(t)}catch(a){B(a.message+"159")}b+='"'}}}o=v[v.length-1];b+=o in u?"/>":">";try{h=a.spinner}catch(a){h=false;B(a.message)}if(h){g="b-spinner";n={};try{n={classes:["btn__spinner"]}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}try{h=a.icon}catch(a){h=false;B(a.message)}if(h){try{var x=a.icon.split("_");x.pop();for(var y=1;y<x.length;y++){var z=y;while(--z>=0){x[y]=x[z]+"_"+x[y]}}x.unshift(a.icon)}catch(a){B(a.message)}}try{h=a.icon&&r=="left"}catch(a){h=false;B(a.message)}if(h){g="ico";n={};try{n={mods:x}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}try{h=q}catch(a){h=false;B(a.message)}if(h){b+='<div class="btn__tooltip"><div class="btn__tooltip__text">';try{b+=I(q)}catch(a){B(a.message+"197")}b+="</div></div>"}try{h=a.ctrl}catch(a){h=false;B(a.message)}if(h){try{g=a.ctrl.block}catch(a){g="";B(a.message)}n={};try{n=a.ctrl}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}else{try{h=l}catch(a){h=false;B(a.message)}if(h){try{f[0]=I(a.icon?" btn__text_pad":"")}catch(a){f[0]="";B(a.message)}b+='<span class="btn__text'+f[0]+'">';try{b+=I(l)}catch(a){B(a.message+"209")}b+="</span>"}else{}}try{h=a.icon&&r=="right"}catch(a){h=false;B(a.message)}if(h){g="ico";n={};try{n={mods:x}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}try{h=a.arrow}catch(a){h=false;B(a.message)}if(h){g="ico";n={};try{n={mods:["control_arrow_down"]}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}o=v[v.length-1];if(!(o in u)){b+="</"+o+">"}v.pop()}return b}})(a);(function(a){var b=a;m["b-input"]=function(a){var b="";try{var c=[];a.cssClass=a.cssClass||[];a.mods=a.mods||[];c=c.concat(a.cssClass);if(a.eltype==="textarea"){a.mods.push("textarea")}if(a.shortcut){c.push("js-"+a.shortcut)}}catch(a){B(a.message)}try{o=a.eltype?a.eltype:"input";if(typeof o!=="string"){B("Element name must be a string");o="div"}}catch(a){o="div";B(a.message)}v.push(o);b+="<"+o;g="class-attribute";n={};try{n={baseClass:"b-input",mods:a.mods,classes:c}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+=' data-bem="';try{b+=I(a.block?a.block:"b-input")}catch(a){B(a.message+"31")}b+='" data-model="';try{b+=I(__toolkitDataModelSerialize(a))}catch(a){B(a.message+"35")}b+='"';try{h=a.blockid}catch(a){h=false;B(a.message)}if(h){b+=' data-blockid="';try{b+=I(a.blockid)}catch(a){B(a.message+"40")}b+='"'}try{h=a.mods&&a.mods.includes("readonly")}catch(a){h=false;B(a.message)}if(h){b+=' readonly="readonly"'}try{h=a.mods&&a.mods.includes("disabled")}catch(a){h=false;B(a.message)}if(h){b+=' disabled="disabled"'}try{h=a.prop&&a.prop.type==="number"}catch(a){h=false;B(a.message)}if(h){b+=' pattern="[0-9]*"'}var d,e,f;try{f=a.props||{}}catch(a){i={};B(a.message)}for(d in f){e=f[d];try{h=e}catch(a){h=false;B(a.message)}if(h){try{g=d}catch(a){g="";B(a.message)}if(g!==""){b+=" "+g+'="';try{b+=I(e)}catch(a){B(a.message+"57")}b+='"'}}}o=v[v.length-1];b+=o in u?"/>":">";try{h=a.eltype==="textarea"&&a.props.value!==undefined}catch(a){h=false;B(a.message)}if(h){try{b+=I(a.props.value)}catch(a){B(a.message+"64")}}o=v[v.length-1];if(!(o in u)){b+="</"+o+">"}v.pop();return b}})(a);(function(a){var b=a;m["b-search"]=function(a){var b="";b+='<div data-model="';try{b+=I(JSON.stringify(a))}catch(a){B(a.message+"5")}b+='" class="b-search" data-bem="b-search"><form>';g="b-input";n={};try{n={props:{value:a.props.value,name:a.props.name,placeholder:a.props.placeholder,disabled:a.props.disabled},mods:a.mods}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);g="ico";n={};try{n={mods:a.icon.mods}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+="</form></div>";return b}})(a);(function(a){m["b-checkbox"]=function(a){var b="";b+='<div data-bem="b-checkbox"';try{var c=a.mods?" b-checkbox_"+a.mods.join(" b-checkbox_"):"";if(~c.indexOf("_disabled")){a.disabled=true}if(!a.props){a.props={}}}catch(a){B(a.message)}try{h=a.id!=null}catch(a){h=false;B(a.message)}if(h){b+=' data-id="';try{b+=I(a.id)}catch(a){B(a.message+"20")}b+='"'}try{h=a.name}catch(a){h=false;B(a.message)}if(h){b+=' data-name="';try{b+=I(a.name)}catch(a){B(a.message+"26")}b+='"'}try{h=a.shortcut}catch(a){h=false;B(a.message)}if(h){b+=' data-shortcut="';try{b+=I(a.shortcut)}catch(a){B(a.message+"32")}b+='"'}try{h=!a.withoutDataModel}catch(a){h=false;B(a.message)}if(h){b+=' data-model="';try{b+=I(__toolkitDataModelSerialize(a))}catch(a){B(a.message+"38")}b+='"'}b+=' class="js-checkbox b-checkbox';try{h=a.classes}catch(a){h=false;B(a.message)}if(h){b+=" ";try{b+=I(a.classes)}catch(a){B(a.message+"48")}}try{h=a.checked||a.__selected__}catch(a){h=false;B(a.message)}if(h){b+=" ";try{h=a.checkedMixed}catch(a){h=false;B(a.message)}if(h){b+="b-checkbox_checked_mixed"}else{b+="b-checkbox_checked"}}try{h=c}catch(a){h=false;B(a.message)}if(h){try{b+=I(c)}catch(a){B(a.message+"64")}}try{h=a.shortcut}catch(a){h=false;B(a.message)}if(h){b+=" js-shortcut"}b+='"';try{h=~c.indexOf("_disabled")}catch(a){h=false;B(a.message)}if(h){b+=' aria-disabled="disabled"'}b+='><div class="b-checkbox__box"></div><div class="b-checkbox__checkmark"></div>';try{h=a.label}catch(a){h=false;B(a.message)}if(h){b+='<span class="b-checkbox__label">';try{b+=I(a.label)}catch(a){B(a.message+"82")}b+="</span>"}try{h=a.htmlLabel}catch(a){h=false;B(a.message)}if(h){b+='<span class="b-checkbox__label b-checkbox__label_html">';try{b+=a.htmlLabel}catch(a){B(a.message+"86")}b+="</span>"}try{f[0]=I(a.props.name)}catch(a){f[0]="";B(a.message)}try{f[1]=I(a.props.value)}catch(a){f[1]="";B(a.message)}b+='<input type="hidden" class="b-checkbox__input" name="'+f[0]+'" value="'+f[1]+'"';try{h=!a.checked}catch(a){h=false;B(a.message)}if(h){b+=' disabled="disabled"'}b+="/></div>";return b}})(a);(function(a){m["b-checkbox"]=function(a){var b="";b+='<div data-bem="b-checkbox"';try{var c=a.mods?" b-checkbox_"+a.mods.join(" b-checkbox_"):"";if(~c.indexOf("_disabled")){a.disabled=true}if(!a.props){a.props={}}}catch(a){B(a.message)}try{h=a.id!=null}catch(a){h=false;B(a.message)}if(h){b+=' data-id="';try{b+=I(a.id)}catch(a){B(a.message+"19")}b+='"'}try{h=a.name}catch(a){h=false;B(a.message)}if(h){b+=' data-name="';try{b+=I(a.name)}catch(a){B(a.message+"25")}b+='"'}try{h=a.shortcut}catch(a){h=false;B(a.message)}if(h){b+=' data-shortcut="';try{b+=I(a.shortcut)}catch(a){B(a.message+"31")}b+='"'}try{h=!a.withoutDataModel}catch(a){h=false;B(a.message)}if(h){b+=' data-model="';try{b+=I(JSON.stringify(a))}catch(a){B(a.message+"37")}b+='"'}b+=' class="js-checkbox b-checkbox mb-checkbox';try{h=a.checked||a.__selected__}catch(a){h=false;B(a.message)}if(h){b+=" ";try{h=a.checkedMixed}catch(a){h=false;B(a.message)}if(h){b+="b-checkbox_checked_mixed"}else{b+="b-checkbox_checked"}}try{h=!a.label}catch(a){h=false;B(a.message)}if(h){b+=" b-checkbox_single"}try{h=a.classes}catch(a){h=false;B(a.message)}if(h){b+=" ";try{b+=I(a.classes)}catch(a){B(a.message+"64")}}try{h=c}catch(a){h=false;B(a.message)}if(h){try{b+=I(c)}catch(a){B(a.message+"68")}}try{h=a.shortcut}catch(a){h=false;B(a.message)}if(h){b+=" js-shortcut"}b+='"';try{h=~c.indexOf("_disabled")}catch(a){h=false;B(a.message)}if(h){b+=' aria-disabled="disabled"'}b+='><label class="mb-checkbox__label"><span class="mb-checkbox__wrapper">';try{f[0]=I(a.props.name)}catch(a){f[0]="";B(a.message)}try{f[1]=I(a.props.value)}catch(a){f[1]="";B(a.message)}b+='<input class="mb-checkbox__input" type="checkbox" name="'+f[0]+'" value="'+f[1]+'"/><div class="mb-checkbox__block"><svg class="mb-checkbox__block-icon" width="8px" height="6px" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 8 6"><path d="M7.7.3c-.4-.4-1-.4-1.4 0L3 3.6 1.7 2.3c-.4-.4-1-.4-1.4 0-.4.4-.4 1 0 1.4l2 2c.2.2.4.3.7.3.3 0 .5-.1.7-.3l4-4c.4-.4.4-1 0-1.4z"></path></svg></div>';try{h=a.label}catch(a){h=false;B(a.message)}if(h){b+='<span class="mb-checkbox__text"><span class="mb-checkbox__text-wrap">';try{b+=I(a.label)}catch(a){B(a.message+"95")}b+="</span></span>"}b+="</span></label></div>";return b}})(a);(function(a){var b=a;m["b-filelabel"]=function(a){var b="";try{if(!a.mods){a.mods=[]}if(a.type){a.mods.push(a.type)}if(a.selected){a.mods.push("selected")}}catch(a){B(a.message)}b+='<div data-bem="b-filelabel" data-model="';try{b+=I(JSON.stringify(a))}catch(a){B(a.message+"18")}b+='" data-id="';try{b+=I(a.id)}catch(a){B(a.message+"22")}b+='" class="';try{b+=I("b-filelabel "+"b-filelabel_"+a.mods.join(" b-filelabel_"))}catch(a){B(a.message+"26")}b+='"><div class="b-filelabel__item b-filelabel__item_checkbox">';try{h=a.ctrl}catch(a){h=false;B(a.message)}if(h){g="b-checkbox";n={};try{n={id:a.id,classes:"js-item-checkbox",checked:a.selected}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}b+='</div><div class="b-filelabel__item b-filelabel__item_title">';try{h=a.icon}catch(a){h=false;B(a.message)}if(h){g="file-icon";n={};try{n={type:a.icon,mods:["datalist"]}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}else{try{h=a.src}catch(a){h=false;B(a.message)}if(h){b+='<div class="b-userpic b-userpic_small">';try{f[0]=I(a.src)}catch(a){f[0]="";B(a.message)}b+='<img src="'+f[0]+'" alt=""/></div>'}else{}}try{f[0]=I(a.text)}catch(a){f[0]="";B(a.message)}b+='<div class="b-filelabel__item_title__text" title="'+f[0]+'">';try{b+=I(a.text)}catch(a){B(a.message+"52")}b+='</div></div><div class="b-filelabel__item b-filelabel__item_info"><div class="b-filelabel__item_info__text">';try{b+=I(a.info)}catch(a){B(a.message+"56")}b+="</div></div></div>";return b}})(a);(function(a){var b=a;m["b-filelabel"]=function(a){var b="";try{if(!a.mods){a.mods=[]}if(a.type){a.mods.push(a.type)}if(a.selected){a.mods.push("selected")}}catch(a){B(a.message)}b+='<div data-bem="b-filelabel" data-model="';try{b+=I(JSON.stringify(a))}catch(a){B(a.message+"18")}b+='" data-id="';try{b+=I(a.id)}catch(a){B(a.message+"22")}b+='" class="';try{b+=I("b-filelabel "+"b-filelabel_"+a.mods.join(" b-filelabel_"))}catch(a){B(a.message+"26")}b+='"><div class="b-filelabel__item b-filelabel__item_title">';try{h=a.icon}catch(a){h=false;B(a.message)}if(h){g="file-icon";n={};try{n={type:a.icon,mods:["datalist"]}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}else{try{h=a.src}catch(a){h=false;B(a.message)}if(h){b+='<div class="b-userpic b-userpic_small">';try{f[0]=I(a.src)}catch(a){f[0]="";B(a.message)}b+='<img src="'+f[0]+'" alt=""/></div>'}else{}}try{f[0]=I(a.text)}catch(a){f[0]="";B(a.message)}b+='<div class="b-filelabel__item_title__text" title="'+f[0]+'">';try{b+=I(a.text)}catch(a){B(a.message+"43")}b+='</div></div><div class="b-filelabel__item b-filelabel__item_info"><div class="b-filelabel__item_info__text">';try{b+=I(a.info)}catch(a){B(a.message+"47")}b+="</div></div></div>";return b}})(a);(function(a){m["b-explorer-header"]=function(a){var b="";b+='<div class="b-explorer-header">';var c,d,e,f;try{f=a.items||[];e=f.length}catch(a){f=[];e=0;B(a.message)}for(c=0;c<e;c++){d=f[c];b+="<div";g="class-attribute";n={};try{n={baseClass:"b-explorer-header__item",mods:d.mods}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+=">";try{g=d.view}catch(a){g="";B(a.message)}n={};try{n=d.viewParams}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+="</div>"}b+="</div>";return b};m["b-explorer-header-cloud"]=function(a){var b="";try{var c;var d=[{mods:["checkbox"],view:"b-checkbox",viewParams:{mods:["onchange"]}},{mods:["search"],view:"b-search",viewParams:{props:{placeholder:a.searchTitle,type:"text",name:"text"},icon:{mods:["search"]}}}];if(a.sortItems){c=a.sortItems.map(function(a){return{text:a.title,id:a.field,name:a.field,icon:"sort_down",mods:["table"]}});d.push({mods:["sort"],view:"b-dropdown",viewParams:{mods:[],ctrl:{icon:"tree"},items:c}})}if(a.viewMods&&a.viewMods.length>1){var e=a.viewMods.map(function(a,b){var c;switch(a){case"filelabel":c="list";break;case"thumb":c="sharp";break}return{group:"a",id:a,icon:c}});d.push({mods:["viewmode"],view:"btn",viewParams:{mods:[],items:e}})}}catch(a){B(a.message)}g="b-explorer-header";n={};try{n={items:d}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);return b};m["b-explorer-header-saveas"]=function(a){var b="";try{var c=[{mods:["input","saveas"],view:"b-input",viewParams:{mods:a.saveasMods||[],props:{name:"saveas",value:a.saveasValue,placeholder:a.saveasPlaceholder}}}]}catch(a){B(a.message)}g="b-explorer-header";n={};try{n={items:c}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);return b}})(a);(function(a){var b=a;m["b-explorer-password"]=function(a){var b="";b+='<div data-model="';try{b+=I(JSON.stringify(a))}catch(a){B(a.message+"6")}b+='" class="b-explorer-password" data-bem="b-explorer-password"><form class="b-explorer-password__form"><div class="b-explorer-password__block"><label class="b-explorer-password__block__title"><span>';try{b+=I(a.title)}catch(a){B(a.message+"21")}b+="</span>";g="b-input";n={};try{n={props:{type:"password"}}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+='</label><div class="b-explorer-password__block_error"></div></div><div class="b-explorer-password__block">';try{h=!a.folderRecovery}catch(a){h=false;B(a.message)}if(h){b+='<a href="#" target="_blank" class="b-explorer-password__link">';try{b+=I(a.forgotPassword)}catch(a){B(a.message+"35")}b+="</a>"}g="btn";n={};try{n={text:a.btnEnter,id:"b-explorer__password_submit"}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+="</div></form></div>";return b}})(a);(function(a){var b=a;m["b-explorer-license"]=function(a){var b="";b+='<div data-model="';try{b+=I(JSON.stringify(a))}catch(a){B(a.message+"5")}b+='" class="b-explorer-license" data-bem="b-explorer-license">';try{b+=a.html}catch(a){B(a.message+"17")}g="btn";n={};try{n={text:a.btnEnter,mods:["main"],id:"b-explorer__license_submit"}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+="</div>";return b}})(a);(function(a){m["b-userpic"]=function(a){var b="";try{f[0]=I(a.pic)}catch(a){f[0]="";B(a.message)}b+='<div class="b-userpic b-userpic_small" style="'+f[0]+'"></div>';return b}})(a);(function(a){m["b-dropdown"]=function(a){var b="";try{var c=0;var d=function(){return c++};a.ctrl=a.ctrl||{};a.props=a.props||{}}catch(a){B(a.message)}try{f[0]=I(a.bem||"b-dropdown")}catch(a){f[0]="";B(a.message)}b+='<div data-bem="'+f[0]+'"';try{h=a.mnemo}catch(a){h=false;B(a.message)}if(h){b+=' data-mnemo="';try{b+=I(a.mnemo)}catch(a){B(a.message+"16")}b+='"'}b+=' data-model="';try{b+=I(__toolkitDataModelSerialize(a))}catch(a){B(a.message+"21")}b+='" class="b-dropdown';try{h=a.mods}catch(a){h=false;B(a.message)}if(h){b+=" ";try{b+=I("b-dropdown_"+a.mods.join(" b-dropdown_"))}catch(a){B(a.message+"29")}}try{h=a.classes}catch(a){h=false;B(a.message)}if(h){b+=" ";try{b+=I(a.classes.join(" "))}catch(a){B(a.message+"34")}}b+='"';try{h=a.mods&&a.mods.indexOf("disabled")!=-1}catch(a){h=false;B(a.message)}if(h){b+=' aria-disabled="disabled"'}try{h=a.group}catch(a){h=false;B(a.message)}if(h){b+=' data-group="';try{b+=I(a.group)}catch(a){B(a.message+"44")}b+='"'}try{h=a.id!=null}catch(a){h=false;B(a.message)}if(h){b+=' id="';try{b+=I(a.id)}catch(a){B(a.message+"50")}b+='"'}try{h=a.blockName}catch(a){h=false;B(a.message)}if(h){b+=' data-blockid="';try{b+=I(a.blockName)}catch(a){B(a.message+"56")}b+='"'}try{h=a.props.tabindex}catch(a){h=false;B(a.message)}if(h){b+=' tabindex="';try{b+=I(a.props.tabindex)}catch(a){B(a.message+"62")}b+='"'}b+='><div data-mnemo="ctrl"';g="class-attribute";n={};try{n={baseClass:"b-dropdown__ctrl",classes:a.ctrl&&a.ctrl.shortcut&&!a.ctrl.block?["js-shortcut"]:null}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);try{var e=(!a.ctrl||a.ctrl.title==null)&&typeof lang=="object"?lang["b-dropdown"].titles[a.group]||lang["b-dropdown"][a.group]:a.ctrl.title}catch(a){B(a.message)}try{h=e}catch(a){h=false;B(a.message)}if(h){b+=' title="';try{b+=I(e)}catch(a){B(a.message+"83")}b+='"'}try{h=a.ctrl&&a.ctrl.shortcut&&!a.ctrl.block}catch(a){h=false;B(a.message)}if(h){b+=' data-shortcut="';try{b+=I(a.ctrl.shortcut)}catch(a){B(a.message+"88")}b+='"'}b+=">";try{h=a.ctrl&&a.ctrl.block}catch(a){h=false;B(a.message)}if(h){try{g=a.ctrl.block}catch(a){g="";B(a.message)}n={};try{n=a.ctrl}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}try{h=!a.ctrl||!a.ctrl.block}catch(a){h=false;B(a.message)}if(h){try{h=a.ctrl&&a.ctrl.icon}catch(a){h=false;B(a.message)}if(h){g="ico";n={};try{n={mods:[].concat(a.ctrl.icon.split("_").shift(),a.ctrl.icon)}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}try{h=a.img}catch(a){h=false;B(a.message)}if(h){b+='<div class="b-dropdown__ctrl__image js-image"></div>'}b+='<span class="b-dropdown__ctrl__text"';try{h=a.ctrl&&a.ctrl.icon}catch(a){h=false;B(a.message)}if(h){b+=' class="b-dropdown__text b-dropdown__text_pad"'}b+=">";try{b+=I((!a.ctrl||a.ctrl.text==null)&&typeof lang=="object"?lang["b-dropdown"][a.group]:a.ctrl.text)}catch(a){B(a.message+"114")}b+="</span>"}b+='<div class="b-dropdown__arrow"></div></div><div class="b-dropdown__list" style="display: none;">';try{h=a.items}catch(a){h=false;B(a.message)}if(h){g="b-dropdown__list";n={};try{n={group:a.group,items:a.items,num:d}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}b+="</div></div>";return b}})(a);(function(a){m["b-dropdown__list"]=function(a){var b="";var c,d,e,f;try{f=a.items||[];e=f.length}catch(a){f=[];e=0;B(a.message)}for(c=0;c<e;c++){d=f[c];try{if(d&&d instanceof Object){var i=typeof lang=="object"&&lang["b-dropdown"][a.group+"."]||{};d.text=d.text==null?i[d.name]:i[d.text]||d.text}}catch(a){B(a.message)}try{h=d=="hr"||d.hr}catch(a){h=false;B(a.message)}if(h){b+='<div class="b-dropdown__list__hr"></div>'}else{try{h=!d||d.hidden}catch(a){h=false;B(a.message)}if(h){}else{try{h=d.block}catch(a){h=false;B(a.message)}if(h){b+='<div data-bem="b-dropdown__list__item"';try{h=d.id!=null}catch(a){h=false;B(a.message)}if(h){b+=' data-id="';try{b+=I(d.id)}catch(a){B(a.message+"23")}b+='"'}try{h=d.name}catch(a){h=false;B(a.message)}if(h){b+=' data-name="';try{b+=I(d.name)}catch(a){B(a.message+"27")}b+='"'}b+=' class="b-dropdown__list__item';try{h=d.disabled}catch(a){h=false;B(a.message)}if(h){b+=" b-dropdown__list__item_disabled"}try{h=d.mods}catch(a){h=false;B(a.message)}if(h){b+=" ";try{b+=I("b-dropdown__list__item_"+d.mods.join(" b-dropdown__list__item_"))}catch(a){B(a.message+"40")}}b+='"';try{h=d.disabled}catch(a){h=false;B(a.message)}if(h){b+=' aria-disabled="disabled"'}b+=">";try{g=d.block}catch(a){g="";B(a.message)}n={};try{n=d}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+="</div>"}else{try{h=d.group}catch(a){h=false;B(a.message)}if(h){b+='<div class="b-dropdown__group';try{h=d.mods}catch(a){h=false;B(a.message)}if(h){b+=" ";try{b+=I("b-dropdown__group_"+d.mods.join(" b-dropdown__group_"))}catch(a){B(a.message+"61")}}b+='">';var j,l,o,p;try{p=d.items||[];o=p.length}catch(a){p=[];o=0;B(a.message)}for(j=0;j<o;j++){l=p[j];try{l.num=a.num?a.num():c}catch(a){B(a.message)}g="b-dropdown__item";n={};try{n=l}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}b+="</div>"}else{try{d.num=a.num?a.num():c}catch(a){B(a.message)}g="b-dropdown__item";n={};try{n=d}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}}}}}return b}})(a);(function(a){m["b-dropdown__item"]=function(a){var b="";b+='<a data-bem="b-dropdown__list__params"';try{h=a.id!=null}catch(a){h=false;B(a.message)}if(h){b+=' data-id="';try{b+=I(a.id)}catch(a){B(a.message+"7")}b+='"'}try{h=a.href!==void 0}catch(a){h=false;B(a.message)}if(h){b+=' href="';try{g=a.href}catch(a){g="";B(a.message)}b+=g;b+='"'}try{h=a.target!==void 0}catch(a){h=false;B(a.message)}if(h){b+=' target="';try{g=a.target}catch(a){g="";B(a.message)}b+=g;b+='"'}try{h=a.num!==void 0}catch(a){h=false;B(a.message)}if(h){b+=' data-num="';try{g=a.num}catch(a){g="";B(a.message)}b+=g;b+='"'}try{h=a.name}catch(a){h=false;B(a.message)}if(h){b+=' data-name="';try{b+=I(a.name||a.value)}catch(a){B(a.message+"25")}b+='"'}try{h=a.value!==void 0}catch(a){h=false;B(a.message)}if(h){b+=' data-value="';try{b+=I(a.value)}catch(a){B(a.message+"31")}b+='"'}try{h=a.code}catch(a){h=false;B(a.message)}if(h){b+=' data-code="';try{b+=I(a.code)}catch(a){B(a.message+"37")}b+='"'}try{h=a.image}catch(a){h=false;B(a.message)}if(h){b+=' data-image="';try{b+=I(a.image)}catch(a){B(a.message+"42")}b+='"'}try{h=a.color}catch(a){h=false;B(a.message)}if(h){b+=' style="';try{g="color: "+a.color}catch(a){g="";B(a.message)}b+=g;b+='" data-color="';try{g=a.color}catch(a){g="";B(a.message)}b+=g;b+='"'}try{h=a.text}catch(a){h=false;B(a.message)}if(h){b+=' data-text="';try{b+=I(a.text)}catch(a){B(a.message+"52")}b+='"'}try{h=a["sort"]}catch(a){h=false;B(a.message)}if(h){b+=' aria-sort="';try{b+=I(a["sort"])}catch(a){B(a.message+"58")}b+='"'}b+=' class="b-dropdown__list__item';try{h=a.disabled}catch(a){h=false;B(a.message)}if(h){b+=" b-dropdown__list__item_disabled"}try{h=a.parent_id!=null}catch(a){h=false;B(a.message)}if(h){b+=" b-dropdown__list__item_pad"}try{h=a.active}catch(a){h=false;B(a.message)}if(h){b+=" b-dropdown__list__item_active"}try{h=a.mods}catch(a){h=false;B(a.message)}if(h){b+=" ";try{b+=I("b-dropdown__list__item_"+a.mods.join(" b-dropdown__list__item_"))}catch(a){B(a.message+"81")}}try{h=a.cssClass}catch(a){h=false;B(a.message)}if(h){b+=" ";try{b+=I(a.cssClass)}catch(a){B(a.message+"86")}}b+='"';try{h=a.disabled}catch(a){h=false;B(a.message)}if(h){b+=' aria-disabled="disabled"'}try{h=a.style}catch(a){h=false;B(a.message)}if(h){b+=' style="';try{b+=a.style}catch(a){B(a.message+"97")}b+='"'}b+=">";try{h=a.icon}catch(a){h=false;B(a.message)}if(h){g="ico";n={};try{n={mods:[a.icon.split("_")[0],a.icon]}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}try{h=a.image}catch(a){h=false;B(a.message)}if(h){try{f[0]=I(a.image)}catch(a){f[0]="";B(a.message)}b+='<span class="b-dropdown__item__image" style="background-image: url('+f[0]+');"></span>'}try{h=a.checked}catch(a){h=false;B(a.message)}if(h){b+='<div class="b-checkbox__checkmark"></div>'}try{h=a.html!=null}catch(a){h=false;B(a.message)}if(h){try{b+=a.html}catch(a){B(a.message+"117")}}else{try{var c=a.text,d=a.level||0}catch(a){B(a.message)}b+='<span class="b-dropdown__list__item__text" style="padding-left:';try{b+=I(d*10)}catch(a){B(a.message+"128")}b+='px;">';try{h=a.unsafe}catch(a){h=false;B(a.message)}if(h){try{b+=c}catch(a){B(a.message+"134")}}else{try{b+=I(c)}catch(a){B(a.message+"137")}}b+="</span>";try{h=a.shortcuthint}catch(a){h=false;B(a.message)}if(h){b+='<span class="b-dropdown__list__item__hint">';try{b+=I(a.shortcuthint)}catch(a){B(a.message+"145")}b+="</span>"}}b+="</a>";return b}})(a);(function(a){m["b-dropdown__item-caption"]=function(a){var b="";b+='<div class="b-dropdown__item-caption">';try{b+=I(a.name)}catch(a){B(a.message+"4")}b+=":</div>";return b}})(a);(function(a){m["b-filename"]=function(a){var b="";try{a.mods=a.mods||[];a.classes=a.classes||[];var c=a.name,d=a.extension&&a.extension!=="unknown"?"."+a.extension:"",e=c+(a.extension?d:"");if(!c&&d){c=d;d=void 0}if(a.icon){a.mods.push("icon")}}catch(a){B(a.message)}b+='<div data-bem="b-filename"';g="class-attribute";n={};try{n={baseClass:"b-filename",mods:a.mods,classes:a.classes}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+=' data-model="';try{b+=I(__toolkitDataModelSerialize(a))}catch(a){B(a.message+"31")}b+='"';try{h=a.showTitle}catch(a){h=false;B(a.message)}if(h){b+=' title="';try{b+=I(e)}catch(a){B(a.message+"36")}b+='"'}b+=">";try{h=a.icon}catch(a){h=false;B(a.message)}if(h){b+='<div class="b-filename__icon">';g="file-icon";n={};try{n={type:a.icon,mods:a.iconMods}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+="</div>";try{h=a.previewImage}catch(a){h=false;B(a.message)}if(h){b+='<div class="b-filename__thumb"></div>'}}b+='<div class="b-filename__spacer">';try{b+=I(e)}catch(a){B(a.message+"54")}b+='</div><div class="b-filename__padding">';try{h=a.extension}catch(a){h=false;B(a.message)}if(h){try{b+=I(d)}catch(a){B(a.message+"59")}}b+='</div><div class="b-filename__text"><span class="b-filename__name">';try{h=a.nameParts}catch(a){h=false;B(a.message)}if(h){var f,i,j;try{j=a.nameParts||[];i=j.length}catch(a){j=[];i=0;B(a.message)}for(f=0;f<i;f++){try{h=a.nameParts[f].hl}catch(a){h=false;B(a.message)}if(h){b+='<span class="b-filename__highlighted">';try{b+=I(a.nameParts[f].val)}catch(a){B(a.message+"71")}b+="</span>"}else{try{b+=I(a.nameParts[f].val)}catch(a){B(a.message+"75")}}}}else{try{b+=I(c)}catch(a){B(a.message+"81")}}b+="</span>";try{h=!a.nameParts}catch(a){h=false;B(a.message)}if(h){b+='<span class="b-filename__extension">';try{h=a.extension}catch(a){h=false;B(a.message)}if(h){try{b+=I(d)}catch(a){B(a.message+"89")}}b+="</span>"}b+="</div></div>";return b}})(a);(function(a){m["file-icon"]=function(a){var b="";b+='<i data-bem="file-icon"';try{h=a.hidden}catch(a){h=false;B(a.message)}if(h){b+=' style="display: none;"'}b+=' class="file-icon';try{h=a.mods}catch(a){h=false;B(a.message)}if(h){b+=" ";try{b+=I("file-icon_"+a.mods.join(" file-icon_"))}catch(a){B(a.message+"14")}}try{h=a.type}catch(a){h=false;B(a.message)}if(h){b+=" file-icon_type_";try{b+=I(a.type.toLowerCase())}catch(a){B(a.message+"19")}}b+='"></i>';return b}})(a);(function(a){m["b-thumb"]=function(a){var b="";try{a.attributes=a.attributes||{};a.mods=a.mods||[];a.classes=a.classes||[];if(Object.prototype.toString.call(a.controls)==="[object Array]"){var c=a.controls;delete a.controls}a.controls=a.controls||{};a.controls.top=a.controls.top||{};a.controls.top.left=a.controls.top.left||{};a.controls.top.left.items=a.controls.top.left.items||[];a.controls.top.right=a.controls.top.right||[];a.controls.top.right.items=a.controls.top.right.items||[];a.controls.bottom=a.controls.bottom||{};a.controls.bottom.left=a.controls.bottom.left||{};a.controls.bottom.left.items=a.controls.bottom.left.items||[];a.controls.bottom.right=a.controls.bottom.right||{};a.controls.bottom.right.items=a.controls.bottom.right.items||[]}catch(a){B(a.message)}try{if(typeof a.classes==="string"){a.classes=a.classes.split(" ")}try{a.attributes["data-model"]=JSON.stringify(a)}catch(a){}if(a.id!=null){a.attributes["data-id"]=a.id}if(a.tnefId){a.attributes["data-tnef-id"]=a.tnefId}if(a.isVirus){a.mods.push("virus")}if(a.selected){a.mods.push("selected")}if(a.basename||a.ext){a.filename={name:a.basename,extension:a.ext?a.ext.replace(/\./g,""):"",icon:a.src&&a.type!=="image"&&a.type}}if(a.ctrl){a.controls.top.right.items.push({block:"b-checkbox",params:{id:a.id,classes:"js-item-checkbox",mods:["in-thumb"],checked:a.selected}})}if(a.downloadurl){a.controls.bottom.left.items.push({block:"btn",params:{icon:"system_download",href:a.downloadurl,name:"download",mods:["bare"],classes:"js-download",text:a.downloadText||lang.get("btn.download")}})}if(c){c.forEach(function(b){b.mods=b.mods||[];b.mods.push("bare");a.controls.bottom.right.items.push({block:"btn",params:b})})}if(a.src){a.imageUrl=a.src;if(a.type!=="image"){a.isDocument=true}}}catch(a){B(a.message)}try{if(a.image){a.imageUrl=a.image.src;a.isDeferred=false}if(!a.imageUrl||a.isDeferred){a.mods.push("icon")}if(a.isDocument){a.mods.push("document")}if(a.editMode){a.mods.push("edit");a.controls.top.left.items=[{block:"b-input",params:{}}]}else if(a.filename){a.controls.top.left.items=[{block:"b-filename",params:{name:a.filename.name,extension:a.filename.extension,showTitle:a.showFilenameTitle,icon:a.isDocument?a.icon:null,mods:["thumbnail"].concat(a.filename.mods),iconMods:a.isIe8?["datalist"]:[],nameParts:a.nameParts?a.nameParts:null}}]}else if(a.title){a.controls.top.left.items=[a.title]}}catch(a){B(a.message)}b+="<div";g="class-attribute";n={};try{n={baseClass:"b-thumb",mods:a.mods,classes:a.classes}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);g="attributes";n={};try{n=a.attributes}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+=' data-bem="b-thumb"><div class="b-thumb__content">';try{h=a.icon}catch(a){h=false;B(a.message)}if(h){b+='<div class="b-thumb__icon">';g="file-icon";n={};try{n={type:a.icon}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+="</div>"}try{h=a.imageUrl&&!a.editMode}catch(a){h=false;B(a.message)}if(h){try{h=a.isDeferred}catch(a){h=false;B(a.message)}if(h){try{f[0]=I(a.imageUrl)}catch(a){f[0]="";B(a.message)}b+='<div class="b-thumb__image js-image" data-url="'+f[0]+'"></div>';try{h=a.imageOverlay}catch(a){h=false;B(a.message)}if(h){b+='<div class="b-thumb__image-overlay"></div>'}}else{b+='<div class="b-thumb__image" style="background-image: url(';try{b+=I(a.imageUrl.replace(/(['"()])/g,"\\$1"))}catch(a){B(a.message+"188")}b+=');"></div>';try{h=a.imageOverlay}catch(a){h=false;B(a.message)}if(h){b+='<div class="b-thumb__image-overlay"></div>'}}}try{h=a.content&&a.content.block}catch(a){h=false;B(a.message)}if(h){try{g=a.content.block}catch(a){g="";B(a.message)}n={};try{n=a.content.params}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}b+="</div>";try{h=a.controls&&a.controls.top}catch(a){h=false;B(a.message)}if(h){try{a.controls.top.mods=["top"].concat(a.controls.top.mods||[])}catch(a){B(a.message)}g="b-thumb__controlbar";n={};try{n=a.controls.top}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}try{h=a.controls&&a.controls.bottom}catch(a){h=false;B(a.message)}if(h){try{a.controls.bottom.mods=["bottom"].concat(a.controls.bottom.mods||[])}catch(a){B(a.message)}g="b-thumb__controlbar";n={};try{n=a.controls.bottom}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}b+="</div>";return b}})(a);(function(a){m.attributes=function(a){var b="";var c,d,e;try{e=a||{}}catch(a){i={};B(a.message)}for(c in e){d=e[c];try{g=c}catch(a){g="";B(a.message)}if(g!==""){b+=" "+g+'="';try{b+=I(d)}catch(a){B(a.message+"6")}b+='"'}}return b}})(a);(function(a){m["b-thumb__controlbar"]=function(a){var b="";try{h=a.left&&a.left.items&&a.left.items.length||a.right&&a.right.items&&a.right.items.length}catch(a){h=false;B(a.message)}if(h){b+="<div";g="class-attribute";n={};try{n={baseClass:"b-thumb__controlbar",mods:a.mods,classes:a.classes}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+=">";try{h=a.right}catch(a){h=false;B(a.message)}if(h){try{a.right.mods=["right"].concat(a.right.mods||[])}catch(a){B(a.message)}g="b-thumb__controls";n={};try{n=a.right}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}try{h=a.left}catch(a){h=false;B(a.message)}if(h){try{a.left.mods=["left"].concat(a.left.mods||[])}catch(a){B(a.message)}g="b-thumb__controls";n={};try{n=a.left}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}b+="</div>"}return b}})(a);(function(a){m["b-thumb__controls"]=function(a){var b="";b+="<div";g="class-attribute";n={};try{n={baseClass:"b-thumb__controls",mods:a.mods,classes:a.classes}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+=">";var c,d,e,f;try{f=a.items||[];e=f.length}catch(a){f=[];e=0;B(a.message)}for(c=0;c<e;c++){d=f[c];try{h=typeof d==="string"}catch(a){h=false;B(a.message)}if(h){b+='<div class="b-thumb__controls__text">';try{b+=I(d)}catch(a){B(a.message+"18")}b+="</div>"}else{try{h=d.block}catch(a){h=false;B(a.message)}if(h){try{g=d.block}catch(a){g="";B(a.message)}n={};try{n=d.params||d}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}else{g="btn";n={};try{n=Object.assign({container:"div"},d.params||d)}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}}}b+="</div>";return b}})(a);(function(a){m["b-explorer"]=function(a){var b="";b+='<div data-bem="b-explorer" class="b-explorer" data-model="';try{b+=I(JSON.stringify(a))}catch(a){B(a.message+"11")}b+='"><div class="b-explorer__block b-explorer__block_top"><div class="b-explorer__block__left"><div class="b-explorer__header"><span class="b-explorer__header__text">';try{b+=I(a.title)}catch(a){B(a.message+"18")}b+='</span></div></div><div class="b-explorer__block__right"><div class="b-explorer__rightHeader__content">';try{var c="b-explorer-header-cloud";if(a.type==="saveas"){c="b-explorer-header-saveas"}}catch(a){B(a.message)}try{g=c}catch(a){g="";B(a.message)}n={};try{n={sortItems:a.sortItems,viewMods:a.viewMods,searchTitle:a.searchTitle,saveasPlaceholder:a.saveasPlaceholder,saveasValue:a.saveasValue,saveasMods:a.saveasMods}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+='</div></div></div><div class="b-explorer__block b-explorer__block_bottom"><div class="b-explorer__block__left">';var d,e,f,i;try{i=a.modelsList||[];f=i.length}catch(a){i=[];f=0;B(a.message)}for(d=0;d<f;d++){e=i[d];g="b-tree";n={};try{n={items:[],id:e,mods:a.mods}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}b+='</div><div class="b-explorer__block__right b-explorer__block__right__filelist"><div class="b-explorer__loader b-explorer__loader_hidden">';g="b-spinner";n={};k=m[g];if(k)b+=G(k,n,false);b+="</div>";g="b-list";n={};try{n={items:[]}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+='<div class="b-explorer__empty"><div class="b-explorer__empty__folder"><div class="b-explorer__empty__icon b-explorer__empty__icon_folder"></div>';try{b+=I(a.emptyFolderText)}catch(a){B(a.message+"74")}b+='</div><div class="b-explorer__empty__search"><div class="b-explorer__empty__icon b-explorer__empty__icon_search"></div>';try{b+=I(a.emptySearchText)}catch(a){B(a.message+"80")}b+="</div></div>";try{h=a.password}catch(a){h=false;B(a.message)}if(h){g="b-explorer-password";n={};try{n=a.password}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}try{h=a.license}catch(a){h=false;B(a.message)}if(h){g="b-explorer-license";n={};try{n=a.license}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}b+="</div></div></div>";return b}})(a);(function(a){m["b-viewer"]=function(a){var b="";b+='<div class="b-viewer">';g="b-viewer__viewport";n={};k=m[g];if(k)b+=G(k,n,false);g="b-viewer__toolbox";n={};k=m[g];if(k)b+=G(k,n,false);b+="</div>";return b}})(a);(function(a){m["b-view"]=function(a){var b="";b+='<div class="b-view js-view"></div>';return b}})(a);(function(a){m["b-media-player-settings__video-quality-level"]=function(a){var b="";try{var c=[];if(a.isCurrent){c.push("current")}}catch(a){B(a.message)}b+="<div";g="class-attribute";n={};try{n={baseClass:"b-media-player-settings__video-quality-level",mods:c}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);try{h=!a.isCurrent}catch(a){h=false;B(a.message)}if(h){g="attributes";n={};try{n={"data-name":"video-quality","data-level":a.index}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}b+=">";g="ico";n={};try{n={mods:["media-player-settings-current-level"],classes:["b-media-player-settings__video-quality-level-mark"]}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);try{h=a.isAuto}catch(a){h=false;B(a.message)}if(h){try{b+=i18n("Авто")}catch(a){B(a.message+"43")}try{h=a.isCurrent}catch(a){h=false;B(a.message)}if(h){b+=" (";try{b+=I(a.name)}catch(a){B(a.message+"46")}b+=")"}}else{try{h=a.rating}catch(a){h=false;B(a.message)}if(h){try{h=a.rating>3}catch(a){h=false;B(a.message)}if(h){try{b+=i18n("Высокое")}catch(a){B(a.message+"52")}}else{try{h=a.rating<3}catch(a){h=false;B(a.message)}if(h){try{b+=i18n("Низкое")}catch(a){B(a.message+"55")}}else{try{b+=i18n("Среднее")}catch(a){B(a.message+"58")}}}b+=" ";try{b+=I(a.name)}catch(a){B(a.message+"62")}}else{try{b+=I(a.name)}catch(a){B(a.message+"65")}}}b+="</div>";return b};m["b-media-player-settings"]=function(a){var b="";b+="<div";g="class-attribute";n={};try{n={baseClass:"b-media-player-settings",classes:a.classes,mods:a.mods}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);g="attributes";n={};try{n=a.attributes}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+=' data-bem="b-media-player-settings" data-model="';try{b+=I(JSON.stringify(a))}catch(a){B(a.message+"84")}b+='"><div class="b-media-player-settings__video-quality-title">';try{b+=i18n("Качество")}catch(a){B(a.message+"89")}b+="</div>";try{h=a.levels.length===1}catch(a){h=false;B(a.message)}if(h){g="b-media-player-settings__video-quality-level";n={};try{n={isCurrent:true,name:a.levels[0].name,rating:a.levels[0].rating}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}else{try{var c=a.levels.find(function(a){return a.isAuto})}catch(a){B(a.message)}try{h=c}catch(a){h=false;B(a.message)}if(h){g="b-media-player-settings__video-quality-level";n={};try{n={isAuto:true,isCurrent:true,name:c.name}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}else{g="b-media-player-settings__video-quality-level";n={};try{n={isAuto:true,index:-1}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}var d,e,f;try{f=a.levels||{}}catch(a){i={};B(a.message)}for(d in f){e=f[d];g="b-media-player-settings__video-quality-level";n={};try{n={isCurrent:e.isCurrent&&!e.isAuto,name:e.name,index:e.index,rating:e.rating}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}}b+="</div>";return b}})(a);(function(a){m["b-tooltip"]=function(a){var b="";try{f[0]=I(a.mods&&a.mods.length?" b-tooltip_"+a.mods.join(" b-tooltip_"):"")}catch(a){f[0]="";B(a.message)}b+='<div class="b-tooltip'+f[0]+'" data-bem="';try{b+=I("b-tooltip")}catch(a){B(a.message+"6")}b+='" data-model="';try{b+=I(__toolkitDataModelSerialize(a))}catch(a){B(a.message+"10")}b+='"><div class="b-tooltip__corner"></div>';try{f[0]=I(i18n("Закрыть"))}catch(a){f[0]="";B(a.message)}b+='<div data-name="close" class="b-tooltip__close" title="'+f[0]+'"></div><div class="b-tooltip__content">';try{h=a.block}catch(a){h=false;B(a.message)}if(h){try{g=a.block}catch(a){g="";B(a.message)}n={};try{n=a}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}try{h=a.text}catch(a){h=false;B(a.message)}if(h){b+='<div class="b-tooltip__text">';try{b+=I(a.text)}catch(a){B(a.message+"22")}b+="</div>"}b+="</div></div>";return b}})(a);(function(a){m["b-media-player"]=function(a){var b="";b+='<div class="b-media-player js-mediaPlayer"><div class="b-media-player__status-icon b-media-player__status-icon_play" data-name="status-icon"></div><div class="b-media-player__status-icon b-media-player__status-icon_pause" data-name="status-icon"></div><div class="b-media-player__status-icon b-media-player__status-icon_waiting" data-name="status-icon"></div><div class="b-media-player__content js-content"><div class="js-error b-media-player__error"><div class="b-media-player__error__inner"><div class="b-media-player__error__icon"></div><div class="b-media-player__error__title">Ошибка воспроизведения</div><div data-name="retry" class="b-media-player__error__retry">Повторить</div></div><div class="js-error-code b-media-player__error__code"></div></div><img data-name="play" class="js-poster b-media-player__poster"/><div class="js-video b-media-player__video"></div><div data-name="play" class="js-poster-dummy b-media-player__poster-dummy">';g="file-icon";n={};try{n={mods:["viewer"],type:"video"}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+='</div></div><div class="b-media-player__controls js-controls"><div data-name="play" class="b-media-player__button b-media-player__button_playback-state b-media-player__button_play js-play"></div><div data-name="pause" class="b-media-player__button b-media-player__button_playback-state b-media-player__button_pause js-pause"></div><div data-name="pause" class="b-media-player__button b-media-player__button_playback-state b-media-player__button_waiting js-waiting"></div><div class="b-media-player__time-scale"><div class="b-media-player__time js-time"></div>/<div class="b-media-player__duration js-duration"></div></div><div class="b-media-player__sound"><div data-name="mute" class="b-media-player__button b-media-player__button_mute b-media-player__sound__indicator b-media-player__sound__indicator_mute js-mute"></div><div data-name="unmute" class="b-media-player__button b-media-player__button_unmute b-media-player__sound__indicator b-media-player__sound__indicator_unmute js-unmute"></div><div class="b-media-player__sound__volume js-volume"><div class="b-media-player__sound__volume__total"><div class="b-media-player__sound__volume__amount js-volume-amount"></div></div></div></div><div data-name="fullscreen" class="b-media-player__button b-media-player__button_fullscreen js-fullscreen"></div><div data-name="settings" class="b-media-player__button b-media-player__button_settings js-settings"></div><div class="b-media-player__progress js-progress"><div class="b-media-player__progress__total"><div class="b-media-player__progress__loaded js-progress-buffered"></div><div class="b-media-player__progress__played js-progress-amount"></div></div></div></div></div>';return b}})(a);(function(a){m["b-resize-detector"]=function(a){var b="";b+='<div class="b-resize-detector"><iframe src="about:blank" class="b-resize-detector__iframe js-iframe"></iframe></div>';return b}})(a);(function(a){m["b-view__dummy"]=function(a){var b="";b+='<div class="b-view__dummy js-viewDummy"';try{h=a.hidden}catch(a){h=false;B(a.message)}if(h){b+=' style="display: none;"'}b+='><div class="b-view__dummy__icon">';g="file-icon";n={};try{n={mods:["viewer"],type:a.icon||a.filename.extension}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+='</div><div class="b-view__dummy__info"><div class="b-view__dummy__title">';g="b-filename";n={};try{n=a.filename}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+="</div>";try{h=a.fileInfo&&a.fileInfo.length}catch(a){h=false;B(a.message)}if(h){b+='<div class="b-view__dummy__file-info"><div class="b-view__dummy__file-info__col b-view__dummy__file-info__col_left">';var c,d,e,i;try{i=a.fileInfo||[];e=i.length}catch(a){i=[];e=0;B(a.message)}for(c=0;c<e;c++){d=i[c];try{h=d.value}catch(a){h=false;B(a.message)}if(h){b+='<div class="b-view__dummy__file-info__name">';try{b+=I(d.name)}catch(a){B(a.message+"29")}b+="</div>"}}b+='</div><div class="b-view__dummy__file-info__col b-view__dummy__file-info__col_right">';var c,d,j,l;try{l=a.fileInfo||[];j=l.length}catch(a){l=[];j=0;B(a.message)}for(c=0;c<j;c++){d=l[c];try{h=d.value}catch(a){h=false;B(a.message)}if(h){b+='<div class="b-view__dummy__file-info__value">';try{b+=I(d.value)}catch(a){B(a.message+"38")}b+="</div>"}}b+="</div></div>"}b+='<div class="b-view__dummy__actions">';var c,o,p,q;try{q=a.viewActions||[];p=q.length}catch(a){q=[];p=0;B(a.message)}for(c=0;c<p;c++){o=q[c];try{f[0]=I(o.name)}catch(a){f[0]="";B(a.message)}b+='<div class="b-view__dummy__action js-viewAction" data-name="'+f[0]+'">';g="ico";n={};try{n={mods:[o.icon.split("_")[0],o.icon]}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+='<span class="b-view__dummy__action__text">';try{b+=I(o.text)}catch(a){B(a.message+"56")}b+="</span></div>"}b+="</div></div></div>";return b}})(a);(function(a){m["b-view__image"]=function(a){var b="";b+='<div class="b-view__image js-viewImage"';try{h=a.hidden}catch(a){h=false;B(a.message)}if(h){b+=' style="display: none;"'}b+=">";try{h=!a.isPreloadable}catch(a){h=false;B(a.message)}if(h){try{f[0]=I(a.originalImageUrl)}catch(a){f[0]="";B(a.message)}b+='<img src="'+f[0]+'" class="b-view__image__image"/>'}b+='<div class="b-view__zoom js-viewZoom"></div></div>';return b}})(a);(function(a){m["b-view__video"]=function(a){var b="";b+='<div class="b-view__video js-viewVideo"';try{h=a.hidden}catch(a){h=false;B(a.message)}if(h){b+=' style="display: none;"'}b+="></div>";return b}})(a);(function(a){m["b-view__audio"]=function(a){var b="";b+='<div class="b-view__audio js-viewAudio"';try{h=a.hidden}catch(a){h=false;B(a.message)}if(h){b+=' style="display: none;"'}b+='><div class="b-view__dummy__icon">';g="file-icon";n={};try{n={mods:["viewer"],type:a.filename.extension}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+='</div><div class="b-view__dummy__info"><div class="b-view__dummy__title">';g="b-filename";n={};try{n=a.filename}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+='</div><div class="b-view__audio__content js-audioContent"></div></div></div>';return b}})(a);(function(a){m["b-view__iframe"]=function(a){var b="";b+='<div class="b-view__iframe js-viewIframe"';try{h=a.hidden}catch(a){h=false;B(a.message)}if(h){b+=' style="display: none;"'}b+=">";try{f[0]=I(a.iframeUrl||"about:blank")}catch(a){f[0]="";B(a.message)}b+='<iframe class="b-view__iframe__iframe js-viewIframeIframe" src="'+f[0]+'"></iframe></div>';return b}})(a);(function(a){m["b-view__archive"]=function(a){var b="";b+='<div class="b-view__archive js-viewArchive"';try{h=a.hidden}catch(a){h=false;B(a.message)}if(h){b+=' style="display: none;"'}b+='><div class="b-view__dummy__icon">';g="file-icon";n={};try{n={mods:["viewer"],type:a.filename.extension}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+='</div><div class="b-view__dummy__info"><div class="b-view__dummy__title">';g="b-filename";n={};try{n=a.filename}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+='</div><div class="b-view__dummy__actions">';var c,d,e,i;try{i=a.viewActions||[];e=i.length}catch(a){i=[];e=0;B(a.message)}for(c=0;c<e;c++){d=i[c];try{f[0]=I(d.name)}catch(a){f[0]="";B(a.message)}b+='<div class="b-view__dummy__action js-viewAction" data-name="'+f[0]+'">';g="ico";n={};try{n={mods:[d.icon.split("_")[0],d.icon]}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+='<span class="b-view__dummy__action__text">';try{b+=I(d.text)}catch(a){B(a.message+"33")}b+="</span></div>"}b+='</div><div class="b-view__archive__contents js-archiveContents">';try{h=!a.hideUnpackButton}catch(a){h=false;B(a.message)}if(h){g="btn";n={};try{n={text:"Показать файлы",mods:["viewer"],classes:["js-archiveContentsShow"]}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}b+="</div></div></div>";return b}})(a);(function(a){m["b-datatree"]=function(a){var b="";try{a.list._indent=0}catch(a){B(a.message)}b+="<div";g="class-attribute";n={};try{n={baseClass:"b-datatree",mods:a.mods}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+=">";g="b-datatree__list";n={};try{n=a.list}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+="</div>";return b}})(a);(function(a){m["b-datatree__list"]=function(a){var b="";b+="<div";g="class-attribute";n={};try{n={baseClass:"b-datatree__list",mods:a.mods,classes:["js-datatreeList"].concat(a.classes)}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+=">";var c,d,e,f;try{f=a.items||[];e=f.length}catch(a){f=[];e=0;B(a.message)}for(c=0;c<e;c++){d=f[c];try{d._indent=a._indent}catch(a){B(a.message)}g="b-datatree__node";n={};try{n=d}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}b+="</div>";return b}})(a);(function(a){m["b-datatree__node"]=function(a){var b="";try{var c=[].concat(a.mods);if(a.list){c.push("list")}}catch(a){B(a.message)}b+="<div";g="class-attribute";n={};try{n={baseClass:"b-datatree__node",mods:c,classes:["js-datatreeNode"].concat(a.classes)}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+=' data-id="';try{b+=I(a.id)}catch(a){B(a.message+"21")}b+='"><div class="b-datatree__node__wrapper">';var d,e,f,i;try{f=1;e=a._indent}catch(a){f=0;e=0;B(a.message)}for(d=f;d<=e;d++){b+='<div class="b-datatree__node__indent"></div>'}try{h=a.actions&&a.actions.length}catch(a){h=false;B(a.message)}if(h){var d,j,l,o;try{l=1;j=a.actions.length}catch(a){l=0;j=0;B(a.message)}for(d=l;d<=j;d++){g="b-datatree__node__action";n={};try{n=a.actions[a.actions.length-d]}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}}b+='<div class="b-datatree__node__title">';try{h=a.filename}catch(a){h=false;B(a.message)}if(h){g="b-filename";n={};try{n={name:a.filename.name,extension:a.filename.extension,icon:a.icon,mods:["datatree"]}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}else{try{b+=I(a.title)}catch(a){B(a.message+"48")}}b+="</div></div>";try{h=a.list}catch(a){h=false;B(a.message)}if(h){try{a.list._indent=a._indent+1}catch(a){B(a.message)}g="b-datatree__list";n={};try{n=a.list}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}b+="</div>";return b}})(a);(function(a){m["b-datatree__node__action"]=function(a){var b="";b+="<div";g="class-attribute";n={};try{n={baseClass:"b-datatree__node__action",classes:["js-datatreeNodeAction"]}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+=' data-name="';try{b+=I(a.name)}catch(a){B(a.message+"12")}b+='"';try{h=a.width}catch(a){h=false;B(a.message)}if(h){b+=' style="';try{b+=I("width:"+a.width+"px")}catch(a){B(a.message+"17")}b+='"'}b+=">";try{h=a.icon}catch(a){h=false;B(a.message)}if(h){g="ico";n={};try{n={mods:["datatree","datatree_"+a.icon]}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}try{h=a.text}catch(a){h=false;B(a.message)}if(h){b+='<span class="b-datatree__node__action__text">';try{b+=I(a.text)}catch(a){B(a.message+"30")}b+="</span>"}b+="</div>";return b}})(a);(function(a){m["b-view_image"]=function(a){var b="";b+='<div class="b-view b-view_image js-view">';try{var c={hidden:false};for(var d in a){c[d]=a[d]}}catch(a){B(a.message)}g="b-view__image";n={};try{n=c}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+="</div>";return b}})(a);(function(a){m["b-view_video"]=function(a){var b="";b+='<div class="b-view b-view_video js-view">';g="b-view__video";n={};try{n=a}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+="</div>";return b}})(a);(function(a){m["b-view_audio"]=function(a){var b="";b+='<div class="b-view b-view_audio js-view">';g="b-view__audio";n={};try{n=a}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+="</div>";return b}})(a);(function(a){m["b-view_text"]=function(a){var b="";b+='<div class="b-view b-view_text js-view">';g="b-view__iframe";n={};try{n=a}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+="</div>";return b}})(a);(function(a){m["b-view_pdf"]=function(a){var b="";b+='<div class="b-view b-view_pdf js-view">';try{var c={hidden:false};for(var d in a){c[d]=a[d]}}catch(a){B(a.message)}g="b-view__iframe";n={};try{n=c}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+="</div>";return b}})(a);(function(a){m["b-view_document"]=function(a){var b="";b+='<div class="b-view b-view_document js-view">';try{var c={hidden:false};for(var d in a){c[d]=a[d]}}catch(a){B(a.message)}g="b-view__iframe";n={};try{n=c}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+="</div>";return b}})(a);(function(a){m["b-view_archive"]=function(a){var b="";b+='<div class="b-view b-view_archive js-view">';try{var c={hidden:false};for(var d in a){c[d]=a[d]}}catch(a){B(a.message)}g="b-view__archive";n={};try{n=c}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+="</div>";return b}})(a);(function(a){m["b-view_thumbnail"]=function(a){var b="";b+='<div class="b-view b-view_thumbnail js-view"></div>';return b}})(a);(function(a){m["b-breadcrumbs"]=function(a){var b="";b+='<div class="b-breadcrumbs"><div class="b-breadcrumbs__filename">';g="b-filename";n={};try{n={name:a.filename.name,extension:a.filename.extension,icon:a.icon,mods:["breadcrumbs"]}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+="</div></div>";return b}})(a);(function(a){m["b-slider__item"]=function(a){var b="";b+='<div class="b-slider__item js-sliderItem"><div class="b-slider__item__content js-sliderItemContent"></div></div>';return b}})(a);(function(a){m["b-slider"]=function(a){var b="";b+="<div";g="class-attribute";n={};try{n={baseClass:"b-slider",mods:(a.fit?["fit"]:[]).concat(a.mods)}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+='><div class="js-sliderItemTemplate" style="display: none;">';g="b-slider__item";n={};k=m[g];if(k)b+=G(k,n,false);b+='</div><div class="b-slider__container js-sliderContainer"><div class="b-slider__content js-sliderContent"></div></div><div class="b-slider__arrow b-slider__arrow_back js-sliderArrowBack"></div><div class="b-slider__arrow b-slider__arrow_forward js-sliderArrowForward"></div></div>';return b}})(a);(function(a){m["b-viewer__toolbox"]=function(a){var b="";b+='<div class="b-viewer__toolbox js-viewerToolbox"><div class="b-viewer__toolbox__toolbar js-viewerToolboxToolbar"></div><div class="b-viewer__toolbox__content js-viewerToolboxContent"></div></div>';return b}})(a);(function(a){m["b-toolbar"]=function(a){var b="";try{f[0]=I(a.mods?" b-toolbar_"+a.mods.join(" b-toolbar_"):"")}catch(a){f[0]="";B(a.message)}b+='<div class="b-toolbar'+f[0]+'"';try{h=a.mnemo}catch(a){h=false;B(a.message)}if(h){b+=' data-mnemo="';try{b+=I(a.mnemo)}catch(a){B(a.message+"8")}b+='"'}b+=">";var c,d,e,i;try{i=a.items||[];e=i.length}catch(a){i=[];e=0;B(a.message)}for(c=0;c<e;c++){d=i[c];try{h=d.group}catch(a){h=false;B(a.message)}if(h){g="b-toolbar__group";n={};try{n=d}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}else{try{h=!d||d.hidden}catch(a){h=false;B(a.message)}if(h){}else{g="b-toolbar__item";n={};try{n=d}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}}}b+="</div>";return b}})(a);(function(a){m["b-toolbar__btn"]=function(a){var b="";try{h=a.items}catch(a){h=false;B(a.message)}if(h){b+="<div";try{h=a.role}catch(a){h=false;B(a.message)}if(h){b+=' role="';try{b+=I(a.role+"")}catch(a){B(a.message+"9")}b+='"'}try{h=a.mods&&a.mods.indexOf("disabled")!=-1}catch(a){h=false;B(a.message)}if(h){b+=' aria-disabled="disabled"'}try{h=a.name}catch(a){h=false;B(a.message)}if(h){b+=' data-name="';try{b+=I(a.name)}catch(a){B(a.message+"18")}b+='"'}try{h=a.mnemo}catch(a){h=false;B(a.message)}if(h){b+=' data-mnemo="';try{b+=I(a.mnemo)}catch(a){B(a.message+"24")}b+='"'}try{h=a.group}catch(a){h=false;B(a.message)}if(h){b+=' data-group="';try{b+=I(a.group)}catch(a){B(a.message+"30")}b+='"'}try{h=a.title}catch(a){h=false;B(a.message)}if(h){b+=' title="';try{b+=I(a.title)}catch(a){B(a.message+"36")}b+='"'}try{h=a.id!=null}catch(a){h=false;B(a.message)}if(h){b+=' id="';try{b+=I(a.id)}catch(a){B(a.message+"42")}b+='"'}b+=">";var c,d,e,i;try{i=a.items||[];e=i.length}catch(a){i=[];e=0;B(a.message)}for(c=0;c<e;c++){d=i[c];try{h=d}catch(a){h=false;B(a.message)}if(h){try{d.mods=d.mods||[];d.mods.push("grouped");if(!c){d.mods.push("grouped_first")}if(a.items.length-c==1){d.mods.push("grouped_last")}}catch(a){B(a.message)}try{g=d.block||"b-toolbar__btn"}catch(a){g="";B(a.message)}n={};try{n=d}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}}b+="</div>"}else{try{var j=a.text==null&&typeof lang=="object"?lang.get("btn."+a.name):a.text;var l=a.title==null&&typeof lang=="object"?lang.get("btn.titles."+a.name)||lang.get("btn."+a.name):a.title}catch(a){B(a.message)}try{o=a.href?"a":"div";if(typeof o!=="string"){B("Element name must be a string");o="div"}}catch(a){o="div";B(a.message)}v.push(o);b+="<"+o;b+=' data-bem="b-toolbar__btn"';try{h=a.role}catch(a){h=false;B(a.message)}if(h){b+=' role="';try{b+=I(a.role+"")}catch(a){B(a.message+"80")}b+='"'}try{h=a.mods&&a.mods.indexOf("disabled")!=-1}catch(a){h=false;B(a.message)}if(h){b+=' aria-disabled="disabled"'}try{h=a.name}catch(a){h=false;B(a.message)}if(h){b+=' data-name="';try{b+=I(a.name)}catch(a){B(a.message+"89")}b+='"'}try{h=a.mnemo}catch(a){h=false;B(a.message)}if(h){b+=' data-mnemo="';try{b+=I(a.mnemo)}catch(a){B(a.message+"95")}b+='"'}try{h=a.href}catch(a){h=false;B(a.message)}if(h){try{h=a.history!==false}catch(a){h=false;B(a.message)}if(h){b+=' rel="history"'}b+=' href="';try{b+=I(a.href)}catch(a){B(a.message+"103")}b+='"'}try{h=a.target}catch(a){h=false;B(a.message)}if(h){b+=' target="';try{b+=I(a.target)}catch(a){B(a.message+"107")}b+='"'}try{h=a.rel}catch(a){h=false;B(a.message)}if(h){b+=' rel="';try{b+=I(a.rel)}catch(a){B(a.message+"111")}b+='"'}try{h=a.dataclick}catch(a){h=false;B(a.message)}if(h){b+=' data-click="';try{b+=I(a.dataclick)}catch(a){B(a.message+"115")}b+='"'}try{h=l}catch(a){h=false;B(a.message)}if(h){b+=' title="';try{b+=I(l)}catch(a){B(a.message+"120")}b+='"'}try{h=a.shortcut}catch(a){h=false;B(a.message)}if(h){b+=' data-shortcut="';try{b+=I(a.shortcut)}catch(a){B(a.message+"126")}b+='"'}b+=' class="b-toolbar__btn';try{h=a.mods}catch(a){h=false;B(a.message)}if(h){try{b+=I(" b-toolbar__btn_"+a.mods.join(" b-toolbar__btn_"))}catch(a){B(a.message+"133")}}try{h=a.classes}catch(a){h=false;B(a.message)}if(h){b+=" ";try{b+=I(a.classes.join(" "))}catch(a){B(a.message+"138")}}try{h=a.shortcut}catch(a){h=false;B(a.message)}if(h){b+=" js-shortcut"}b+='"';try{h=a.id!=null}catch(a){h=false;B(a.message)}if(h){b+=' id="';try{b+=I(a.id)}catch(a){B(a.message+"149")}b+='"'}try{h=a.rb}catch(a){h=false;B(a.message)}if(h){b+=' data-rb="';try{b+=I(a.rb)}catch(a){B(a.message+"155")}b+='"'}o=v[v.length-1];b+=o in u?"/>":">";try{h=a.icon}catch(a){h=false;B(a.message)}if(h){g="ico";n={};try{n={mods:[a.icon.split("_")[0],a.icon]}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}try{h=a.ctrl}catch(a){h=false;B(a.message)}if(h){try{g=a.ctrl.block}catch(a){g="";B(a.message)}n={};try{n=a.ctrl}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}else{try{h=j}catch(a){h=false;B(a.message)}if(h){try{f[0]=I(a.icon?" b-toolbar__btn__text_pad":"")}catch(a){f[0]="";B(a.message)}b+='<span class="b-toolbar__btn__text'+f[0]+'">';try{b+=I(j)}catch(a){B(a.message+"171")}b+="</span>"}else{}}o=v[v.length-1];if(!(o in u)){b+="</"+o+">"}v.pop()}return b}})(a);(function(a){m["b-toolbar__group"]=function(a){var b="";try{f[0]=I(a.group)}catch(a){f[0]="";B(a.message)}try{f[1]=I(a.mods?" b-toolbar__group_"+a.mods.join(" b-toolbar__group_"):"")}catch(a){f[1]="";B(a.message)}b+='<div data-toolbar-group="'+f[0]+'" class="b-toolbar__group'+f[1]+'">';try{h=a.items}catch(a){h=false;B(a.message)}if(h){var c,d,e,i;try{i=a.items||[];e=i.length}catch(a){i=[];e=0;B(a.message)}for(c=0;c<e;c++){d=i[c];try{h=d}catch(a){h=false;B(a.message)}if(h){g="b-toolbar__item";n={};try{n=d}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}}}b+="</div>";return b}})(a);(function(a){m["b-toolbar__inp"]=function(a){var b="";b+='<div class="b-toolbar__inp';try{h=a.mods}catch(a){h=false;B(a.message)}if(h){try{b+=I(" b-toolbar__inp_"+a.mods.join(" b-toolbar__inp_"))}catch(a){B(a.message+"9")}}try{h=a.classes}catch(a){h=false;B(a.message)}if(h){b+=" ";try{b+=I(a.classes.join(" "))}catch(a){B(a.message+"14")}}b+='">';try{f[0]=I(a.value)}catch(a){f[0]="";B(a.message)}try{f[1]=I(lang.placeholder[a.placeholder])}catch(a){f[1]="";B(a.message)}try{f[2]=I(a.name)}catch(a){f[2]="";B(a.message)}try{f[3]=I(a.type||"text")}catch(a){f[3]="";B(a.message)}b+='<input value="'+f[0]+'" placeholder="'+f[1]+'" name="'+f[2]+'" type="'+f[3]+'"/></div>';return b}})(a);(function(a){m["b-toolbar__item"]=function(a){var b="";b+='<div class="b-toolbar__item';try{h=a.mods}catch(a){h=false;B(a.message)}if(h){b+=" ";try{b+=I("b-toolbar__item_"+a.mods.join(" b-toolbar__item_"))}catch(a){B(a.message+"10")}}try{h=a.classes}catch(a){h=false;B(a.message)}if(h){b+=" ";try{b+=I(a.classes.join(" "))}catch(a){B(a.message+"15")}}b+='">';try{g=a.block}catch(a){g="";B(a.message)}n={};try{n=a.params||a}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false);b+="</div>";return b}})(a);(function(a){m["b-toolbar__link"]=function(a){var b="";try{var c=a.text==null&&typeof lang=="object"?lang.get("btn."+a.name):a.text}catch(a){B(a.message)}try{f[0]=I(a.mods?" b-toolbar__link_"+a.mods.join(" b-toolbar__link_"):"")}catch(a){f[0]="";B(a.message)}b+='<a data-bem="b-toolbar__link" class="b-toolbar__link'+f[0]+'"';try{h=a.role}catch(a){h=false;B(a.message)}if(h){b+=' role="';try{b+=I(a.role+"")}catch(a){B(a.message+"11")}b+='"'}try{h=a.mods&&a.mods.indexOf("disabled")!=-1}catch(a){h=false;B(a.message)}if(h){b+=' aria-disabled="disabled"'}try{h=a.name}catch(a){h=false;B(a.message)}if(h){b+=' data-name="';try{b+=I(a.name)}catch(a){B(a.message+"20")}b+='"'}try{h=a.title}catch(a){h=false;B(a.message)}if(h){b+=' title="';try{b+=I(a.title)}catch(a){B(a.message+"26")}b+='"'}try{h=a.id!=null}catch(a){h=false;B(a.message)}if(h){b+=' id="';try{b+=I(a.id)}catch(a){B(a.message+"32")}b+='"'}try{h=a.target}catch(a){h=false;B(a.message)}if(h){b+=' target="';try{b+=I(a.target)}catch(a){B(a.message+"38")}b+='"'}try{h=a.href}catch(a){h=false;B(a.message)}if(h){b+=' href="';try{b+=I(a.href)}catch(a){B(a.message+"43")}b+='"'}b+=">";try{h=a.icon}catch(a){h=false;B(a.message)}if(h){g="ico";n={};try{n={mods:[a.icon.split("_")[0],a.icon]}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}try{h=c}catch(a){h=false;B(a.message)}if(h){try{f[0]=I(a.icon?" b-toolbar__link__text_pad":"")}catch(a){f[0]="";B(a.message)}b+='<span class="b-toolbar__link__text'+f[0]+'">';try{b+=I(c)}catch(a){B(a.message+"56")}b+="</span>"}b+="</a>";return b}})(a);(function(a){m["b-toolbar__message"]=function(a){var b="";try{var c=a.text==null&&typeof lang=="object"?lang.btn[a.mnemo]:a.text}catch(a){B(a.message)}try{f[0]=I(a.mods?" b-toolbar__message_"+a.mods.join(" b-toolbar__message_"):"")}catch(a){f[0]="";B(a.message)}b+='<div data-bem="b-toolbar__message" class="b-toolbar__message'+f[0]+'"';try{h=a.role}catch(a){h=false;B(a.message)}if(h){b+=' role="';try{b+=I(a.role+"")}catch(a){B(a.message+"11")}b+='"'}try{h=a.mods&&a.mods.indexOf("disabled")!=-1}catch(a){h=false;B(a.message)}if(h){b+=' aria-disabled="disabled"'}try{h=a.mnemo}catch(a){h=false;B(a.message)}if(h){b+=' data-mnemo="';try{b+=I(a.mnemo)}catch(a){B(a.message+"20")}b+='"'}try{h=a.title}catch(a){h=false;B(a.message)}if(h){b+=' title="';try{b+=I(a.title)}catch(a){B(a.message+"26")}b+='"'}try{h=a.id!=null}catch(a){h=false;B(a.message)}if(h){b+=' id="';try{b+=I(a.id)}catch(a){B(a.message+"32")}b+='"'}try{h=a.hide}catch(a){h=false;B(a.message)}if(h){b+=' style="display:none;"'}b+=">";try{h=a.icon}catch(a){h=false;B(a.message)}if(h){g="ico";n={};try{n={mods:[a.icon.split("_")[0],a.icon]}}catch(a){B(a.message)}k=m[g];if(k)b+=G(k,n,false)}try{h=c}catch(a){h=false;B(a.message)}if(h){try{f[0]=I(a.icon?" b-toolbar__message__text_pad":"")}catch(a){f[0]="";B(a.message)}b+='<span class="b-toolbar__message__text'+f[0]+'">';try{b+=I(c)}catch(a){B(a.message+"51")}b+="</span>"}b+="</div>";return b}})(a);(function(a){m["b-viewer__viewport"]=function(a){var b="";b+='<div class="b-viewer__viewport js-viewerViewport"><div class="b-viewer__advert__line"></div><div class="b-viewer__viewport__title js-viewerViewportTitle"></div><div class="b-viewer__viewport__filename js-viewerViewportFileName"></div><div class="b-viewer__viewport__close js-viewerViewportClose"></div><div class="b-viewer__viewport__content js-viewerViewportContent"><div class="js-viewerViewportContentPlaceholder"></div></div></div>';return b}})(a);(function(a){var b=a;m["b-icon"]=function(a){var b="";return b}})(a)})(a);try{g=J.block}catch(a){g="";B(a.message)}n={};try{n=J.params||J}catch(a){B(a.message)}d.push(c,{name:g,params:n,cp:false});c="";j=d.length;if(j){i=0;for(;i<j;i++){e=d[i];if(typeof e==="string"){l+=e}else{k=m[e.name];if(k)l+=G(k,e.params,e.cp)}}return l+c}else{return c}};define("mailru-toolkit-lego-bundle",[],function(){});